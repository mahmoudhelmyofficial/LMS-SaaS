@model LMS.Domain.Entities.Notifications.NotificationPreference

@{
    ViewData["Title"] = Html.T("تفاصيل تفضيلات الإشعارات", "Notification preferences details");
    var breadcrumbs = new List<(string Name, string? Url)>
    {
        (Html.T("لوحة التحكم", "Dashboard"), Url.Action("Index", "Dashboard")),
        (Html.T("تفضيلات الإشعارات", "Notification preferences"), Url.Action("Index", "NotificationPreferences")),
        (Html.T("التفاصيل", "Details"), null)
    };
    ViewData["Breadcrumbs"] = breadcrumbs;
}

@await Html.PartialAsync("_PageHeader")

<div class="main-content">
    <div class="row">
        <div class="col-lg-8">
            <!-- User Info -->
            <div class="card stretch stretch-full mb-4">
                <div class="card-body">
                    <div class="d-flex align-items-center gap-3">
                        <div class="avatar-text avatar-xl bg-soft-primary text-primary">
                            @if (Model.User != null)
                            {
                                <span class="fs-4">@Model.User.FirstName.Substring(0, 1)@Model.User.LastName.Substring(0, 1)</span>
                            }
                            else
                            {
                                <i class="feather-user"></i>
                            }
                        </div>
                        <div>
                            @if (Model.User != null)
                            {
                                <h4 class="fw-bold mb-1">@Model.User.FirstName @Model.User.LastName</h4>
                                <p class="text-muted mb-0">@Model.User.Email</p>
                            }
                            else
                            {
                                <h4 class="fw-bold mb-1">مستخدم محذوف</h4>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <!-- Email Notifications -->
            <div class="card stretch stretch-full mb-4">
                <div class="card-header">
                    <h5 class="card-title">
                        <i class="feather-mail me-2"></i>إشعارات البريد الإلكتروني
                    </h5>
                </div>
                <div class="card-body">
                    <div class="list-group list-group-flush">
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>تحديثات الدورة</strong>
                                <br><small class="text-muted">إشعارات حول الدورات المسجل فيها</small>
                            </div>
                            <span class="badge @(Model.EmailCourseUpdates ? "bg-success" : "bg-secondary")">
                                @(Model.EmailCourseUpdates ? "مفعل" : "معطل")
                            </span>
                        </div>
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>رسائل جديدة</strong>
                                <br><small class="text-muted">إشعارات عند استلام رسائل</small>
                            </div>
                            <span class="badge @(Model.EmailNewMessages ? "bg-success" : "bg-secondary")">
                                @(Model.EmailNewMessages ? "مفعل" : "معطل")
                            </span>
                        </div>
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>الإعلانات</strong>
                                <br><small class="text-muted">إشعارات عن الإعلانات الجديدة</small>
                            </div>
                            <span class="badge @(Model.EmailAnnouncements ? "bg-success" : "bg-secondary")">
                                @(Model.EmailAnnouncements ? "مفعل" : "معطل")
                            </span>
                        </div>
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>النشرة البريدية</strong>
                                <br><small class="text-muted">تلقي النشرة الإخبارية</small>
                            </div>
                            <span class="badge @(Model.EmailNewsletter ? "bg-success" : "bg-secondary")">
                                @(Model.EmailNewsletter ? "مفعل" : "معطل")
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Push Notifications -->
            <div class="card stretch stretch-full mb-4">
                <div class="card-header">
                    <h5 class="card-title">
                        <i class="feather-bell me-2"></i>الإشعارات الفورية
                    </h5>
                </div>
                <div class="card-body">
                    <div class="list-group list-group-flush">
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>رسائل جديدة</strong>
                                <br><small class="text-muted">إشعار فوري عند استلام رسالة</small>
                            </div>
                            <span class="badge @(Model.PushNewMessages ? "bg-success" : "bg-secondary")">
                                @(Model.PushNewMessages ? "مفعل" : "معطل")
                            </span>
                        </div>
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>تحديثات الدورة</strong>
                                <br><small class="text-muted">إشعارات حول تحديثات الدورات</small>
                            </div>
                            <span class="badge @(Model.PushCourseUpdates ? "bg-success" : "bg-secondary")">
                                @(Model.PushCourseUpdates ? "مفعل" : "معطل")
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SMS Notifications -->
            <div class="card stretch stretch-full">
                <div class="card-header">
                    <h5 class="card-title">
                        <i class="feather-smartphone me-2"></i>إشعارات SMS
                    </h5>
                </div>
                <div class="card-body">
                    <div class="list-group list-group-flush">
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>رموز التحقق</strong>
                                <br><small class="text-muted">رموز المصادقة الثنائية</small>
                            </div>
                            <span class="badge @(Model.SmsVerificationCodes ? "bg-success" : "bg-secondary")">
                                @(Model.SmsVerificationCodes ? "مفعل" : "معطل")
                            </span>
                        </div>
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>رسائل مهمة</strong>
                                <br><small class="text-muted">إشعارات SMS للرسائل المهمة</small>
                            </div>
                            <span class="badge @(Model.SmsImportantUpdates ? "bg-success" : "bg-secondary")">
                                @(Model.SmsImportantUpdates ? "مفعل" : "معطل")
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <!-- Actions -->
            <div class="card stretch stretch-full mb-4" style="position: sticky; top: 20px;">
                <div class="card-header">
                    <h5 class="card-title">
                        <i class="feather-settings me-2"></i>إجراءات
                    </h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a asp-action="Index" class="btn btn-light">
                            <i class="feather-arrow-right me-2"></i>العودة للقائمة
                        </a>
                        @if (Model.User != null)
                        {
                            <a asp-controller="Users" asp-action="Details" asp-route-id="@Model.UserId" class="btn btn-outline-primary">
                                <i class="feather-user me-2"></i>عرض المستخدم
                            </a>
                        }
                    </div>
                </div>
            </div>

            <!-- Summary -->
            <div class="card stretch stretch-full">
                <div class="card-header">
                    <h5 class="card-title">
                        <i class="feather-bar-chart-2 me-2"></i>ملخص
                    </h5>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-3 pb-3 border-bottom">
                        <span class="text-muted">إشعارات البريد</span>
                        <strong>@{
                            var emailCount = 0;
                            if (Model.EmailCourseUpdates) emailCount++;
                            if (Model.EmailNewMessages) emailCount++;
                            if (Model.EmailAnnouncements) emailCount++;
                            if (Model.EmailNewsletter) emailCount++;
                        }@emailCount/4 مفعل</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-3 pb-3 border-bottom">
                        <span class="text-muted">إشعارات فورية</span>
                        <strong>@{
                            var pushCount = 0;
                            if (Model.PushNewMessages) pushCount++;
                            if (Model.PushCourseUpdates) pushCount++;
                        }@pushCount/2 مفعل</strong>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span class="text-muted">إشعارات SMS</span>
                        <strong>@{
                            var smsCount = 0;
                            if (Model.SmsVerificationCodes) smsCount++;
                            if (Model.SmsImportantUpdates) smsCount++;
                        }@smsCount/2 مفعل</strong>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

