@using LMS.Services.Interfaces
@inject IPlatformSettingsService PlatformSettings

@{
    var platformName = "WEBUILDER";
    var platformLogo = "/logo.png";

    try
    {
        platformName = await PlatformSettings.GetPlatformNameAsync() ?? "WEBUILDER";
        platformLogo = await PlatformSettings.GetPlatformLogoAsync() ?? "/logo.png";
    }
    catch
    {
        // Use default values on error
    }

    var currentController = ViewContext.RouteData.Values["controller"]?.ToString() ?? "";
    var currentAction = ViewContext.RouteData.Values["action"]?.ToString() ?? "";
}

<nav class="nxl-navigation" id="main-sidebar" role="navigation" aria-label="@Html.T("القائمة الرئيسية", "Main navigation")">
    <div class="navbar-wrapper">
        <div class="m-header">
            <a asp-area="Admin" asp-controller="Dashboard" asp-action="Index" class="b-brand">
                <img src="@Url.Content(string.IsNullOrEmpty(platformLogo) ? "~/logo.png" : "~" + platformLogo)" alt="@platformName" class="logo logo-lg" style="max-height: 80px;" onerror="this.src='@Url.Content("~/logo.png")'" />
                <img src="@Url.Content(string.IsNullOrEmpty(platformLogo) ? "~/logo.png" : "~" + platformLogo)" alt="@platformName" class="logo logo-sm" style="max-height: 60px;" onerror="this.src='@Url.Content("~/logo.png")'" />
            </a>
            <button type="button" class="sidebar-close-btn d-xl-none" id="sidebar-close-btn" aria-label="@Html.T("إغلاق القائمة", "Close Menu")">
                <i class="feather-x"></i>
            </button>
        </div>
        <div class="navbar-content">
            <ul class="nxl-navbar">
                <!-- Dashboard -->
                <li class="nxl-item @(currentController == "Dashboard" ? "active" : "")">
                    <a asp-area="Admin" asp-controller="Dashboard" asp-action="Index" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-home"></i></span>
                        <span class="nxl-mtext">@Html.T("لوحة التحكم", "Dashboard")</span>
                    </a>
                </li>

                <!-- User Management (before Settings per requirement) -->
                <li class="nxl-item nxl-caption">
                    <label>@Html.T("إدارة المستخدمين", "User Management")</label>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Users" || currentController == "Students" || currentController == "Instructors" || currentController == "InstructorApplications" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-users"></i></span>
                        <span class="nxl-mtext">@Html.T("المستخدمين والمدرسين", "Users & Instructors")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Users" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Users" asp-action="Index" class="nxl-link">
                                <i class="feather-users me-2"></i>
                                @Html.T("جميع المستخدمين", "All Users")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Students" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Students" asp-action="Index" class="nxl-link">
                                <i class="feather-user me-2"></i>
                                @Html.T("الطلاب", "Students")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Instructors" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Instructors" asp-action="Index" class="nxl-link">
                                <i class="feather-user-check me-2"></i>
                                @Html.T("جميع المدرسين", "All Instructors")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Instructors" && currentAction == "Applications" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Instructors" asp-action="Applications" class="nxl-link">
                                <i class="feather-file-text me-2"></i>
                                @Html.T("طلبات الانضمام", "Join Requests")
                                <span class="nxl-badge" id="pending-applications-badge"></span>
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Instructors" && currentAction == "Statistics" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Instructors" asp-action="Statistics" class="nxl-link">
                                <i class="feather-bar-chart-2 me-2"></i>
                                @Html.T("إحصائيات المدرسين", "Instructor Statistics")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Users" && currentAction == "Create" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Users" asp-action="Create" class="nxl-link">
                                <i class="feather-user-plus me-2"></i>
                                @Html.T("إضافة مستخدم", "Add User")
                            </a>
                        </li>
                    </ul>
                </li>

                <!-- Content & Learning -->
                <li class="nxl-item nxl-caption">
                    <label>@Html.T("المحتوى والتعلم", "Content & Learning")</label>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Courses" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-book"></i></span>
                        <span class="nxl-mtext">@Html.T("الدورات", "Courses")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Courses" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Courses" asp-action="Index" class="nxl-link">
                                <i class="feather-list me-2"></i>
                                @Html.T("جميع الدورات", "All Courses")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Courses" && currentAction == "Pending" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Courses" asp-action="Pending" class="nxl-link">
                                <i class="feather-clock me-2"></i>
                                @Html.T("قيد المراجعة", "Pending Review")
                                <span class="nxl-badge" id="pending-courses-badge"></span>
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Courses" && currentAction == "Index" && ViewContext.HttpContext.Request.Query["status"].ToString() == "Published" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Courses" asp-action="Index" asp-route-status="Published" class="nxl-link">
                                <i class="feather-check-circle me-2"></i>
                                @Html.T("الدورات المنشورة", "Published Courses")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Courses" && currentAction == "Featured" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Courses" asp-action="Featured" class="nxl-link">
                                <i class="feather-star me-2"></i>
                                @Html.T("الدورات المميزة", "Featured Courses")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Categories" || currentController == "Subcategories" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-folder"></i></span>
                        <span class="nxl-mtext">@Html.T("التصنيفات", "Categories")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Categories" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Categories" asp-action="Index" class="nxl-link">
                                <i class="feather-folder me-2"></i>
                                @Html.T("التصنيفات الرئيسية", "Main Categories")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Categories" && currentAction == "Subcategories" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Categories" asp-action="Subcategories" class="nxl-link">
                                <i class="feather-folder-plus me-2"></i>
                                @Html.T("التصنيفات الفرعية", "Subcategories")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Bundles" || currentController == "LearningPaths" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-package"></i></span>
                        <span class="nxl-mtext">@Html.T("الباقات والمسارات", "Bundles & Paths")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Bundles" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Bundles" asp-action="Index" class="nxl-link">
                                <i class="feather-package me-2"></i>
                                @Html.T("الباقات", "Bundles")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "LearningPaths" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="LearningPaths" asp-action="Index" class="nxl-link">
                                <i class="feather-git-branch me-2"></i>
                                @Html.T("مسارات التعلم", "Learning Paths")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Books" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-book-open"></i></span>
                        <span class="nxl-mtext">@Html.T("الكتب", "Books")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Books" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Books" asp-action="Index" class="nxl-link">
                                <i class="feather-list me-2"></i>
                                @Html.T("جميع الكتب", "All Books")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Books" && currentAction == "PendingReview" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Books" asp-action="PendingReview" class="nxl-link">
                                <i class="feather-clock me-2"></i>
                                @Html.T("قيد المراجعة", "Pending Review")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "LiveClasses" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-video"></i></span>
                        <span class="nxl-mtext">@Html.T("البث المباشر", "Live Sessions")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "LiveClasses" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="LiveClasses" asp-action="Index" class="nxl-link">
                                <i class="feather-list me-2"></i>
                                @Html.T("جميع الجلسات", "All Sessions")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "LiveClasses" && currentAction == "Active" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="LiveClasses" asp-action="Active" class="nxl-link">
                                <i class="feather-radio me-2"></i>
                                @Html.T("البث الحالي", "Current Streams")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "LiveClasses" && currentAction == "Schedules" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="LiveClasses" asp-action="Schedules" class="nxl-link">
                                <i class="feather-calendar me-2"></i>
                                @Html.T("جداول الحصص", "Session Schedules")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "LiveClasses" && currentAction == "Revenue" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="LiveClasses" asp-action="Revenue" class="nxl-link">
                                <i class="feather-dollar-sign me-2"></i>
                                @Html.T("الإيرادات", "Revenue")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item @(currentController == "ContentDrip" ? "active" : "")">
                    <a asp-area="Admin" asp-controller="ContentDrip" asp-action="Index" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-clock"></i></span>
                        <span class="nxl-mtext">@Html.T("جدولة المحتوى", "Content Scheduling")</span>
                    </a>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "QuestionBank" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-help-circle"></i></span>
                        <span class="nxl-mtext">@Html.T("الاختبارات", "Quizzes")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "QuestionBank" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="QuestionBank" asp-action="Index" class="nxl-link">
                                <i class="feather-database me-2"></i>
                                @Html.T("بنك الأسئلة", "Question Bank")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "QuestionBank" && currentAction == "Categories" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="QuestionBank" asp-action="Categories" class="nxl-link">
                                <i class="feather-folder me-2"></i>
                                @Html.T("تصنيفات الأسئلة", "Question Categories")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item @(currentController == "Lessons" ? "active" : "")">
                    <a asp-area="Admin" asp-controller="Lessons" asp-action="Index" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-edit"></i></span>
                        <span class="nxl-mtext">@Html.T("الدروس والواجبات", "Lessons & Assignments")</span>
                    </a>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Certificates" || currentController == "CertificateTemplates" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-award"></i></span>
                        <span class="nxl-mtext">@Html.T("الشهادات", "Certificates")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Certificates" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Certificates" asp-action="Index" class="nxl-link">
                                <i class="feather-list me-2"></i>
                                @Html.T("الشهادات الصادرة", "Issued Certificates")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "CertificateTemplates" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="CertificateTemplates" asp-action="Index" class="nxl-link">
                                <i class="feather-layout me-2"></i>
                                @Html.T("قوالب الشهادات", "Certificate Templates")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Reviews" || currentController == "Comments" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-message-square"></i></span>
                        <span class="nxl-mtext">@Html.T("التقييمات والتعليقات", "Reviews & Comments")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Reviews" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Reviews" asp-action="Index" class="nxl-link">
                                <i class="feather-star me-2"></i>
                                @Html.T("التقييمات", "Reviews")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Comments" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Comments" asp-action="Index" class="nxl-link">
                                <i class="feather-message-square me-2"></i>
                                @Html.T("التعليقات", "Comments")
                            </a>
                        </li>
                    </ul>
                </li>

                <!-- Payments & Finance -->
                <li class="nxl-item nxl-caption">
                    <label>@Html.T("المدفوعات والمالية", "Payments & Finance")</label>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Payments" || currentController == "ManualPayments" || currentController == "PaymentAnalytics" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-shopping-cart"></i></span>
                        <span class="nxl-mtext">@Html.T("المدفوعات", "Payments")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Payments" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Payments" asp-action="Index" class="nxl-link">
                                <i class="feather-credit-card me-2"></i>
                                @Html.T("جميع المدفوعات", "All Payments")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "ManualPayments" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="ManualPayments" asp-action="Index" class="nxl-link">
                                <i class="feather-edit-3 me-2"></i>
                                @Html.T("المدفوعات اليدوية", "Manual Payments")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "PaymentAnalytics" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="PaymentAnalytics" asp-action="Index" class="nxl-link">
                                <i class="feather-bar-chart-2 me-2"></i>
                                @Html.T("تحليلات المدفوعات", "Payment Analytics")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item @(currentController == "Subscriptions" && currentAction == "Plans" ? "active" : "")">
                    <a asp-area="Admin" asp-controller="Subscriptions" asp-action="Plans" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-layers"></i></span>
                        <span class="nxl-mtext">@Html.T("خطط الاشتراك", "Subscription Plans")</span>
                    </a>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Refunds" || currentController == "WithdrawalMethods" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-rotate-ccw"></i></span>
                        <span class="nxl-mtext">@Html.T("الاسترداد والسحب", "Refunds & Withdrawals")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Refunds" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Refunds" asp-action="Index" class="nxl-link">
                                <i class="feather-rotate-ccw me-2"></i>
                                @Html.T("طلبات الاسترداد", "Refund Requests")
                                <span class="nxl-badge" id="pending-refunds-badge"></span>
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "WithdrawalMethods" && currentAction == "Requests" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="WithdrawalMethods" asp-action="Requests" class="nxl-link">
                                <i class="feather-arrow-up-circle me-2"></i>
                                @Html.T("طلبات السحب", "Withdrawal Requests")
                                <span class="nxl-badge" id="pending-withdrawals-badge"></span>
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "WithdrawalMethods" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="WithdrawalMethods" asp-action="Index" class="nxl-link">
                                <i class="feather-settings me-2"></i>
                                @Html.T("طرق السحب", "Withdrawal Methods")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "TaxSettings" || currentController == "FinancialReports" || currentController == "CommissionSettings" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-file-text"></i></span>
                        <span class="nxl-mtext">@Html.T("الضرائب والتقارير المالية", "Tax & Financial Reports")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "TaxSettings" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="TaxSettings" asp-action="Index" class="nxl-link">
                                <i class="feather-percent me-2"></i>
                                @Html.T("إعدادات الضرائب", "Tax Settings")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "CommissionSettings" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="CommissionSettings" asp-action="Index" class="nxl-link">
                                <i class="feather-dollar-sign me-2"></i>
                                @Html.T("إعدادات العمولات", "Commission Settings")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "FinancialReports" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="FinancialReports" asp-action="Index" class="nxl-link">
                                <i class="feather-file-text me-2"></i>
                                @Html.T("التقارير المالية", "Financial Reports")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Reports" || currentController == "AdvancedReports" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-bar-chart-2"></i></span>
                        <span class="nxl-mtext">@Html.T("التقارير", "Reports")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Reports" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Reports" asp-action="Index" class="nxl-link">
                                <i class="feather-bar-chart-2 me-2"></i>
                                @Html.T("نظرة عامة", "Overview")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "AdvancedReports" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="AdvancedReports" asp-action="Index" class="nxl-link">
                                <i class="feather-pie-chart me-2"></i>
                                @Html.T("تقارير متقدمة", "Advanced Reports")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Reports" && currentAction == "Financial" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Reports" asp-action="Financial" class="nxl-link">
                                <i class="feather-dollar-sign me-2"></i>
                                @Html.T("التقارير المالية", "Financial Reports")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Reports" && currentAction == "Students" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Reports" asp-action="Students" class="nxl-link">
                                <i class="feather-users me-2"></i>
                                @Html.T("تقارير الطلاب", "Student Reports")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "AdvancedReports" && currentAction == "Templates" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="AdvancedReports" asp-action="Templates" class="nxl-link">
                                <i class="feather-layout me-2"></i>
                                @Html.T("قوالب التقارير", "Report Templates")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "AdvancedReports" && currentAction == "ScheduledReports" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="AdvancedReports" asp-action="ScheduledReports" class="nxl-link">
                                <i class="feather-clock me-2"></i>
                                @Html.T("تقارير مجدولة", "Scheduled Reports")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Analytics" || currentController == "CourseAnalytics" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-trending-up"></i></span>
                        <span class="nxl-mtext">@Html.T("التحليلات", "Analytics")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Analytics" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Analytics" asp-action="Index" class="nxl-link">
                                <i class="feather-activity me-2"></i>
                                @Html.T("نظرة عامة", "Overview")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Analytics" && currentAction == "CoursePerformance" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Analytics" asp-action="CoursePerformance" class="nxl-link">
                                <i class="feather-book me-2"></i>
                                @Html.T("أداء الدورات", "Course Performance")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "CourseAnalytics" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="CourseAnalytics" asp-action="Index" class="nxl-link">
                                <i class="feather-bar-chart-2 me-2"></i>
                                @Html.T("تحليلات الدورات", "Course Analytics")
                            </a>
                        </li>
                    </ul>
                </li>

                <!-- Marketing & Notifications -->
                <li class="nxl-item nxl-caption">
                    <label>@Html.T("التسويق والإشعارات", "Marketing & Notifications")</label>
                </li>
                <li class="nxl-item @(currentController == "FlashSales" ? "active" : "")">
                    <a asp-area="Admin" asp-controller="FlashSales" asp-action="Index" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-zap"></i></span>
                        <span class="nxl-mtext">@Html.T("العروض السريعة", "Flash Sales")</span>
                    </a>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Badges" || currentController == "Achievements" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-award"></i></span>
                        <span class="nxl-mtext">@Html.T("التحفيز", "Gamification")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Badges" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Badges" asp-action="Index" class="nxl-link">
                                <i class="feather-star me-2"></i>
                                @Html.T("الشارات", "Badges")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Achievements" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Achievements" asp-action="Index" class="nxl-link">
                                <i class="feather-award me-2"></i>
                                @Html.T("الإنجازات", "Achievements")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Announcements" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-speaker"></i></span>
                        <span class="nxl-mtext">@Html.T("الإعلانات", "Announcements")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Announcements" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Announcements" asp-action="Index" class="nxl-link">
                                <i class="feather-list me-2"></i>
                                @Html.T("جميع الإعلانات", "All Announcements")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Announcements" && currentAction == "Create" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Announcements" asp-action="Create" class="nxl-link">
                                <i class="feather-plus-circle me-2"></i>
                                @Html.T("إنشاء إعلان", "Create Announcement")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "EmailSettings" || currentController == "EmailTemplates" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-bell"></i></span>
                        <span class="nxl-mtext">@Html.T("الإشعارات", "Notifications")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "EmailSettings" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="EmailSettings" asp-action="Index" class="nxl-link">
                                <i class="feather-bell me-2"></i>
                                @Html.T("إعدادات البريد", "Email Settings")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "EmailTemplates" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="EmailTemplates" asp-action="Index" class="nxl-link">
                                <i class="feather-file-text me-2"></i>
                                @Html.T("قوالب البريد", "Email Templates")
                            </a>
                        </li>
                    </ul>
                </li>

                <!-- Settings & Support -->
                <li class="nxl-item nxl-caption">
                    <label>@Html.T("الإعدادات والدعم", "Settings & Support")</label>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Settings" || currentController == "PlatformSettings" || currentController == "LandingPageSettings" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-settings"></i></span>
                        <span class="nxl-mtext">@Html.T("الإعدادات العامة", "General Settings")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Settings" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Settings" asp-action="Index" class="nxl-link">
                                <i class="feather-grid me-2"></i>
                                @Html.T("نظرة عامة على الإعدادات", "Settings Overview")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "PlatformSettings" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="PlatformSettings" asp-action="Index" class="nxl-link">
                                <i class="feather-globe me-2"></i>
                                @Html.T("إعدادات المنصة", "Platform Settings")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "LandingPageSettings" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="LandingPageSettings" asp-action="Index" class="nxl-link">
                                <i class="feather-home me-2"></i>
                                @Html.T("إعدادات الصفحة الرئيسية", "Landing Page Settings")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Settings" && currentAction == "General" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Settings" asp-action="General" class="nxl-link">
                                <i class="feather-sliders me-2"></i>
                                @Html.T("الإعدادات العامة", "General Settings")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "SeoSettings" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="SeoSettings" asp-action="Index" class="nxl-link">
                                <i class="feather-search me-2"></i>
                                @Html.T("تحسين محركات البحث", "SEO")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Settings" && currentAction == "Localization" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Settings" asp-action="Localization" class="nxl-link">
                                <i class="feather-globe me-2"></i>
                                @Html.T("اللغة والتوطين", "Localization")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Settings" && currentAction == "Integrations" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Settings" asp-action="Integrations" class="nxl-link">
                                <i class="feather-link me-2"></i>
                                @Html.T("التكاملات", "Integrations")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "EmailSettings" || currentController == "SmsSettings" || currentController == "NotificationPreferences" || currentController == "PushNotificationSettings" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-mail"></i></span>
                        <span class="nxl-mtext">@Html.T("إعدادات التواصل", "Communication Settings")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "EmailSettings" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="EmailSettings" asp-action="Index" class="nxl-link">
                                <i class="feather-mail me-2"></i>
                                @Html.T("البريد الإلكتروني", "Email")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "SmsSettings" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="SmsSettings" asp-action="Index" class="nxl-link">
                                <i class="feather-message-circle me-2"></i>
                                @Html.T("الرسائل النصية", "SMS")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "NotificationPreferences" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="NotificationPreferences" asp-action="Index" class="nxl-link">
                                <i class="feather-bell me-2"></i>
                                @Html.T("تفضيلات الإشعارات", "Notification Preferences")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "PushNotificationSettings" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="PushNotificationSettings" asp-action="Index" class="nxl-link">
                                <i class="feather-send me-2"></i>
                                @Html.T("إعدادات إشعارات الدفع", "Push Notification Settings")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "PaymentSettings" || currentController == "PaymentGatewaySettings" || currentController == "Currencies" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-credit-card"></i></span>
                        <span class="nxl-mtext">@Html.T("إعدادات الدفع", "Payment Settings")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "PaymentSettings" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="PaymentSettings" asp-action="Index" class="nxl-link">
                                <i class="feather-settings me-2"></i>
                                @Html.T("الإعدادات العامة", "General Settings")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Currencies" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Currencies" asp-action="Index" class="nxl-link">
                                <i class="feather-globe me-2"></i>
                                @Html.T("العملات", "Currencies")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "PaymentGatewaySettings" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="PaymentGatewaySettings" asp-action="Index" class="nxl-link">
                                <i class="feather-credit-card me-2"></i>
                                @Html.T("بوابات الدفع", "Payment Gateways")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Security" || currentController == "SecuritySettings" || currentController == "Proctoring" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-shield"></i></span>
                        <span class="nxl-mtext">@Html.T("الأمان", "Security")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "SecuritySettings" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="SecuritySettings" asp-action="Index" class="nxl-link">
                                <i class="feather-shield me-2"></i>
                                @Html.T("إعدادات الأمان", "Security Settings")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Proctoring" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Proctoring" asp-action="Index" class="nxl-link">
                                <i class="feather-eye me-2"></i>
                                @Html.T("مراقبة الاختبارات", "Exam Proctoring")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Security" && currentAction == "Roles" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Security" asp-action="Roles" class="nxl-link">
                                <i class="feather-user-check me-2"></i>
                                @Html.T("الأدوار", "Roles")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Security" && currentAction == "Permissions" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Security" asp-action="Permissions" class="nxl-link">
                                <i class="feather-lock me-2"></i>
                                @Html.T("الصلاحيات", "Permissions")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Security" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Security" asp-action="Index" class="nxl-link">
                                <i class="feather-activity me-2"></i>
                                @Html.T("نظرة عامة على الأمان", "Security Overview")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Security" && currentAction == "LoginLogs" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Security" asp-action="LoginLogs" class="nxl-link">
                                <i class="feather-log-in me-2"></i>
                                @Html.T("سجل الدخول", "Login Logs")
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nxl-item nxl-hasmenu @(currentController == "Support" ? "active" : "")">
                    <a href="javascript:void(0);" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-headphones"></i></span>
                        <span class="nxl-mtext">@Html.T("الدعم الفني", "Technical Support")</span>
                        <span class="nxl-badge" id="open-tickets-badge"></span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Support" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Support" asp-action="Index" class="nxl-link">
                                <i class="feather-list me-2"></i>
                                @Html.T("جميع التذاكر", "All Tickets")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Support" && currentAction == "Index" && ViewContext.HttpContext.Request.Query["status"].ToString() == "Open" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Support" asp-action="Index" asp-route-status="Open" class="nxl-link">
                                <i class="feather-alert-circle me-2"></i>
                                @Html.T("التذاكر المفتوحة", "Open Tickets")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Support" && currentAction == "Categories" ? "active" : "")">
                            <a asp-area="Admin" asp-controller="Support" asp-action="Categories" class="nxl-link">
                                <i class="feather-folder me-2"></i>
                                @Html.T("تصنيفات التذاكر", "Ticket Categories")
                            </a>
                        </li>
                    </ul>
                </li>

                <!-- Help Center -->
                <li class="nxl-item @(currentController == "Help" ? "active" : "")">
                    <a asp-area="Admin" asp-controller="Help" asp-action="Index" class="nxl-link">
                        <span class="nxl-micon"><i class="feather-help-circle"></i></span>
                        <span class="nxl-mtext">@Html.T("مركز المساعدة", "Help Center")</span>
                        <span class="badge bg-soft-primary text-primary ms-2 fs-10">@Html.T("جديد", "New")</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<partial name="_SidebarScripts" />
