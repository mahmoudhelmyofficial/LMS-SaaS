@model LMS.Domain.Entities.Payments.Payment

@{
    ViewData["Title"] = Html.T("Ø§Ù„ÙØ§ØªÙˆØ±Ø©", "Invoice");
    Layout = null;
}

<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@Html.T("ÙØ§ØªÙˆØ±Ø©", "Invoice") #INV-@Model.Id.ToString("D8")</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            direction: rtl;
        }
        
        .invoice-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .invoice-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid #667eea;
        }
        
        .company-info h1 {
            font-size: 28px;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .company-info p {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .invoice-info {
            text-align: left;
        }
        
        .invoice-info h2 {
            font-size: 24px;
            color: #333;
            margin-bottom: 10px;
        }
        
        .invoice-info p {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .invoice-number {
            font-family: monospace;
            font-size: 16px;
            background: #f0f0f0;
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            margin-top: 10px;
        }
        
        .status-completed {
            background: #d4edda;
            color: #155724;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-failed {
            background: #f8d7da;
            color: #721c24;
        }
        
        .parties {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
        }
        
        .party {
            flex: 1;
        }
        
        .party h3 {
            font-size: 14px;
            color: #999;
            margin-bottom: 10px;
            text-transform: uppercase;
        }
        
        .party p {
            color: #333;
            margin-bottom: 5px;
        }
        
        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        
        .items-table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: right;
        }
        
        .items-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .items-table .text-left {
            text-align: left;
        }
        
        .totals {
            width: 300px;
            margin-right: auto;
        }
        
        .totals-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .totals-row.total {
            border-bottom: none;
            border-top: 2px solid #333;
            font-size: 20px;
            font-weight: bold;
            padding-top: 15px;
            margin-top: 10px;
        }
        
        .totals-row.total .amount {
            color: #667eea;
        }
        
        .invoice-footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            text-align: center;
            color: #999;
            font-size: 13px;
        }
        
        .print-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .print-btn:hover {
            background: #5568d3;
        }
        
        .back-btn {
            position: fixed;
            top: 20px;
            left: 120px;
            padding: 10px 20px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            text-decoration: none;
        }
        
        .back-btn:hover {
            background: #5a6268;
            color: white;
        }
        
        @@media print {
            body {
                background: white;
                padding: 0;
            }
            .invoice-container {
                box-shadow: none;
                padding: 20px;
            }
            .print-btn, .back-btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <button class="print-btn" onclick="window.print()">ğŸ–¨ï¸ @Html.T("Ø·Ø¨Ø§Ø¹Ø©", "Print")</button>
    <a href="@Url.Action("Details", "Payments", new { id = Model.Id })" class="back-btn">â† @Html.T("Ø±Ø¬ÙˆØ¹", "Back")</a>

    <div class="invoice-container">
        <!-- Header -->
        <div class="invoice-header">
            <div class="company-info">
                <h1>@Html.T("Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ", "E-Learning Platform")</h1>
                <p>ğŸ“ @Html.T("Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©", "Kingdom of Saudi Arabia")</p>
                <p>ğŸ“§ info@lms.com</p>
                <p>ğŸ“± +966 XX XXX XXXX</p>
            </div>
            <div class="invoice-info">
                <h2>@Html.T("ÙØ§ØªÙˆØ±Ø©", "Invoice")</h2>
                <p class="invoice-number">#INV-@Model.Id.ToString("D8")</p>
                <p>@Html.T("Ø§Ù„ØªØ§Ø±ÙŠØ®:", "Date:") @Model.CreatedAt.ToString("dd/MM/yyyy")</p>
                @{
                    var statusClass = Model.Status switch
                    {
                        LMS.Domain.Enums.PaymentStatus.Completed => "status-completed",
                        LMS.Domain.Enums.PaymentStatus.Pending => "status-pending",
                        _ => "status-failed"
                    };
                    var statusText = Model.Status switch
                    {
                        LMS.Domain.Enums.PaymentStatus.Completed => Html.T("Ù…Ø¯ÙÙˆØ¹Ø©", "Paid").ToString(),
                        LMS.Domain.Enums.PaymentStatus.Pending => Html.T("Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±", "Pending").ToString(),
                        LMS.Domain.Enums.PaymentStatus.Failed => Html.T("ÙØ§Ø´Ù„Ø©", "Failed").ToString(),
                        LMS.Domain.Enums.PaymentStatus.Refunded => Html.T("Ù…Ø³ØªØ±Ø¯Ø©", "Refunded").ToString(),
                        _ => Html.T("ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©", "Unknown").ToString()
                    };
                }
                <span class="status-badge @statusClass">@statusText</span>
            </div>
        </div>

        <!-- Parties -->
        <div class="parties">
            <div class="party">
                <h3>@Html.T("Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¥Ù„Ù‰", "Bill To")</h3>
                @if (Model.Student != null)
                {
                    <p><strong>@Model.Student.FirstName @Model.Student.LastName</strong></p>
                    <p>@Model.Student.Email</p>
                    @if (!string.IsNullOrEmpty(Model.Student.PhoneNumber))
                    {
                        <p>@Model.Student.PhoneNumber</p>
                    }
                }
            </div>
            <div class="party">
                <h3>@Html.T("ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¯ÙØ¹", "Payment details")</h3>
                <p>@Html.T("Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©:", "Transaction ID:") @(Model.TransactionId ?? "N/A")</p>
                <p>@Html.T("Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:", "Payment method:") @(Model.PaymentMethod ?? Html.T("ØºÙŠØ± Ù…Ø­Ø¯Ø¯", "Not specified").ToString())</p>
                <p>@Html.T("Ø§Ù„Ø¹Ù…Ù„Ø©:", "Currency:") @Model.Currency</p>
            </div>
        </div>

        <!-- Items Table -->
        <table class="items-table">
            <thead>
                <tr>
                    <th>@Html.T("Ø§Ù„ÙˆØµÙ", "Description")</th>
                    <th class="text-left">@Html.T("Ø§Ù„Ù…Ø¨Ù„Øº", "Amount")</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        @if (Model.Course != null)
                        {
                            <strong>@Model.Course.Title</strong>
                            <br>
                            <small style="color: #666;">@Html.T("Ø¯ÙˆØ±Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ©", "Course")</small>
                        }
                        else
                        {
                            <span>@Html.T("Ø¹Ù…Ù„ÙŠØ© Ø´Ø±Ø§Ø¡", "Purchase")</span>
                        }
                    </td>
                    <td class="text-left">@Model.OriginalAmount.ToString("N2") @Model.Currency</td>
                </tr>
            </tbody>
        </table>

        <!-- Totals -->
        <div class="totals">
            <div class="totals-row">
                <span>@Html.T("Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø£ØµÙ„ÙŠ:", "Original amount:")</span>
                <span>@Model.OriginalAmount.ToString("N2") @Model.Currency</span>
            </div>
            @if (Model.DiscountAmount > 0)
            {
                <div class="totals-row">
                    <span>@Html.T("Ø§Ù„Ø®ØµÙ…:", "Discount:")</span>
                    <span style="color: #28a745;">-@Model.DiscountAmount.ToString("N2") @Model.Currency</span>
                </div>
            }
            @if (Model.TaxAmount > 0)
            {
                <div class="totals-row">
                    <span>@Html.T("Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©", "Tax") (@Model.TaxPercentage%):</span>
                    <span>@Model.TaxAmount.ToString("N2") @Model.Currency</span>
                </div>
            }
            <div class="totals-row total">
                <span>@Html.T("Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:", "Total:")</span>
                <span class="amount">@Model.TotalAmount.ToString("N2") @Model.Currency</span>
            </div>
        </div>

        <!-- Footer -->
        <div class="invoice-footer">
            <p>@Html.T("Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø®ØªÙŠØ§Ø±Ùƒ Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ", "Thank you for choosing our e-learning platform")</p>
            <p>@Html.T("Ù‡Ø°Ù‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ØµØ§Ø¯Ø±Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹ ÙˆÙ„Ø§ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªÙˆÙ‚ÙŠØ¹ Ø£Ùˆ Ø®ØªÙ…", "This invoice is issued electronically and does not require a signature or stamp")</p>
            <p>Â© @DateTime.Now.Year @Html.T("Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©", "All rights reserved")</p>
        </div>
    </div>
</body>
</html>

