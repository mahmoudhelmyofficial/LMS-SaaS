@model LMS.Areas.Admin.Controllers.InstructorEditViewModel

@{
    var instructor = ViewBag.Instructor as LMS.Domain.Entities.Users.InstructorProfile;
    ViewData["Title"] = Html.T("تعديل بيانات المدرس", "Edit instructor");
    var breadcrumbs = new List<(string Name, string? Url)>
    {
        (Html.T("إدارة المدرسين", "Instructors"), Url.Action("Index", "Instructors")),
        ($"{instructor?.User?.FirstName} {instructor?.User?.LastName}", Url.Action("Details", "Instructors", new { id = Model.UserId })),
        (Html.T("تعديل", "Edit"), null)
    };
    ViewData["Breadcrumbs"] = breadcrumbs;
}

@await Html.PartialAsync("_PageHeader")

<div class="main-content">
    <form asp-action="Edit" asp-route-id="@Model.UserId" method="post">
        @Html.AntiForgeryToken()
        <input type="hidden" asp-for="UserId" />
        
        <div class="row">
            <div class="col-lg-8">
                <div class="card stretch stretch-full">
                    <div class="card-header">
                        <h5 class="card-title">@Html.T("معلومات المدرس", "Instructor information")</h5>
                    </div>
                    <div class="card-body">
                        <div class="row g-4">
                            <div class="col-md-6">
                                <label class="form-label">@Html.T("الاسم الأول", "First name")</label>
                                <input type="text" class="form-control" value="@instructor?.User?.FirstName" readonly />
                                <small class="text-muted">@Html.T("يتم تحديثه من إعدادات المستخدم", "Updated from user settings")</small>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">@Html.T("الاسم الأخير", "Last name")</label>
                                <input type="text" class="form-control" value="@instructor?.User?.LastName" readonly />
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">@Html.T("البريد الإلكتروني", "Email")</label>
                                <input type="email" class="form-control" value="@instructor?.User?.Email" readonly />
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">@Html.T("رقم الهاتف", "Phone number")</label>
                                <input type="text" class="form-control" value="@instructor?.User?.PhoneNumber" readonly />
                            </div>

                            <div class="col-12">
                                <label class="form-label" asp-for="Bio">@Html.T("السيرة الذاتية", "Bio")</label>
                                <textarea class="form-control" asp-for="Bio" rows="5" placeholder="@Html.T("نبذة عن المدرس وخبراته...", "Brief about the instructor and experience...")"></textarea>
                                <span asp-validation-for="Bio" class="text-danger"></span>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label" asp-for="Expertise">@Html.T("التخصص", "Expertise")</label>
                                <input type="text" class="form-control" asp-for="Expertise" placeholder="@Html.T("مثال: تطوير الويب", "e.g. Web development")" />
                                <span asp-validation-for="Expertise" class="text-danger"></span>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label" asp-for="YearsOfExperience">@Html.T("سنوات الخبرة", "Years of experience")</label>
                                <input type="number" class="form-control" asp-for="YearsOfExperience" min="0" />
                                <span asp-validation-for="YearsOfExperience" class="text-danger"></span>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label" asp-for="CommissionRate">@Html.T("نسبة العمولة (%)", "Commission rate (%)")</label>
                                <input type="number" class="form-control" asp-for="CommissionRate" min="0" max="100" step="0.1" />
                                <span asp-validation-for="CommissionRate" class="text-danger"></span>
                                <small class="text-muted">@Html.T("النسبة التي يحصل عليها المدرس من كل عملية بيع", "The percentage the instructor gets from each sale")</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="card stretch stretch-full mb-4">
                    <div class="card-header">
                        <h5 class="card-title">@Html.T("الإعدادات", "Settings")</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" asp-for="IsApproved" id="isApproved" />
                                <label class="form-check-label" for="isApproved">@Html.T("موافق عليه", "Approved")</label>
                            </div>
                            <small class="text-muted">@Html.T("السماح للمدرس بإنشاء ونشر الدورات", "Allow instructor to create and publish courses")</small>
                        </div>
                        <div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" asp-for="IsSuspended" id="isSuspended" />
                                <label class="form-check-label" for="isSuspended">@Html.T("معلق", "Suspended")</label>
                            </div>
                            <small class="text-muted">@Html.T("تعليق حساب المدرس مؤقتاً", "Temporarily suspend the instructor account")</small>
                        </div>
                    </div>
                </div>

                <div class="card stretch stretch-full mb-4">
                    <div class="card-header">
                        <h5 class="card-title">@Html.T("الإحصائيات", "Statistics")</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="text-muted fs-12">@Html.T("عدد الدورات", "Number of courses")</label>
                            <h5 class="fw-bold mb-0">@(instructor?.TotalCourses ?? 0)</h5>
                        </div>
                        <div class="mb-3">
                            <label class="text-muted fs-12">@Html.T("إجمالي الطلاب", "Total students")</label>
                            <h5 class="fw-bold mb-0">@(instructor?.TotalStudents ?? 0)</h5>
                        </div>
                        <div>
                            <label class="text-muted fs-12">@Html.T("التقييم", "Rating")</label>
                            <h5 class="fw-bold mb-0">@(instructor?.AverageRating.ToString("F1") ?? "0.0") ⭐</h5>
                        </div>
                    </div>
                </div>

                <div class="card stretch stretch-full">
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="feather-save me-2"></i>
                                حفظ التعديلات
                            </button>
                            <a href="@Url.Action("Details", "Instructors", new { id = Model.UserId })" class="btn btn-light">
                                <i class="feather-x me-2"></i>
                                إلغاء
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
