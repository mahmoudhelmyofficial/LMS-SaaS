@model LMS.Areas.Admin.ViewModels.SeoSettingViewModel

@{
    ViewData["Title"] = Html.T("تعديل إعدادات SEO", "Edit SEO settings");
    var breadcrumbs = new List<(string Name, string? Url)>
    {
        (Html.T("لوحة التحكم", "Dashboard"), Url.Action("Index", "Dashboard")),
        (Html.T("إعدادات المنصة", "Platform settings"), Url.Action("Index", "PlatformSettings")),
        (Html.T("إعدادات SEO", "SEO settings"), Url.Action("Index", "SeoSettings")),
        (Html.T("تعديل", "Edit"), null)
    };
    ViewData["Breadcrumbs"] = breadcrumbs;
}

@await Html.PartialAsync("_PageHeader")

<div class="main-content">
    <form asp-action="EditSeoSetting" method="post">
        @Html.AntiForgeryToken()
        <input type="hidden" asp-for="Id" />
        
        <div class="row">
            <div class="col-lg-8">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="card-title">@Html.T("معلومات أساسية", "Basic information")</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label asp-for="PageType" class="form-label">@Html.T("نوع الصفحة", "Page type") <span class="text-danger">*</span></label>
                            <select asp-for="PageType" class="form-select" disabled>
                                <option value="">@Html.T("اختر نوع الصفحة", "Select page type")</option>
                                <option value="Home">@Html.T("الرئيسية", "Home")</option>
                                <option value="Courses">@Html.T("الدورات", "Courses")</option>
                                <option value="Blog">@Html.T("المدونة", "Blog")</option>
                                <option value="About">@Html.T("من نحن", "About")</option>
                                <option value="Contact">@Html.T("اتصل بنا", "Contact")</option>
                            </select>
                            <small class="text-muted">@Html.T("لا يمكن تغيير نوع الصفحة بعد الإنشاء", "Page type cannot be changed after creation")</small>
                            <input type="hidden" asp-for="PageType" />
                        </div>

                        <div class="mb-3">
                            <label asp-for="MetaTitle" class="form-label">@Html.T("عنوان الصفحة (Meta Title)", "Page title (Meta Title)") <span class="text-danger">*</span></label>
                            <input asp-for="MetaTitle" class="form-control" maxlength="60" />
                            <span asp-validation-for="MetaTitle" class="text-danger"></span>
                            <small class="text-muted">@Html.T("يُفضل أن يكون بين 50-60 حرف", "Preferably 50-60 characters")</small>
                        </div>

                        <div class="mb-3">
                            <label asp-for="MetaDescription" class="form-label">@Html.T("الوصف (Meta Description)", "Description (Meta Description)") <span class="text-danger">*</span></label>
                            <textarea asp-for="MetaDescription" class="form-control" rows="3" maxlength="160"></textarea>
                            <span asp-validation-for="MetaDescription" class="text-danger"></span>
                            <small class="text-muted">@Html.T("يُفضل أن يكون بين 150-160 حرف", "Preferably 150-160 characters")</small>
                        </div>

                        <div class="mb-3">
                            <label asp-for="MetaKeywords" class="form-label">@Html.T("الكلمات المفتاحية (Keywords)", "Keywords")</label>
                            <input asp-for="MetaKeywords" class="form-control" />
                            <span asp-validation-for="MetaKeywords" class="text-danger"></span>
                            <small class="text-muted">@Html.T("افصل بين الكلمات بفاصلة (,)", "Separate with comma (,)")</small>
                        </div>

                        <div class="mb-3">
                            <label asp-for="CanonicalUrl" class="form-label">@Html.T("الرابط الأساسي (Canonical URL)", "Canonical URL")</label>
                            <input asp-for="CanonicalUrl" class="form-control" type="url" placeholder="https://" />
                            <span asp-validation-for="CanonicalUrl" class="text-danger"></span>
                            <small class="text-muted">@Html.T("الرابط المفضل لهذه الصفحة", "Preferred URL for this page")</small>
                        </div>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="card-title">@Html.T("Open Graph ووسائل التواصل", "Open Graph & Social Media")</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label asp-for="OgTitle" class="form-label">@Html.T("عنوان Open Graph", "Open Graph title")</label>
                            <input asp-for="OgTitle" class="form-control" />
                            <small class="text-muted">@Html.T("العنوان عند المشاركة على وسائل التواصل", "Title when sharing on social media")</small>
                        </div>

                        <div class="mb-3">
                            <label asp-for="OgDescription" class="form-label">@Html.T("وصف Open Graph", "Open Graph description")</label>
                            <textarea asp-for="OgDescription" class="form-control" rows="2"></textarea>
                            <small class="text-muted">@Html.T("الوصف عند المشاركة على وسائل التواصل", "Description when sharing on social media")</small>
                        </div>

                        <div class="mb-3">
                            <label asp-for="OgImage" class="form-label">@Html.T("صورة Open Graph", "Open Graph image")</label>
                            <input asp-for="OgImage" class="form-control" type="url" placeholder="https://" />
                            <small class="text-muted">@Html.T("الصورة عند المشاركة (يُفضل 1200x630 بكسل)", "Image when sharing (prefer 1200x630 px)")</small>
                        </div>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="card-title">@Html.T("إعدادات متقدمة", "Advanced settings")</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="RobotsDirective" class="form-label">@Html.T("توجيهات Robots", "Robots directive")</label>
                                <select asp-for="RobotsDirective" class="form-select">
                                    <option value="index,follow">@Html.T("فهرسة ومتابعة", "Index, Follow")</option>
                                    <option value="noindex,follow">@Html.T("عدم فهرسة ومتابعة", "No Index, Follow")</option>
                                    <option value="index,nofollow">@Html.T("فهرسة وعدم متابعة", "Index, No Follow")</option>
                                    <option value="noindex,nofollow">@Html.T("عدم فهرسة وعدم متابعة", "No Index, No Follow")</option>
                                </select>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label asp-for="SchemaType" class="form-label">@Html.T("نوع Schema", "Schema type")</label>
                                <select asp-for="SchemaType" class="form-select">
                                    <option value="">@Html.T("بدون", "None")</option>
                                    <option value="Article">@Html.T("مقال", "Article")</option>
                                    <option value="Course">@Html.T("دورة", "Course")</option>
                                    <option value="Organization">@Html.T("منظمة", "Organization")</option>
                                    <option value="WebPage">@Html.T("صفحة ويب", "WebPage")</option>
                                </select>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label asp-for="StructuredData" class="form-label">@Html.T("بيانات منظمة (JSON-LD)", "Structured data (JSON-LD)")</label>
                            <textarea asp-for="StructuredData" class="form-control" rows="4" placeholder='{"@@context": "https://schema.org", ...}'></textarea>
                            <small class="text-muted">@Html.T("أدخل JSON-LD schema markup", "Enter JSON-LD schema markup")</small>
                        </div>

                        <div class="form-check form-switch mb-3">
                            <input asp-for="IsActive" class="form-check-input" type="checkbox" />
                            <label class="form-check-label" asp-for="IsActive">
                                <strong>@Html.T("تفعيل", "Enable")</strong>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-primary">
                        <i class="feather-save me-2"></i>حفظ التعديلات
                    </button>
                    <a asp-action="SeoSettings" class="btn btn-light">
                        <i class="feather-x me-2"></i>إلغاء
                    </a>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="card-title">
                            <i class="feather-info me-2"></i>إرشادات
                        </h5>
                    </div>
                    <div class="card-body">
                        <h6>نصائح SEO:</h6>
                        <ul class="small">
                            <li>استخدم عنوان واضح وجذاب</li>
                            <li>أضف كلمات مفتاحية مناسبة</li>
                            <li>اجعل الوصف محفزاً للنقر</li>
                            <li>استخدم صورة بجودة عالية</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">
                            <i class="feather-eye me-2"></i>معاينة
                        </h5>
                    </div>
                    <div class="card-body">
                        <p class="small text-primary mb-1" id="preview-title">@Model.MetaTitle</p>
                        <p class="small text-muted mb-0" id="preview-description">@Model.MetaDescription</p>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script>
        // Live preview
        $('input[name="MetaTitle"]').on('input', function() {
            $('#preview-title').text($(this).val() || 'عنوان الصفحة');
        });
        $('textarea[name="MetaDescription"]').on('input', function() {
            $('#preview-description').text($(this).val() || 'وصف الصفحة');
        });
    </script>
}

