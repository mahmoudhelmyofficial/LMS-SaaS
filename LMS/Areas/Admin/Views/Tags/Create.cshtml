@model LMS.Areas.Admin.ViewModels.TagViewModel

@{
    ViewData["Title"] = Html.T("إضافة وسم جديد", "Add new tag");
    var breadcrumbs = new List<(string Name, string? Url)>
    {
        (Html.T("المحتوى", "Content"), null),
        (Html.T("الوسوم", "Tags"), Url.Action("Index", "Tags")),
        (Html.T("إضافة وسم", "Add tag"), null)
    };
    ViewData["Breadcrumbs"] = breadcrumbs;
}

@await Html.PartialAsync("_PageHeader")

<!-- Main Content -->
<div class="main-content">
    <form asp-action="Create" method="post">
        <div class="row">
            <div class="col-lg-8">
                <div class="card stretch stretch-full">
                    <div class="card-header">
                        <h5 class="card-title">@Html.T("معلومات الوسم", "Tag information")</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label asp-for="Name" class="form-label">@Html.T("اسم الوسم", "Tag name") <span class="text-danger">*</span></label>
                            <input asp-for="Name" class="form-control" placeholder="@Html.T("مثال: برمجة، تصميم، تسويق", "e.g. Programming, Design, Marketing")" required />
                            <span asp-validation-for="Name" class="text-danger"></span>
                            <small class="text-muted">@Html.T("يُفضل استخدام اسم قصير ومعبر", "Use a short and descriptive name")</small>
                        </div>

                        <div class="mb-3">
                            <label asp-for="Slug" class="form-label">@Html.T("الرابط الودي (Slug)", "Friendly URL (Slug)")</label>
                            <input asp-for="Slug" class="form-control" placeholder="@Html.T("سيتم إنشاؤه تلقائياً", "Will be generated automatically")" />
                            <span asp-validation-for="Slug" class="text-danger"></span>
                            <small class="text-muted">@Html.T("سيظهر في رابط URL", "Will appear in the URL")</small>
                        </div>

                        <div class="mb-3">
                            <label asp-for="Description" class="form-label">@Html.T("الوصف", "Description")</label>
                            <textarea asp-for="Description" class="form-control" rows="4" placeholder="@Html.T("وصف مختصر عن هذا الوسم", "Brief description of this tag")"></textarea>
                            <span asp-validation-for="Description" class="text-danger"></span>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="Color" class="form-label">@Html.T("لون الوسم", "Tag color")</label>
                                <div class="d-flex align-items-center gap-3">
                                    <input asp-for="Color" type="color" class="form-control form-control-color" value="#3454d1" />
                                    <input type="text" class="form-control" id="colorHex" value="#3454d1" />
                                </div>
                                <small class="text-muted">@Html.T("اللون الذي سيظهر به الوسم في الموقع", "Color shown for the tag on the site")</small>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label class="form-label">@Html.T("أيقونة (اختياري)", "Icon (optional)")</label>
                                <input type="text" class="form-control" name="Icon" placeholder="feather-code" />
                                <small class="text-muted">@Html.T("اسم أيقونة Feather", "Feather icon name")</small>
                            </div>
                        </div>

                        <div class="alert alert-info">
                            <i class="feather-info me-2"></i>
                            @Html.T("سيمكنك ربط هذا الوسم بالدورات بعد إنشائه", "You can link this tag to courses after creating it")
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <!-- Actions -->
                <div class="card stretch stretch-full mb-4">
                    <div class="card-header">
                        <h5 class="card-title">@Html.T("إجراءات", "Actions")</h5>
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="feather-save me-2"></i>
                                حفظ الوسم
                            </button>
                            <a asp-action="Index" class="btn btn-light">
                                <i class="feather-x me-2"></i>
                                إلغاء
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Settings -->
                <div class="card stretch stretch-full mb-4">
                    <div class="card-header">
                        <h5 class="card-title">@Html.T("إعدادات", "Settings")</h5>
                    </div>
                    <div class="card-body">
                        <div class="form-check form-switch mb-3">
                            <input class="form-check-input" type="checkbox" id="isActiveSwitch" asp-for="IsActive" checked>
                            <label class="form-check-label" for="isActiveSwitch">
                                وسم نشط
                            </label>
                        </div>

                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="isFeaturedSwitch" name="IsFeatured">
                            <label class="form-check-label" for="isFeaturedSwitch">
                                وسم مميز
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Preview -->
                <div class="card stretch stretch-full">
                    <div class="card-header">
                        <h5 class="card-title">@Html.T("معاينة", "Preview")</h5>
                    </div>
                    <div class="card-body text-center">
                        <div id="tagPreview" class="badge" style="background-color: #3454d1; color: white; padding: 10px 20px; font-size: 1rem;">
                            <i class="feather-tag me-2"></i>
                            <span id="previewName">وسم جديد</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        $(document).ready(function() {
            // Update preview when name changes
            $('input[name="Name"]').on('input', function() {
                $('#previewName').text($(this).val() || 'وسم جديد');
            });

            // Sync color picker and hex input
            $('input[name="Color"]').on('input', function() {
                $('#colorHex').val($(this).val());
                $('#tagPreview').css('background-color', $(this).val());
            });

            $('#colorHex').on('input', function() {
                $('input[name="Color"]').val($(this).val());
                $('#tagPreview').css('background-color', $(this).val());
            });

            // Auto-generate slug from name
            $('input[name="Name"]').on('blur', function() {
                if (!$('input[name="Slug"]').val()) {
                    var slug = $(this).val()
                        .toLowerCase()
                        .replace(/[^\w\s-]/g, '')
                        .replace(/\s+/g, '-');
                    $('input[name="Slug"]').val(slug);
                }
            });
        });
    </script>
}

