@model LMS.Areas.Instructor.ViewModels.CourseInstructorViewModel

@{
    ViewData["Title"] = Html.T("إضافة مدرس مساعد", "Add Co-Instructor");
    ViewData["Subtitle"] = Html.T("إضافة مدرس مساعد جديد للدورة", "Add new co-instructor to course");
    var availableInstructors = ViewBag.AvailableInstructors as IEnumerable<dynamic>;
    var indexUrl = Url.Action("Index", new { courseId = Model.CourseId });
}

@await Html.PartialAsync("_PageHeader", new ViewDataDictionary(ViewData)
{
    { "ActionButtons", Html.Raw($@"
        <a href='{indexUrl}' class='btn btn-light'>
            <i class='feather-arrow-right me-2'></i>
            العودة
        </a>
    ") }
})

<div class="main-content">
    @await Html.PartialAsync("_AlertMessages")

    <div class="row">
        <div class="col-lg-8 mx-auto">
            <div class="card stretch stretch-full">
                <div class="card-header">
                    <h5 class="card-title">@Html.T("إضافة مدرس مساعد", "Add co-instructor")</h5>
                    <p class="text-muted mb-0">للدورة: @ViewBag.CourseName</p>
                </div>
                <div class="card-body">
                    <form asp-action="Add" method="post">
                        @Html.AntiForgeryToken()
                        @Html.HiddenFor(m => m.CourseId)

                        <div asp-validation-summary="ModelOnly" class="alert alert-danger"></div>

                        <!-- Instructor Selection -->
                        <div class="mb-4">
                            <label asp-for="InstructorId" class="form-label required">اختر المدرس</label>
                            <select asp-for="InstructorId" class="form-select" required>
                                <option value="">-- اختر مدرس --</option>
                                @if (availableInstructors != null)
                                {
                                    foreach (var inst in availableInstructors)
                                    {
                                        <option value="@inst.UserId">@inst.FullName (@inst.Email)</option>
                                    }
                                }
                            </select>
                            <span asp-validation-for="InstructorId" class="text-danger"></span>
                        </div>

                        <!-- Role and Title -->
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <label asp-for="Role" class="form-label">الدور</label>
                                <input asp-for="Role" class="form-control" placeholder="@Html.T("مثل: مدرس مساعد، محاضر زائر", "e.g. Teaching assistant, Guest lecturer")" />
                                <span asp-validation-for="Role" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="CustomTitle" class="form-label">العنوان المخصص</label>
                                <input asp-for="CustomTitle" class="form-control" placeholder="@Html.T("مثل: خبير في...", "e.g. Expert in...")" />
                                <span asp-validation-for="CustomTitle" class="text-danger"></span>
                            </div>
                        </div>

                        <!-- Revenue Share -->
                        <div class="mb-4">
                            <label asp-for="RevenueSharePercentage" class="form-label">نسبة مشاركة الأرباح (%)</label>
                            <input asp-for="RevenueSharePercentage" type="number" class="form-control" min="0" max="100" step="0.01" placeholder="0.00" />
                            <div class="form-text">النسبة المئوية من أرباح الدورة التي سيحصل عليها هذا المدرس</div>
                            <span asp-validation-for="RevenueSharePercentage" class="text-danger"></span>
                        </div>

                        <!-- Permissions Section -->
                        <div class="card border mb-4">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">@Html.T("صلاحيات المحتوى والإدارة", "Content and management permissions")</h6>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="form-check form-switch">
                                            <input asp-for="CanEditContent" class="form-check-input" type="checkbox" />
                                            <label asp-for="CanEditContent" class="form-check-label">
                                                <strong>@Html.T("تعديل المحتوى", "Edit content")</strong>
                                                <span class="d-block text-muted fs-11">إضافة وتعديل المحاضرات والمواد</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check form-switch">
                                            <input asp-for="CanManageStudents" class="form-check-input" type="checkbox" />
                                            <label asp-for="CanManageStudents" class="form-check-label">
                                                <strong>إدارة الطلاب</strong>
                                                <span class="d-block text-muted fs-11">عرض وإدارة الطلاب المسجلين</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check form-switch">
                                            <input asp-for="CanGradeAssignments" class="form-check-input" type="checkbox" />
                                            <label asp-for="CanGradeAssignments" class="form-check-label">
                                                <strong>تقييم الواجبات</strong>
                                                <span class="d-block text-muted fs-11">مراجعة وتقييم واجبات الطلاب</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check form-switch">
                                            <input asp-for="CanHostLiveClasses" class="form-check-input" type="checkbox" />
                                            <label asp-for="CanHostLiveClasses" class="form-check-label">
                                                <strong>استضافة البث المباشر</strong>
                                                <span class="d-block text-muted fs-11">إنشاء وإدارة الجلسات المباشرة</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check form-switch">
                                            <input asp-for="CanReplyDiscussions" class="form-check-input" type="checkbox" />
                                            <label asp-for="CanReplyDiscussions" class="form-check-label">
                                                <strong>الرد على المناقشات</strong>
                                                <span class="d-block text-muted fs-11">الرد على استفسارات الطلاب</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check form-switch">
                                            <input asp-for="CanSendAnnouncements" class="form-check-input" type="checkbox" />
                                            <label asp-for="CanSendAnnouncements" class="form-check-label">
                                                <strong>إرسال الإعلانات</strong>
                                                <span class="d-block text-muted fs-11">إرسال إعلانات للطلاب</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check form-switch">
                                            <input asp-for="CanViewAnalytics" class="form-check-input" type="checkbox" />
                                            <label asp-for="CanViewAnalytics" class="form-check-label">
                                                <strong>@Html.T("عرض التحليلات", "View analytics")</strong>
                                                <span class="d-block text-muted fs-11">الوصول لإحصائيات الدورة</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check form-switch">
                                            <input asp-for="CanManagePricing" class="form-check-input" type="checkbox" />
                                            <label asp-for="CanManagePricing" class="form-check-label">
                                                <strong>إدارة الأسعار</strong>
                                                <span class="d-block text-muted fs-11">تغيير سعر الدورة</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check form-switch">
                                            <input asp-for="CanManageCoupons" class="form-check-input" type="checkbox" />
                                            <label asp-for="CanManageCoupons" class="form-check-label">
                                                <strong>إدارة الكوبونات</strong>
                                                <span class="d-block text-muted fs-11">إنشاء وإدارة كوبونات الخصم</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Notes -->
                        <div class="mb-4">
                            <label asp-for="Notes" class="form-label">ملاحظات</label>
                            <textarea asp-for="Notes" class="form-control" rows="3" placeholder="@Html.T("أي ملاحظات أو تعليمات إضافية...", "Any additional notes or instructions...")"></textarea>
                            <span asp-validation-for="Notes" class="text-danger"></span>
                        </div>

                        <!-- Action Buttons -->
                        <div class="d-flex gap-2 justify-content-end">
                            <a href="@Url.Action("Index", new { courseId = Model.CourseId })" class="btn btn-light">
                                <i class="feather-x me-2"></i>
                                إلغاء
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="feather-check me-2"></i>
                                إضافة المدرس
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}

