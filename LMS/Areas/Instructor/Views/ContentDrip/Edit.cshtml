@model LMS.Areas.Instructor.ViewModels.ContentDripRuleViewModel

@{
    ViewData["Title"] = Html.T("تعديل قاعدة الجدولة", "Edit Scheduling Rule");
    ViewData["Subtitle"] = Html.T("تحديث إعدادات جدولة المحتوى", "Update content scheduling settings");
    var detailsUrl = Url.Action("Details", new { id = Model.Id });
    var indexUrl = Url.Action("Index");
}

@await Html.PartialAsync("_PageHeader", new ViewDataDictionary(ViewData)
{
    { "ActionButtons", Html.Raw($@"
        <a href='{detailsUrl}' class='btn btn-light'>
            <i class='feather-eye me-2'></i>
            عرض التفاصيل
        </a>
        <a href='{indexUrl}' class='btn btn-light'>
            <i class='feather-arrow-right me-2'></i>
            العودة للقائمة
        </a>
    ") }
})

<div class="main-content">
    @await Html.PartialAsync("_AlertMessages")

    <form asp-action="Edit" asp-route-id="@Model.Id" method="post" id="dripRuleForm">
        @Html.AntiForgeryToken()
        <input type="hidden" asp-for="Id" />
        <input type="hidden" asp-for="CourseId" />
        
        <div class="row">
            <!-- Main Content -->
            <div class="col-lg-8">
                <!-- Course Info (Read-only) -->
                <div class="card stretch stretch-full mb-4">
                    <div class="card-header bg-soft-secondary">
                        <h6 class="card-title mb-0">
                            <i class="feather-info me-2"></i>
                            المحتوى المطبق
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-light mb-3">
                            <i class="feather-lock me-2"></i>
                            <small>لا يمكن تغيير الدورة أو المحتوى بعد الإنشاء</small>
                        </div>
                        <div class="d-flex align-items-center gap-3">
                            <div class="avatar-text avatar-lg bg-soft-primary text-primary">
                                <i class="feather-book"></i>
                            </div>
                            <div>
                                <small class="text-muted d-block">الدورة:</small>
                                <h6 class="fw-bold mb-0">@ViewBag.CourseName</h6>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Content Selection (if applicable) -->
                <div class="card stretch stretch-full mb-4">
                    <div class="card-header">
                        <h5 class="card-title">
                            <i class="feather-layers me-2 text-primary"></i>
                            تحديد المحتوى
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row g-4">
                            <div class="col-md-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="applyCourseWide" 
                                           @(Model.ModuleId == null && Model.LessonId == null ? "checked" : "")>
                                    <label class="form-check-label" for="applyCourseWide">
                                        تطبيق على الدورة بالكامل
                                    </label>
                                </div>
                            </div>

                            <div id="specificContentDiv" style="display: @(Model.ModuleId != null || Model.LessonId != null ? "block" : "none");">
                                <div class="row g-4">
                                    <div class="col-md-6">
                                        <label class="form-label">@Html.T("الوحدة (اختياري)", "Module (optional)")</label>
                                        <select asp-for="ModuleId" class="form-select" asp-items="ViewBag.Modules" id="moduleSelect">
                                            <option value="">-- اختر الوحدة --</option>
                                        </select>
                                        <span asp-validation-for="ModuleId" class="text-danger"></span>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label">@Html.T("الدرس (اختياري)", "Lesson (optional)")</label>
                                        <select asp-for="LessonId" class="form-select" asp-items="ViewBag.Lessons" id="lessonSelect">
                                            <option value="">-- اختر الدرس --</option>
                                        </select>
                                        <span asp-validation-for="LessonId" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Drip Settings -->
                <div class="card stretch stretch-full mb-4">
                    <div class="card-header">
                        <h5 class="card-title">
                            <i class="feather-clock me-2 text-primary"></i>
                            إعدادات الجدولة
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row g-4">
                            <div class="col-md-12">
                                <label class="form-label">@Html.T("نوع الجدولة", "Schedule type") <span class="text-danger">*</span></label>
                                <select asp-for="DripType" class="form-select form-select-lg" id="dripTypeSelect" required>
                                    <option value="">-- @Html.T("اختر نوع الجدولة", "Select schedule type") --</option>
                                    <option value="@LMS.Domain.Enums.ContentDripType.AllAtOnce">@Html.T("كل المحتوى فوراً", "All content at once")</option>
                                    <option value="@LMS.Domain.Enums.ContentDripType.DaysAfterEnrollment">@Html.T("بعد أيام من التسجيل", "Days after enrollment")</option>
                                    <option value="@LMS.Domain.Enums.ContentDripType.SpecificDate">@Html.T("تاريخ محدد", "Specific date")</option>
                                    <option value="@LMS.Domain.Enums.ContentDripType.Weekly">@Html.T("أسبوعياً", "Weekly")</option>
                                    <option value="@LMS.Domain.Enums.ContentDripType.Monthly">@Html.T("شهرياً", "Monthly")</option>
                                </select>
                                <span asp-validation-for="DripType" class="text-danger"></span>
                            </div>

                            <div class="col-md-12">
                                <div id="dripSettings" style="display: none;">
                                    <!-- Days After Enrollment -->
                                    <div id="daysAfterDiv" class="drip-option" style="display: none;">
                                        <div class="alert alert-info mb-3">
                                            <i class="feather-info me-2"></i>
                                            @Html.T("سيكون المحتوى متاحاً بعد عدد معين من الأيام من تسجيل الطالب", "Content will be available after a set number of days from student enrollment")
                                        </div>
                                        <label class="form-label">@Html.T("عدد الأيام", "Number of days")</label>
                                        <input asp-for="DaysAfterEnrollment" type="number" class="form-control" min="0" placeholder="7">
                                        <span asp-validation-for="DaysAfterEnrollment" class="text-danger"></span>
                                        <div class="form-text">@Html.T("أدخل 0 لإتاحة المحتوى فوراً، أو أكثر لتأخير الإطلاق", "Enter 0 to make content available immediately, or a higher number to delay release")</div>
                                    </div>

                                    <!-- Specific Date -->
                                    <div id="specificDateDiv" class="drip-option" style="display: none;">
                                        <div class="alert alert-info mb-3">
                                            <i class="feather-info me-2"></i>
                                            @Html.T("سيكون المحتوى متاحاً في تاريخ ووقت محدد", "Content will be available at a specific date and time")
                                        </div>
                                        <label class="form-label">@Html.T("التاريخ والوقت", "Date and time")</label>
                                        <input asp-for="SpecificDate" type="datetime-local" class="form-control" value="@(Model.SpecificDate?.ToString("yyyy-MM-ddTHH:mm"))">
                                        <span asp-validation-for="SpecificDate" class="text-danger"></span>
                                    </div>

                                    <!-- Weekly -->
                                    <div id="weeklyDiv" class="drip-option" style="display: none;">
                                        <div class="alert alert-info mb-3">
                                            <i class="feather-info me-2"></i>
                                            @Html.T("سيكون المحتوى متاحاً في يوم معين من كل أسبوع", "Content will be available on a specific day each week")
                                        </div>
                                        <label class="form-label">@Html.T("يوم الأسبوع", "Day of week")</label>
                                        <select asp-for="DayOfWeek" class="form-select">
                                            <option value="">-- @Html.T("اختر اليوم", "Select day") --</option>
                                            <option value="0">@Html.T("الأحد", "Sunday")</option>
                                            <option value="1">@Html.T("الإثنين", "Monday")</option>
                                            <option value="2">@Html.T("الثلاثاء", "Tuesday")</option>
                                            <option value="3">@Html.T("الأربعاء", "Wednesday")</option>
                                            <option value="4">@Html.T("الخميس", "Thursday")</option>
                                            <option value="5">@Html.T("الجمعة", "Friday")</option>
                                            <option value="6">@Html.T("السبت", "Saturday")</option>
                                        </select>
                                        <span asp-validation-for="DayOfWeek" class="text-danger"></span>
                                    </div>

                                    <!-- Monthly -->
                                    <div id="monthlyDiv" class="drip-option" style="display: none;">
                                        <div class="alert alert-info mb-3">
                                            <i class="feather-info me-2"></i>
                                            @Html.T("سيكون المحتوى متاحاً في اليوم الأول من كل شهر في الساعة المحددة أدناه", "Content will be available on the first day of each month at the time set below")
                                        </div>
                                        <div class="alert alert-light mb-0">
                                            <i class="feather-calendar me-2"></i>
                                            <small>@Html.T("سيتم إطلاق المحتوى في اليوم الأول من كل شهر. استخدم خيار \"ساعة الإطلاق\" أدناه لتحديد الوقت المناسب.", "Content will be released on the first day of each month. Use the \"Release hour\" option below to set the time.")</small>
                                        </div>
                                    </div>

                                    <!-- Release Hour (for Weekly and Monthly) -->
                                    <div id="releaseHourDiv" class="mt-3" style="display: none;">
                                        <label class="form-label">@Html.T("ساعة الإطلاق", "Release hour")</label>
                                        <select asp-for="ReleaseHour" class="form-select">
                                            <option value="">-- @Html.T("اختر الساعة", "Select hour") --</option>
                                            @for (int i = 0; i < 24; i++)
                                            {
                                                <option value="@i">@i:00</option>
                                            }
                                        </select>
                                        <span asp-validation-for="ReleaseHour" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <label class="form-label">@Html.T("المنطقة الزمنية", "Time zone")</label>
                                <select asp-for="TimeZone" class="form-select">
                                    <option value="Africa/Cairo">القاهرة (GMT+2)</option>
                                    <option value="Asia/Riyadh">الرياض (GMT+3)</option>
                                    <option value="Asia/Dubai">دبي (GMT+4)</option>
                                    <option value="UTC">التوقيت العالمي (UTC)</option>
                                </select>
                                <span asp-validation-for="TimeZone" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Notification Settings -->
                <div class="card stretch stretch-full mb-4">
                    <div class="card-header">
                        <h5 class="card-title">
                            <i class="feather-bell me-2 text-primary"></i>
                            إعدادات الإشعارات
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row g-4">
                            <div class="col-md-12">
                                <div class="form-check form-switch">
                                    <input asp-for="SendNotification" class="form-check-input" type="checkbox" id="sendNotification">
                                    <label class="form-check-label" for="sendNotification">
                                        إرسال إشعار للطلاب عند إطلاق المحتوى
                                    </label>
                                </div>
                            </div>

                            <div id="notificationDetails" style="display: @(Model.SendNotification ? "block" : "none");">
                                <div class="row g-4">
                                    <div class="col-md-12">
                                        <label class="form-label">@Html.T("عنوان الإشعار", "Notification title")</label>
                                        <input asp-for="NotificationTitle" class="form-control" placeholder="@Html.T("مثال: محتوى جديد متاح الآن!", "e.g. New content available now!")">
                                        <span asp-validation-for="NotificationTitle" class="text-danger"></span>
                                    </div>

                                    <div class="col-md-12">
                                        <label class="form-label">@Html.T("رسالة الإشعار", "Notification message")</label>
                                        <textarea asp-for="NotificationMessage" class="form-control" rows="3" 
                                                  placeholder="@Html.T("أضف رسالة مخصصة للإشعار...", "Add a custom message for the notification...")"></textarea>
                                        <span asp-validation-for="NotificationMessage" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4">
                <!-- Current Status -->
                <div class="card stretch stretch-full mb-4">
                    <div class="card-header">
                        <h5 class="card-title">@Html.T("الحالة الحالية", "Current status")</h5>
                    </div>
                    <div class="card-body text-center">
                        <div class="avatar-text avatar-xl @(Model.IsActive ? "bg-soft-success text-success" : "bg-soft-secondary text-secondary") mb-3 mx-auto">
                            <i class="feather-@(Model.IsActive ? "check-circle" : "pause-circle")"></i>
                        </div>
                        <h5 class="fw-bold mb-2">@(Model.IsActive ? "نشطة" : "غير نشطة")</h5>
                    </div>
                </div>

                <!-- Activation -->
                <div class="card stretch stretch-full mb-4">
                    <div class="card-header">
                        <h5 class="card-title">@Html.T("التفعيل", "Activation")</h5>
                    </div>
                    <div class="card-body">
                        <div class="form-check form-switch">
                            <input asp-for="IsActive" class="form-check-input" type="checkbox" id="isActive">
                            <label class="form-check-label" for="isActive">
                                القاعدة نشطة
                            </label>
                        </div>
                        <small class="text-muted">
                            @if (Model.IsActive)
                            {
                                <text>القاعدة تعمل حالياً وتطبق على المحتوى</text>
                            }
                            else
                            {
                                <text>القاعدة معطلة ولا تطبق حالياً</text>
                            }
                        </small>
                    </div>
                </div>

                <!-- Preview -->
                <div class="card stretch stretch-full mb-4 bg-soft-primary">
                    <div class="card-header bg-primary text-white">
                        <h6 class="card-title mb-0 text-white">
                            <i class="feather-eye me-2"></i>
                            معاينة التغييرات
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <small class="text-muted">نوع الجدولة:</small>
                            <p class="fw-bold mb-0" id="previewType">--</p>
                        </div>
                        <div class="mb-3">
                            <small class="text-muted">الإعدادات:</small>
                            <p class="mb-0" id="previewSettings">--</p>
                        </div>
                        <div>
                            <small class="text-muted">الإشعارات:</small>
                            <p class="mb-0" id="previewNotifications">@(Model.SendNotification ? "مفعّلة" : "معطلة")</p>
                        </div>
                    </div>
                </div>

                <!-- Warning -->
                <div class="card stretch stretch-full mb-4 border-warning">
                    <div class="card-body">
                        <div class="alert alert-warning mb-0">
                            <i class="feather-alert-triangle me-2"></i>
                            <small><strong>تنبيه:</strong> التغييرات ستطبق على جميع الطلاب المسجلين في الدورة.</small>
                        </div>
                    </div>
                </div>

                <!-- Info -->
                <div class="card stretch stretch-full mb-4 bg-soft-info">
                    <div class="card-body">
                        <h6 class="fw-bold mb-3">
                            <i class="feather-info me-2"></i>
                            ملاحظة مهمة
                        </h6>
                        <small class="text-muted">
                            تأكد من مراجعة الإعدادات بعناية قبل الحفظ. التغييرات ستؤثر على تجربة الطلاب الحاليين والجدد.
                        </small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Form Actions -->
        <div class="row">
            <div class="col-lg-12">
                <div class="card stretch stretch-full">
                    <div class="card-body">
                        <div class="d-flex align-items-center justify-content-between gap-3">
                            <a href="@Url.Action("Details", new { id = Model.Id })" class="btn btn-light">
                                <i class="feather-x me-2"></i>
                                إلغاء
                            </a>
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="feather-check me-2"></i>
                                حفظ التعديلات
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Auto-load modules and lessons for Edit form
            var courseId = @Model.CourseId;
            var savedModuleId = @(Model.ModuleId.HasValue ? Model.ModuleId.Value.ToString() : "null");
            var savedLessonId = @(Model.LessonId.HasValue ? Model.LessonId.Value.ToString() : "null");

            if (savedModuleId !== null) {
                $.get('@Url.Action("GetModules")/' + courseId, function(data) {
                    let options = '<option value="">-- اختر الوحدة --</option>';
                    data.forEach(function(module) {
                        options += '<option value="' + module.id + '">' + module.title + '</option>';
                    });
                    $('#moduleSelect').html(options);
                    $('#moduleSelect').val(savedModuleId);

                    if (savedLessonId !== null) {
                        $.get('@Url.Action("GetLessons")/' + savedModuleId, function(lessonData) {
                            let lessonOptions = '<option value="">-- اختر الدرس --</option>';
                            lessonData.forEach(function(lesson) {
                                lessonOptions += '<option value="' + lesson.id + '">' + lesson.title + '</option>';
                            });
                            $('#lessonSelect').html(lessonOptions);
                            $('#lessonSelect').val(savedLessonId);
                        });
                    }
                });
            }

            // Show correct fields on page load based on selected type (same as Create)
            updateDripSettings($('#dripTypeSelect').val());
            updatePreview();

            // Module selection handler
            $('#moduleSelect').on('change', function() {
                const moduleId = $(this).val();
                if (moduleId) {
                    loadLessons(moduleId);
                } else {
                    $('#lessonSelect').html('<option value="">-- اختر الدرس --</option>');
                }
            });

            // Apply course wide checkbox
            $('#applyCourseWide').on('change', function() {
                $('#specificContentDiv').toggle(!this.checked);
                if (this.checked) {
                    $('#moduleSelect, #lessonSelect').val('');
                }
            });

            // Drip type selection handler
            $('#dripTypeSelect').on('change', function() {
                const type = $(this).val();
                updateDripSettings(type);
                updatePreview();
            });

            // Notification toggle
            $('#sendNotification').on('change', function() {
                $('#notificationDetails').toggle(this.checked);
                updatePreview();
            });

            // Update preview on all changes
            $('#dripRuleForm input, #dripRuleForm select, #dripRuleForm textarea').on('change input', updatePreview);

            // Form validation (same logic as Create - use parseDripTypeValue)
            $('#dripRuleForm').on('submit', function(e) {
                const dripType = $('#dripTypeSelect').val();
                if (!dripType) {
                    e.preventDefault();
                    alert('يرجى اختيار نوع الجدولة');
                    return false;
                }

                var typeNum = parseDripTypeValue(dripType);
                var isValid = true;

                if (typeNum === @((int)LMS.Domain.Enums.ContentDripType.DaysAfterEnrollment)) {
                    var days = $('[name="DaysAfterEnrollment"]').val();
                    if (days !== '0' && (!days || days === '')) {
                        alert('يجب تحديد عدد الأيام بعد التسجيل');
                        isValid = false;
                    }
                }
                if (typeNum === @((int)LMS.Domain.Enums.ContentDripType.SpecificDate)) {
                    var date = $('[name="SpecificDate"]').val();
                    if (!date || date === '') {
                        alert('يجب تحديد التاريخ المحدد');
                        isValid = false;
                    }
                }
                if (typeNum === @((int)LMS.Domain.Enums.ContentDripType.Weekly)) {
                    var dayOfWeek = $('[name="DayOfWeek"]').val();
                    if (dayOfWeek !== 0 && dayOfWeek !== '0' && (!dayOfWeek || dayOfWeek === '')) {
                        alert('يجب تحديد يوم الأسبوع');
                        isValid = false;
                    }
                }

                if (!isValid) {
                    e.preventDefault();
                    return false;
                }

                // Confirmation for active rules
                var isActive = @(Model.IsActive ? "true" : "false");
                if (isActive) {
                    if (!confirm('هذه القاعدة نشطة وقد تؤثر على الطلاب المسجلين. هل تريد حفظ التغييرات؟')) {
                        e.preventDefault();
                        return false;
                    }
                }

                return confirm('هل أنت متأكد من حفظ التعديلات؟');
            });
        });

        function parseDripTypeValue(type) {
            if (type === undefined || type === null || type === '') return NaN;
            var num = parseInt(type, 10);
            if (!isNaN(num)) return num;
            var s = String(type);
            if (s === 'AllAtOnce' || s === 'Immediate') return @((int)LMS.Domain.Enums.ContentDripType.AllAtOnce);
            if (s === 'DaysAfterEnrollment' || s === 'ByDays') return @((int)LMS.Domain.Enums.ContentDripType.DaysAfterEnrollment);
            if (s === 'SpecificDate' || s === 'ByDate') return @((int)LMS.Domain.Enums.ContentDripType.SpecificDate);
            if (s === 'Weekly') return @((int)LMS.Domain.Enums.ContentDripType.Weekly);
            if (s === 'Monthly') return @((int)LMS.Domain.Enums.ContentDripType.Monthly);
            return NaN;
        }

        function loadLessons(moduleId) {
            $.get('@Url.Action("GetLessons")/' + moduleId, function(data) {
                let options = '<option value="">-- اختر الدرس --</option>';
                data.forEach(lesson => {
                    options += `<option value="${lesson.id}">${lesson.title}</option>`;
                });
                $('#lessonSelect').html(options);
            });
        }

        function updateDripSettings(type) {
            $('.drip-option').hide();
            $('#dripSettings').hide();
            $('#releaseHourDiv').hide();

            var typeNum = parseDripTypeValue(type);
            if (isNaN(typeNum)) return;

            $('#dripSettings').show();

            switch(typeNum) {
                case @((int)LMS.Domain.Enums.ContentDripType.AllAtOnce):
                    break;
                case @((int)LMS.Domain.Enums.ContentDripType.DaysAfterEnrollment):
                    $('#daysAfterDiv').show();
                    break;
                case @((int)LMS.Domain.Enums.ContentDripType.SpecificDate):
                    $('#specificDateDiv').show();
                    break;
                case @((int)LMS.Domain.Enums.ContentDripType.Weekly):
                    $('#weeklyDiv').show();
                    $('#releaseHourDiv').show();
                    break;
                case @((int)LMS.Domain.Enums.ContentDripType.Monthly):
                    $('#monthlyDiv').show();
                    $('#releaseHourDiv').show();
                    break;
            }
        }

        function updatePreview() {
            const typeNum = parseDripTypeValue($('#dripTypeSelect').val());
            let typeName = '--';
            let settings = '--';

            switch(typeNum) {
                case @((int)LMS.Domain.Enums.ContentDripType.AllAtOnce):
                    typeName = '@Html.T("كل المحتوى فوراً", "All content at once")';
                    settings = '@Html.T("المحتوى متاح فوراً عند التسجيل", "Content available immediately on enrollment")';
                    break;
                case @((int)LMS.Domain.Enums.ContentDripType.DaysAfterEnrollment):
                    typeName = '@Html.T("بعد أيام من التسجيل", "Days after enrollment")';
                    const days = $('[name="DaysAfterEnrollment"]').val() || '0';
                    settings = '@Html.T("متاح بعد", "Available after")' + ' ' + days + ' @Html.T("يوم من التسجيل", "days from enrollment")';
                    break;
                case @((int)LMS.Domain.Enums.ContentDripType.SpecificDate):
                    typeName = '@Html.T("تاريخ محدد", "Specific date")';
                    const date = $('[name="SpecificDate"]').val();
                    if (date && !isNaN(new Date(date).getTime())) {
                        settings = '@Html.T("يُطلق في:", "Releases at:")' + ' ' + new Date(date).toLocaleString('ar-SA');
                    } else {
                        settings = '@Html.T("لم يُحدد التاريخ بعد", "Date not set yet")';
                    }
                    break;
                case @((int)LMS.Domain.Enums.ContentDripType.Weekly):
                    typeName = '@Html.T("أسبوعياً", "Weekly")';
                    var selectedDay = $('[name="DayOfWeek"]').val();
                    var dayNames = ['@Html.T("الأحد", "Sunday")', '@Html.T("الإثنين", "Monday")', '@Html.T("الثلاثاء", "Tuesday")', '@Html.T("الأربعاء", "Wednesday")', '@Html.T("الخميس", "Thursday")', '@Html.T("الجمعة", "Friday")', '@Html.T("السبت", "Saturday")'];
                    settings = (selectedDay !== null && selectedDay !== '') ? '@Html.T("يُطلق كل", "Releases every")' + ' ' + dayNames[parseInt(selectedDay)] : '@Html.T("يُطلق كل أسبوع", "Releases every week")';
                    break;
                case @((int)LMS.Domain.Enums.ContentDripType.Monthly):
                    typeName = '@Html.T("شهرياً", "Monthly")';
                    settings = '@Html.T("يُطلق كل شهر", "Releases every month")';
                    break;
            }

            $('#previewType').text(typeName || '--');
            $('#previewSettings').text(settings || '--');

            const notificationsEnabled = $('#sendNotification').is(':checked');
            $('#previewNotifications').text(notificationsEnabled ? '@Html.T("مفعّلة", "Enabled")' : '@Html.T("معطلة", "Disabled")');
        }
    </script>

    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}

