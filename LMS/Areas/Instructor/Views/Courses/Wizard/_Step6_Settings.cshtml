@model LMS.Areas.Instructor.ViewModels.CourseWizardViewModel

<div class="step-6-settings">
    <!-- Student Features -->
    <div class="form-section">
        <h5 class="form-section-title">
            <i class="feather-users"></i>
            ميزات الطلاب
        </h5>
        <p class="text-muted mb-4">تحكم في الميزات المتاحة للطلاب المسجلين في الدورة</p>

        <div class="row g-4">
            <!-- Certificate -->
            <div class="col-md-6">
                <div class="card border h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-start justify-content-between">
                            <div class="d-flex align-items-center">
                                <div class="avatar-text avatar-md bg-soft-success text-success me-3">
                                    <i class="feather-award"></i>
                                </div>
                                <div>
                                    <h6 class="fw-bold mb-1">شهادة الإكمال</h6>
                                    <p class="text-muted fs-12 mb-0">منح الطالب شهادة عند إكمال الدورة</p>
                                </div>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="HasCertificate" 
                                       asp-for="HasCertificate" style="width: 3rem; height: 1.5rem;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Discussions -->
            <div class="col-md-6">
                <div class="card border h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-start justify-content-between">
                            <div class="d-flex align-items-center">
                                <div class="avatar-text avatar-md bg-soft-primary text-primary me-3">
                                    <i class="feather-message-circle"></i>
                                </div>
                                <div>
                                    <h6 class="fw-bold mb-1">المناقشات</h6>
                                    <p class="text-muted fs-12 mb-0">تفعيل قسم الأسئلة والمناقشات</p>
                                </div>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="AllowDiscussions" 
                                       asp-for="AllowDiscussions" style="width: 3rem; height: 1.5rem;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reviews -->
            <div class="col-md-6">
                <div class="card border h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-start justify-content-between">
                            <div class="d-flex align-items-center">
                                <div class="avatar-text avatar-md bg-soft-warning text-warning me-3">
                                    <i class="feather-star"></i>
                                </div>
                                <div>
                                    <h6 class="fw-bold mb-1">التقييمات</h6>
                                    <p class="text-muted fs-12 mb-0">السماح للطلاب بتقييم الدورة</p>
                                </div>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="AllowReviews" 
                                       asp-for="AllowReviews" style="width: 3rem; height: 1.5rem;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content Drip -->
            <div class="col-md-6">
                <div class="card border h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-start justify-content-between">
                            <div class="d-flex align-items-center">
                                <div class="avatar-text avatar-md bg-soft-info text-info me-3">
                                    <i class="feather-clock"></i>
                                </div>
                                <div>
                                    <h6 class="fw-bold mb-1">جدولة المحتوى</h6>
                                    <p class="text-muted fs-12 mb-0">إتاحة المحتوى تدريجياً للطلاب</p>
                                </div>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="EnableContentDrip" 
                                       asp-for="EnableContentDrip" style="width: 3rem; height: 1.5rem;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Video Protection -->
    <div class="form-section">
        <h5 class="form-section-title">
            <i class="feather-shield"></i>
            حماية المحتوى
        </h5>
        <p class="text-muted mb-4">إعدادات حماية الفيديوهات من النسخ غير المصرح به</p>

        <div class="row g-4">
            <!-- Watermark -->
            <div class="col-md-6">
                <div class="card border h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-start justify-content-between">
                            <div class="d-flex align-items-center">
                                <div class="avatar-text avatar-md bg-soft-secondary text-secondary me-3">
                                    <i class="feather-droplet"></i>
                                </div>
                                <div>
                                    <h6 class="fw-bold mb-1">العلامة المائية</h6>
                                    <p class="text-muted fs-12 mb-0">إضافة علامة مائية على الفيديوهات</p>
                                </div>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="EnableWatermark" 
                                       asp-for="EnableWatermark" style="width: 3rem; height: 1.5rem;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Prevent Download -->
            <div class="col-md-6">
                <div class="card border h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-start justify-content-between">
                            <div class="d-flex align-items-center">
                                <div class="avatar-text avatar-md bg-soft-danger text-danger me-3">
                                    <i class="feather-download-cloud"></i>
                                </div>
                                <div>
                                    <h6 class="fw-bold mb-1">منع التحميل</h6>
                                    <p class="text-muted fs-12 mb-0">منع تحميل الفيديوهات</p>
                                </div>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="PreventDownload" 
                                       asp-for="PreventDownload" style="width: 3rem; height: 1.5rem;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SEO Settings -->
    <div class="form-section">
        <h5 class="form-section-title">
            <i class="feather-search"></i>
            تحسين محركات البحث (SEO)
        </h5>
        <p class="text-muted mb-4">تحسين ظهور الدورة في نتائج البحث</p>

        <div class="row g-4">
            <!-- Meta Title -->
            <div class="col-12">
                <label class="form-label fw-bold">
                    <i class="feather-type me-1"></i>
                    عنوان SEO
                </label>
                <input asp-for="MetaTitle" 
                       type="text" 
                       class="form-control" 
                       maxlength="200"
                       placeholder="عنوان يظهر في نتائج البحث (اتركه فارغاً لاستخدام عنوان الدورة)">
                <div class="d-flex justify-content-between mt-1">
                    <small class="text-muted">يُفضل 50-60 حرف</small>
                    <small class="character-count"><span id="metaTitleCount">0</span>/200</small>
                </div>
            </div>

            <!-- Meta Description -->
            <div class="col-12">
                <label class="form-label fw-bold">
                    <i class="feather-align-left me-1"></i>
                    وصف SEO
                </label>
                <textarea asp-for="MetaDescription" 
                          class="form-control" 
                          rows="3"
                          maxlength="500"
                          placeholder="وصف يظهر في نتائج البحث (اتركه فارغاً لاستخدام الوصف المختصر)"></textarea>
                <div class="d-flex justify-content-between mt-1">
                    <small class="text-muted">يُفضل 150-160 حرف</small>
                    <small class="character-count"><span id="metaDescCount">0</span>/500</small>
                </div>
            </div>

            <!-- Meta Keywords -->
            <div class="col-12">
                <label class="form-label fw-bold">
                    <i class="feather-tag me-1"></i>
                    الكلمات المفتاحية
                </label>
                <input asp-for="MetaKeywords" 
                       type="text" 
                       class="form-control" 
                       maxlength="500"
                       placeholder="برمجة, بايثون, تعلم البرمجة (مفصولة بفواصل)">
                <small class="text-muted">أضف كلمات مفتاحية مفصولة بفواصل</small>
            </div>
        </div>
    </div>

    <!-- SEO Preview -->
    <div class="form-section">
        <h5 class="form-section-title">
            <i class="feather-eye"></i>
            معاينة نتائج البحث
        </h5>

        <div class="seo-preview card border bg-light">
            <div class="card-body">
                <div class="google-preview">
                    <div class="preview-url text-success fs-12 mb-1">
                        <i class="feather-globe me-1"></i>
                        www.example.com › courses › <span id="previewSlug">your-course</span>
                    </div>
                    <div class="preview-title text-primary fs-5 fw-bold mb-1" id="previewTitle">
                        @(string.IsNullOrEmpty(Model.MetaTitle) ? Model.Title : Model.MetaTitle)
                    </div>
                    <div class="preview-description text-muted fs-12" id="previewDescription">
                        @(string.IsNullOrEmpty(Model.MetaDescription) ? Model.ShortDescription : Model.MetaDescription)
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .form-check-input:checked {
        background-color: #004aad;
        border-color: #004aad;
    }

    .card {
        border-radius: 12px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .card:hover {
        box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }

    .seo-preview {
        border-radius: 12px;
    }

    .google-preview {
        font-family: arial, sans-serif;
    }

    .preview-title:hover {
        text-decoration: underline;
        cursor: pointer;
    }

    .avatar-text {
        border-radius: 12px;
    }

    .character-count {
        font-size: 0.75rem;
        color: #9ca3af;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Character counters
        const metaTitle = document.getElementById('MetaTitle');
        const metaDesc = document.getElementById('MetaDescription');
        const metaTitleCount = document.getElementById('metaTitleCount');
        const metaDescCount = document.getElementById('metaDescCount');

        if (metaTitle && metaTitleCount) {
            metaTitleCount.textContent = metaTitle.value.length;
            metaTitle.addEventListener('input', function() {
                metaTitleCount.textContent = this.value.length;
                updatePreview();
            });
        }

        if (metaDesc && metaDescCount) {
            metaDescCount.textContent = metaDesc.value.length;
            metaDesc.addEventListener('input', function() {
                metaDescCount.textContent = this.value.length;
                updatePreview();
            });
        }

        // Update preview
        function updatePreview() {
            const title = document.getElementById('MetaTitle').value;
            const desc = document.getElementById('MetaDescription').value;

            document.getElementById('previewTitle').textContent = title || '@Model.Title';
            document.getElementById('previewDescription').textContent = desc || '@Model.ShortDescription';
        }
    });
</script>

