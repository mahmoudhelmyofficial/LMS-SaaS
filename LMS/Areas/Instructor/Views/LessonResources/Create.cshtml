@model LMS.Areas.Instructor.ViewModels.LessonResourceCreateViewModel

@{
    ViewData["Title"] = Html.T("إضافة مرفق للدرس", "Add Lesson Resource");
    var lesson = ViewBag.Lesson as LMS.Domain.Entities.Courses.Lesson;
}

<div class="page-header">
    <div class="page-header-left d-flex align-items-center">
        <div class="page-header-title">
            <h5 class="m-b-10">@ViewData["Title"]</h5>
        </div>
    </div>
    <div class="page-header-right ms-auto">
        <div class="d-flex gap-2">
            <a asp-controller="Lessons" asp-action="Edit" asp-route-id="@Model.LessonId" class="btn btn-light">
                <i class="feather-arrow-right me-2"></i>
                @Html.T("العودة للدرس", "Back to lesson")
            </a>
        </div>
    </div>
</div>

<div class="main-content">
    @await Html.PartialAsync("_AlertMessages")

    <div class="row">
        <div class="col-lg-8 mx-auto">
            <div class="card stretch stretch-full">
                <div class="card-header">
                    <h5 class="card-title">@Html.T("إضافة مرفق جديد", "Add new attachment")</h5>
                    <p class="text-muted mb-0">@Html.T("للدرس:", "For lesson:") @lesson?.Title</p>
                </div>
                <div class="card-body">
                    <form asp-action="Create" method="post">
                        @Html.AntiForgeryToken()
                        @Html.HiddenFor(m => m.LessonId)

                        <div asp-validation-summary="ModelOnly" class="alert alert-danger"></div>

                        <div class="mb-4">
                            <label asp-for="Title" class="form-label required">@Html.T("عنوان المرفق", "Attachment title")</label>
                            <input asp-for="Title" class="form-control" placeholder="@Html.T("مثل: ملف PDF للشرح", "e.g. PDF file for explanation")" required />
                            <span asp-validation-for="Title" class="text-danger"></span>
                        </div>

                        <div class="mb-4">
                            <label asp-for="Description" class="form-label">@Html.T("الوصف", "Description")</label>
                            <textarea asp-for="Description" class="form-control" rows="3" placeholder="@Html.T("وصف المرفق...", "Attachment description...")"></textarea>
                            <span asp-validation-for="Description" class="text-danger"></span>
                        </div>

                        <div class="mb-4">
                            @await Html.PartialAsync("_MediaPicker", new ViewDataDictionary(ViewData) {
                                { "FieldName", "FileUrl" },
                                { "FieldId", "fileUrl" },
                                { "Label", Html.T("ملف المرفق", "Attachment file") },
                                { "MediaType", "All" },
                                { "CurrentValue", "" },
                                { "Required", true },
                                { "HelpText", Html.T("اختر ملفاً من المكتبة أو ارفع ملفاً جديداً", "Choose a file from library or upload a new file") },
                                { "AspectRatio", "1/1" }
                            })
                        </div>

                        <div class="row mb-4">
                            <div class="col-md-6">
                                <label asp-for="FileType" class="form-label">@Html.T("نوع الملف", "File type")</label>
                                <select asp-for="FileType" class="form-select">
                                    <option value="">@Html.T("-- اختر --", "-- Select --")</option>
                                    <option value="PDF">PDF</option>
                                    <option value="Word">Word</option>
                                    <option value="Excel">Excel</option>
                                    <option value="PowerPoint">PowerPoint</option>
                                    <option value="Video">@Html.T("فيديو", "Video")</option>
                                    <option value="Audio">@Html.T("صوت", "Audio")</option>
                                    <option value="Archive">@Html.T("أرشيف", "Archive")</option>
                                    <option value="Other">@Html.T("أخرى", "Other")</option>
                                </select>
                                <span asp-validation-for="FileType" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="FileSize" class="form-label">@Html.T("حجم الملف (بايت)", "File size (bytes)")</label>
                                <input asp-for="FileSize" type="number" class="form-control" min="0" placeholder="0" />
                                <span asp-validation-for="FileSize" class="text-danger"></span>
                            </div>
                        </div>

                        <div class="mb-4">
                            <div class="form-check form-switch">
                                <input asp-for="IsDownloadable" class="form-check-input" type="checkbox" checked />
                                <label asp-for="IsDownloadable" class="form-check-label">
                                    @Html.T("السماح بتحميل المرفق", "Allow attachment download")
                                </label>
                            </div>
                        </div>

                        <div class="d-flex gap-2 justify-content-end">
                            <a href="@Url.Action("Edit", "Lessons", new { id = Model.LessonId })" class="btn btn-light">
                                <i class="feather-x me-2"></i>
                                @Html.T("إلغاء", "Cancel")
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="feather-check me-2"></i>
                                @Html.T("إضافة المرفق", "Add attachment")
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}

