@model LMS.Areas.Instructor.ViewModels.FlashSaleEditViewModel

@{
    ViewData["Title"] = Html.T("تعديل العرض السريع", "Edit Flash Sale");
    ViewData["Subtitle"] = Html.T("تحديث معلومات وإعدادات العرض السريع", "Update flash sale details and settings");
    var detailsUrl = Url.Action("Details", new { id = Model.Id });
}

@await Html.PartialAsync("_PageHeader", new ViewDataDictionary(ViewData)
{
    { "ActionButtons", Html.Raw($@"
        <a href='{detailsUrl}' class='btn btn-light'>
            <i class='feather-arrow-right me-2'></i>
            العودة
        </a>
    ") }
})

<div class="main-content">
    @await Html.PartialAsync("_AlertMessages")

    <div class="row">
        <div class="col-lg-8 mx-auto">
            <div class="card stretch stretch-full">
                <div class="card-header">
                    <h5 class="card-title">@Html.T("تعديل العرض السريع", "Edit flash sale")</h5>
                </div>
                <div class="card-body">
                    <form asp-action="Edit" asp-route-id="@Model.Id" method="post">
                        @Html.AntiForgeryToken()
                        @Html.HiddenFor(m => m.Id)
                        @Html.HiddenFor(m => m.CourseId)
                        @Html.HiddenFor(m => m.SoldQuantity)

                        <div asp-validation-summary="ModelOnly" class="alert alert-danger"></div>

                        <!-- Sales Info (Read-only) -->
                        <div class="alert alert-info mb-4">
                            <i class="feather-shopping-cart me-2"></i>
                            <strong>تم بيع @Model.SoldQuantity وحدة من هذا العرض</strong>
                        </div>

                        <!-- Name & Description -->
                        <div class="mb-4">
                            <label asp-for="Name" class="form-label required">اسم العرض</label>
                            <input asp-for="Name" class="form-control" required />
                            <span asp-validation-for="Name" class="text-danger"></span>
                        </div>

                        <div class="mb-4">
                            <label asp-for="Description" class="form-label">الوصف</label>
                            <textarea asp-for="Description" class="form-control" rows="3"></textarea>
                            <span asp-validation-for="Description" class="text-danger"></span>
                        </div>

                        <!-- Pricing -->
                        <div class="mb-4">
                            <label asp-for="DiscountPrice" class="form-label required">سعر العرض</label>
                            <div class="input-group">
                                <input asp-for="DiscountPrice" type="number" class="form-control" min="0" step="0.01" required />
                                <span class="input-group-text">ج.م</span>
                            </div>
                            <span asp-validation-for="DiscountPrice" class="text-danger"></span>
                        </div>

                        <!-- Duration -->
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <label asp-for="StartDate" class="form-label required">تاريخ البدء</label>
                                <input asp-for="StartDate" type="datetime-local" class="form-control" required />
                                <span asp-validation-for="StartDate" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="EndDate" class="form-label required">تاريخ الانتهاء</label>
                                <input asp-for="EndDate" type="datetime-local" class="form-control" required />
                                <span asp-validation-for="EndDate" class="text-danger"></span>
                            </div>
                        </div>

                        <!-- Max Quantity & Priority -->
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <label asp-for="MaxQuantity" class="form-label">الحد الأقصى للمبيعات</label>
                                <input asp-for="MaxQuantity" type="number" class="form-control" min="@Model.SoldQuantity" />
                                <div class="form-text">لا يمكن أن يكون أقل من @Model.SoldQuantity (المبيعات الحالية)</div>
                                <span asp-validation-for="MaxQuantity" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="Priority" class="form-label">الأولوية</label>
                                <input asp-for="Priority" type="number" class="form-control" min="0" />
                                <span asp-validation-for="Priority" class="text-danger"></span>
                            </div>
                        </div>

                        <!-- Settings -->
                        <div class="card border mb-4">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">@Html.T("الإعدادات", "Settings")</h6>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="form-check form-switch">
                                            <input asp-for="IsActive" class="form-check-input" type="checkbox" />
                                            <label asp-for="IsActive" class="form-check-label">
                                                <strong>تفعيل العرض</strong>
                                                <span class="d-block text-muted fs-11">تفعيل/تعطيل العرض</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check form-switch">
                                            <input asp-for="ShowTimer" class="form-check-input" type="checkbox" />
                                            <label asp-for="ShowTimer" class="form-check-label">
                                                <strong>عرض المؤقت</strong>
                                                <span class="d-block text-muted fs-11">عرض عد تنازلي</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="d-flex gap-2 justify-content-end">
                            <a href="@Url.Action("Details", new { id = Model.Id })" class="btn btn-light">
                                <i class="feather-x me-2"></i>
                                إلغاء
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="feather-check me-2"></i>
                                حفظ التعديلات
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}

