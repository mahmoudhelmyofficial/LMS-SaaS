@*
    Shared TinyMCE Scripts Partial
    This partial provides TinyMCE editor functionality using a self-hosted CDN (no API key required)
    
    Usage:
    1. Include this partial in your Scripts section: @await Html.PartialAsync("_TinyMCEScripts")
    2. Add a TinyMCE configuration after the partial:
       <script>
           initTinyMCE('#yourEditorId', { height: 400 });
       </script>
*@

<!-- TinyMCE from cdnjs - No API key required -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/6.8.2/tinymce.min.js" integrity="sha512-6JR4bbn8N4Z+qV/GJKuo+KgRWkRpD1FYe7LqWbmhxLHo3wQxYtnGnLBXWoniToRg3J3A7IvlvfQGBi79GGAZYQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
    /**
     * Initialize TinyMCE editor with RTL support
     * @@param {string} selector - CSS selector for the textarea
     * @@param {object} options - Optional configuration overrides
     */
    function initTinyMCE(selector, options = {}) {
        const defaultConfig = {
            selector: selector,
            height: options.height || 400,
            menubar: options.menubar !== undefined ? options.menubar : false,
            plugins: options.plugins || 'lists link image code table wordcount',
            toolbar: options.toolbar || 'undo redo | formatselect | bold italic underline | alignleft aligncenter alignright | bullist numlist | link image | code | removeformat',
            directionality: 'rtl',
            language: 'ar',
            content_style: 'body { font-family: Cairo, Arial, sans-serif; font-size: 14px; direction: rtl; text-align: right; }',
            promotion: false, // Disable upgrade promotion
            branding: false, // Disable "Powered by TinyMCE" branding
            setup: function (editor) {
                editor.on('change', function () {
                    editor.save(); // Sync content with textarea
                });
            },
            // Merge any additional options
            ...options
        };

        return tinymce.init(defaultConfig);
    }

    /**
     * Get TinyMCE editor content
     * @@param {string} editorId - The ID of the editor (without #)
     * @@returns {string} - The editor content
     */
    function getTinyMCEContent(editorId) {
        const editor = tinymce.get(editorId);
        return editor ? editor.getContent() : '';
    }

    /**
     * Set TinyMCE editor content
     * @@param {string} editorId - The ID of the editor (without #)
     * @@param {string} content - The content to set
     */
    function setTinyMCEContent(editorId, content) {
        const editor = tinymce.get(editorId);
        if (editor) {
            editor.setContent(content);
        }
    }

    /**
     * Get plain text content from TinyMCE editor
     * @@param {string} editorId - The ID of the editor (without #)
     * @@returns {string} - The plain text content
     */
    function getTinyMCETextContent(editorId) {
        const editor = tinymce.get(editorId);
        return editor ? editor.getContent({ format: 'text' }) : '';
    }
</script>

