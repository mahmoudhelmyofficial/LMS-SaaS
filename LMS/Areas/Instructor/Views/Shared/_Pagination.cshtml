@model dynamic

@{
    // Support both ViewData and ViewBag for flexibility
    var currentPage = ViewData["CurrentPage"] != null ? Convert.ToInt32(ViewData["CurrentPage"]) : 
                      ViewBag.CurrentPage != null ? (int)ViewBag.CurrentPage :
                      ViewBag.Page != null ? (int)ViewBag.Page : 1;
    var totalPages = ViewData["TotalPages"] != null ? Convert.ToInt32(ViewData["TotalPages"]) : 
                     ViewBag.TotalPages != null ? (int)ViewBag.TotalPages : 1;
    var totalItems = ViewData["TotalItems"] != null ? Convert.ToInt32(ViewData["TotalItems"]) : 
                     ViewBag.TotalItems != null ? (int)ViewBag.TotalItems :
                     ViewBag.TotalCount != null ? (int)ViewBag.TotalCount : 0;
    var pageSize = ViewData["PageSize"] != null ? Convert.ToInt32(ViewData["PageSize"]) : 
                   ViewBag.PageSize != null ? (int)ViewBag.PageSize : 10;
    var action = ViewData["Action"]?.ToString() ?? ViewContext.RouteData.Values["action"]?.ToString() ?? "Index";
    var controller = ViewData["Controller"]?.ToString() ?? ViewContext.RouteData.Values["controller"]?.ToString();
    var routeValues = ViewData["RouteValues"] as RouteValueDictionary ?? new RouteValueDictionary();
}

@if (totalPages > 1)
{
    <div class="card-footer d-flex align-items-center justify-content-between">
        <div class="fs-12 text-muted">
            @Html.T("عرض", "Showing") @((currentPage - 1) * pageSize + 1) @Html.T("إلى", "to") @(Math.Min(currentPage * pageSize, totalItems)) @Html.T("من أصل", "of") @totalItems
        </div>
        <ul class="list-unstyled d-flex align-items-center gap-2 mb-0 pagination-common-style">
            @if (currentPage > 1)
            {
                routeValues["page"] = currentPage - 1;
                <li>
                    <a href="@Url.Action(action, controller, routeValues)" class="page-link">
                        <i class="feather-chevron-right"></i>
                    </a>
                </li>
            }
            
            @for (int i = Math.Max(1, currentPage - 2); i <= Math.Min(totalPages, currentPage + 2); i++)
            {
                routeValues["page"] = i;
                <li class="@(i == currentPage ? "active" : "")">
                    <a href="@Url.Action(action, controller, routeValues)" class="page-link">@i</a>
                </li>
            }
            
            @if (currentPage < totalPages)
            {
                routeValues["page"] = currentPage + 1;
                <li>
                    <a href="@Url.Action(action, controller, routeValues)" class="page-link bg-primary">
                        <i class="feather-chevron-left"></i>
                    </a>
                </li>
            }
        </ul>
    </div>
}

