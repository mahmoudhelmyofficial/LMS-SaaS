@model List<LMS.Services.Interfaces.CourseRecommendation>
@using LMS.Services.Interfaces
@inject IPlatformSettingsService PlatformSettings
@{
    ViewData["Title"] = Html.T("Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©", "Next Steps");
    var completedCourseId = ViewContext.RouteData.Values["completedCourseId"];
    
    // UI settings
    var nextStepsLimit = await PlatformSettings.GetIntSettingAsync("UI.NextSteps.Limit", 3);
    var skillsPreviewLimit = await PlatformSettings.GetIntSettingAsync("UI.SkillsPreview.Limit", 3);
}

<style>
    .celebration-banner {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 48px 32px;
        border-radius: 20px;
        margin-bottom: 32px;
        text-align: center;
        position: relative;
        overflow: hidden;
    }
    
    .celebration-banner::before {
        content: 'ğŸ‰';
        position: absolute;
        font-size: 200px;
        opacity: 0.1;
        top: -50px;
        right: -50px;
        animation: float 3s ease-in-out infinite;
    }
    
    @@keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-20px); }
    }
    
    .certificate-preview {
        background: white;
        padding: 32px;
        border-radius: 16px;
        border: 3px dashed #fbbf24;
        text-align: center;
        box-shadow: 0 8px 30px rgba(251, 191, 36, 0.2);
    }
    
    .next-step-card {
        background: white;
        border-radius: 16px;
        padding: 28px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        height: 100%;
        transition: all 0.3s ease;
        border-top: 4px solid;
    }
    
    .next-step-card.recommended { border-color: #22c55e; }
    .next-step-card.advanced { border-color: #3b82f6; }
    .next-step-card.related { border-color: #fbbf24; }
    
    .next-step-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 12px 35px rgba(0,0,0,0.15);
    }
    
    .skill-gained {
        display: inline-block;
        padding: 8px 16px;
        background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
        color: #16a34a;
        border-radius: 20px;
        margin: 4px;
        font-size: 13px;
        font-weight: 600;
    }
    
    .achievement-icon {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 50px;
        margin: 0 auto 20px;
        box-shadow: 0 8px 25px rgba(251, 191, 36, 0.4);
        animation: pulse 2s ease-in-out infinite;
    }
    
    @@keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }
    
    .stats-highlight {
        background: #f9fafb;
        padding: 24px;
        border-radius: 12px;
        margin: 16px 0;
    }
    
    .recommendation-badge {
        position: absolute;
        top: -12px;
        right: 20px;
        background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
        color: white;
        padding: 6px 16px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3);
    }
    
    .social-share-btn {
        padding: 12px 24px;
        border-radius: 12px;
        border: 2px solid #e5e7eb;
        background: white;
        transition: all 0.3s ease;
        cursor: pointer;
    }
    
    .social-share-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
</style>

<!-- Celebration Banner -->
<div class="celebration-banner">
    <div class="achievement-icon">
        ğŸ†
    </div>
    <h1 class="mb-3">@Html.T("Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ø¯ÙˆØ±Ø©", "Congratulations! You completed the course")</h1>
    <p class="fs-5 mb-4 opacity-90">@Html.T("Ø£Ø­Ø³Ù†Øª! Ø­Ø§Ù† Ø§Ù„ÙˆÙ‚Øª Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ", "Well done! Time to move to the next level")</p>
    <div class="d-flex justify-content-center gap-3 flex-wrap">
        <button class="btn btn-light btn-lg" onclick="downloadCertificate()">
            <i class="feather-download me-2"></i>
            @Html.T("ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©", "Download certificate")
        </button>
        <button class="btn btn-outline-light btn-lg" onclick="shareAchievement()">
            <i class="feather-share-2 me-2"></i>
            @Html.T("Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²", "Share achievement")
        </button>
    </div>
</div>

<!-- Achievement Stats -->
@{
    var finalScore = ViewBag.FinalScore ?? 0.0;
    var studyHours = ViewBag.StudyHours ?? 0.0;
    var completedLessons = ViewBag.CompletedLessons ?? 0;
    var totalLessons = ViewBag.TotalLessons ?? 0;
    var pointsEarned = ViewBag.PointsEarned ?? 0;
    var skills = ViewBag.Skills as List<string> ?? new List<string>();
}
<div class="row g-4 mb-4">
    <div class="col-md-3">
        <div class="stats-highlight text-center">
            <i class="feather-award text-warning mb-2" style="font-size: 32px;"></i>
            <h3 class="mb-1 text-warning">@(((double)finalScore).ToString("F0"))%</h3>
            <p class="text-muted small mb-0">@Html.T("Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ", "Final grade")</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stats-highlight text-center">
            <i class="feather-clock text-primary mb-2" style="font-size: 32px;"></i>
            <h3 class="mb-1 text-primary">@(((double)studyHours).ToString("F0"))</h3>
            <p class="text-muted small mb-0">@Html.T("Ø³Ø§Ø¹Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ©", "learning hours")</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stats-highlight text-center">
            <i class="feather-check-circle text-success mb-2" style="font-size: 32px;"></i>
            <h3 class="mb-1 text-success">@completedLessons/@totalLessons</h3>
            <p class="text-muted small mb-0">@Html.T("Ø¯Ø±ÙˆØ³ Ù…ÙƒØªÙ…Ù„Ø©", "Lessons completed")</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stats-highlight text-center">
            <i class="feather-star text-info mb-2" style="font-size: 32px;"></i>
            <h3 class="mb-1 text-info">+@pointsEarned</h3>
            <p class="text-muted small mb-0">@Html.T("Ù†Ù‚Ø§Ø· Ù…ÙƒØªØ³Ø¨Ø©", "Points earned")</p>
        </div>
    </div>
</div>

<!-- Skills Gained -->
<div class="row g-4 mb-4">
    <div class="col-12">
        <div class="next-step-card" style="border-color: #22c55e;">
            <h4 class="mb-4">
                <i class="feather-check-square text-success me-2"></i>
                @Html.T("Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙŠ Ø§ÙƒØªØ³Ø¨ØªÙ‡Ø§", "Skills you gained")
            </h4>
            <div class="d-flex flex-wrap">
                @if (skills.Any())
                {
                    foreach (var skill in skills)
                    {
                        <span class="skill-gained">@skill</span>
                    }
                }
                else
                {
                    <span class="text-muted">@Html.T("Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ±Ø©", "No skills defined for this course")</span>
                }
            </div>
        </div>
    </div>
</div>

<!-- Certificate Preview -->
<div class="row g-4 mb-4">
    <div class="col-lg-6">
        <div class="certificate-preview">
            <h3 class="mb-4 text-primary">ğŸ“ @Html.T("Ø´Ù‡Ø§Ø¯Ø© Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙˆØ±Ø©", "Course completion certificate")</h3>
            <p class="text-muted mb-4">@Html.T("Ø´Ù‡Ø§Ø¯ØªÙƒ Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ©", "Your certificate is ready to download and share")</p>
            <div class="mb-4">
                <img src="/assets/images/certificate-preview.png" alt="@Html.T("Ø´Ù‡Ø§Ø¯Ø©", "Certificate")" class="img-fluid rounded" style="max-height: 300px;" onerror="this.src='/assets/images/placeholder.png'">
            </div>
            <div class="d-grid gap-2">
                <button class="btn btn-warning btn-lg">
                    <i class="feather-download me-2"></i>
                    @Html.T("ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© (PDF)", "Download certificate (PDF)")
                </button>
                <button class="btn btn-outline-warning">
                    <i class="feather-share-2 me-2"></i>
                    @Html.T("Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ Ù„ÙŠÙ†ÙƒØ¯ Ø¥Ù†", "Share on LinkedIn")
                </button>
            </div>
        </div>
    </div>
    
    <div class="col-lg-6">
        <div class="next-step-card" style="border-color: #667eea;">
            <h4 class="mb-4">
                <i class="feather-trending-up text-primary me-2"></i>
                @Html.T("ØªØ£Ø«ÙŠØ±Ùƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ", "Your learning impact")
            </h4>
            <div class="mb-4">
                <div style="height: 250px;">
                    <canvas id="progressChart"></canvas>
                </div>
            </div>
            @{
                var statsData = ViewBag.Stats as LMS.Services.Interfaces.StudentLearningStats;
                var improvementRateFromViewBag = ViewBag.ImprovementRate as int?;
                var improvementRate = improvementRateFromViewBag ?? ((statsData?.AverageGrade ?? 0) > 70 ? (int)((statsData?.AverageGrade ?? 0) - 50) : 0);
            }
            @if (improvementRate > 0)
            {
                <div class="alert alert-info" style="border-radius: 12px;">
                    <strong>@Html.T("Ø±Ø§Ø¦Ø¹!", "Great!")</strong> @Html.T("Ù„Ù‚Ø¯ ØªØ­Ø³Ù† Ø£Ø¯Ø§Ø¤Ùƒ Ø¨Ù†Ø³Ø¨Ø©", "Your performance improved by") <strong>@improvementRate%</strong> @Html.T("Ø®Ù„Ø§Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ±Ø©", "during this course")
                </div>
            }
            else
            {
                <div class="alert alert-info" style="border-radius: 12px;">
                    <strong>@Html.T("Ø§Ø³ØªÙ…Ø±!", "Keep going!")</strong> @Html.T("ØªØ§Ø¨Ø¹ Ø§Ù„ØªØ¹Ù„Ù… Ù„ØªØ­Ù‚ÙŠÙ‚ ØªØ­Ø³Ù† Ù…Ù„Ù…ÙˆØ³ ÙÙŠ Ù…Ù‡Ø§Ø±Ø§ØªÙƒ", "Continue learning to achieve tangible improvement in your skills")
                </div>
            }
        </div>
    </div>
</div>

<!-- Recommended Next Steps -->
<div class="mb-4">
    <h3 class="mb-3">
        <i class="feather-arrow-right text-primary me-2"></i>
        @Html.T("Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§", "Recommended next steps")
    </h3>
    <p class="text-muted">@Html.T("Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¥Ù†Ø¬Ø§Ø²ÙƒØŒ Ø¥Ù„ÙŠÙƒ Ø£ÙØ¶Ù„ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©", "Based on your achievement, here are the best options to continue")</p>
</div>

<div class="row g-4 mb-4">
    @if (Model != null && Model.Any())
    {
        foreach (var course in Model.Take(3))
        {
            <div class="col-lg-4">
                <div class="next-step-card @(course.Priority == 1 ? "recommended" : course.Priority == 2 ? "advanced" : "related")" style="position: relative;">
                    @if (course.Priority == 1)
                    {
                        <span class="recommendation-badge">
                            <i class="feather-star me-1"></i>
                            @Html.T("Ø§Ù„Ø£Ù†Ø³Ø¨ Ù„Ùƒ", "Best for you")
                        </span>
                    }
                    <div class="mb-3">
                        <img src="@(course.ThumbnailUrl ?? "/assets/images/course-placeholder.jpg")" alt="@course.Title" class="img-fluid rounded" style="height: 180px; width: 100%; object-fit: cover;">
                    </div>
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <span class="badge bg-primary">@course.Level</span>
                        <div class="text-end">
                            <small class="text-muted">@Html.T("ØªØ·Ø§Ø¨Ù‚", "Match")</small>
                            <div class="fw-bold text-success">@course.MatchScore%</div>
                        </div>
                    </div>
                    <h5 class="mb-2">@course.Title</h5>
                    <p class="text-muted small mb-3">@course.Description</p>
                    
                    <div class="mb-3">
                        <small class="text-muted d-block mb-2">@Html.T("Ø³ØªØªØ¹Ù„Ù…:", "You'll learn:")</small>
                        <div class="d-flex flex-wrap gap-1">
                            @foreach (var skill in course.SkillsYoullLearn.Take(skillsPreviewLimit))
                            {
                                <span class="badge bg-light text-primary">@skill</span>
                            }
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <small class="text-muted">
                            <i class="feather-clock me-1"></i>
                            @course.Duration @Html.T("Ø³Ø§Ø¹Ø©", "hr")
                        </small>
                        <small class="text-muted">
                            <i class="feather-users me-1"></i>
                            @course.EnrolledStudents @Html.T("Ø·Ø§Ù„Ø¨", "students")
                        </small>
                    </div>
                    
                    <div class="alert alert-success-subtle mb-3" style="border-radius: 10px;">
                        <small>
                            <i class="feather-info me-2"></i>
                            <strong>@Html.T("Ù„Ù…Ø§Ø°Ø§ØŸ", "Why?")</strong> @course.Reason
                        </small>
                    </div>
                    
                    <div class="d-grid gap-2">
                        <a href="@Url.Action("Details", "Courses", new { area = "", id = course.CourseId })" class="btn btn-primary">
                            <i class="feather-arrow-left me-2"></i>
                            @Html.T("Ø§Ø¨Ø¯Ø£ Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ±Ø©", "Start this course")
                        </a>
                        <button class="btn btn-outline-primary" onclick="addToWishlist(@course.CourseId)">
                            <i class="feather-bookmark me-2"></i>
                            @Html.T("Ø­ÙØ¸ Ù„Ù„Ø§Ø­Ù‚Ø§Ù‹", "Save for later")
                        </button>
                    </div>
                </div>
            </div>
        }
    }
</div>

<!-- Learning Path Continuation -->
<div class="row g-4 mb-4">
    <div class="col-12">
        <div class="next-step-card" style="border-color: #667eea;">
            <h4 class="mb-4">
                <i class="feather-map text-primary me-2"></i>
                @Html.T("Ù…Ø³Ø§Ø± Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ÙƒØ§Ù…Ù„", "Full learning path")
            </h4>
            <p class="text-muted mb-4">@Html.T("ØªØªØ¨Ø¹ ØªÙ‚Ø¯Ù…Ùƒ ÙÙŠ Ù…Ø³Ø§Ø± Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø´Ø§Ù…Ù„", "Track your progress on the full development path")</p>
            
            @{
                var stats = ViewBag.Stats as LMS.Services.Interfaces.StudentLearningStats;
                var completedCourses = stats?.CompletedCourses ?? 0;
                var basicLevelProgress = Math.Min(100, completedCourses >= 3 ? 100 : (completedCourses * 33));
                var advancedLevelProgress = Math.Max(0, completedCourses >= 3 ? Math.Min(100, (completedCourses - 3) * 25) : 0);
                var proLevelProgress = Math.Max(0, completedCourses >= 7 ? Math.Min(100, (completedCourses - 7) * 33) : 0);
            }
            <div class="row g-3">
                <div class="col-md-4">
                    <div class="p-3 bg-@(basicLevelProgress >= 100 ? "success" : "primary")-subtle rounded">
                        <div class="d-flex align-items-center mb-2">
                            <i class="feather-@(basicLevelProgress >= 100 ? "check-circle text-success" : "activity text-primary") me-2"></i>
                            <strong>@Html.T("Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1: Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª", "Level 1: Basics")</strong>
                        </div>
                        <div class="progress mb-2" style="height: 6px;">
                            <div class="progress-bar bg-@(basicLevelProgress >= 100 ? "success" : "primary")" style="width: @basicLevelProgress%"></div>
                        </div>
                        <small class="text-muted">@basicLevelProgress% @Html.T("Ù…ÙƒØªÙ…Ù„", "complete")@(basicLevelProgress >= 100 ? "" : " - " + Html.T("ØªØ§Ø¨Ø¹ Ø§Ù„Ø¢Ù†", "Continue now"))</small>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="p-3 bg-@(advancedLevelProgress >= 100 ? "success" : (advancedLevelProgress > 0 ? "warning" : "secondary"))-subtle rounded">
                        <div class="d-flex align-items-center mb-2">
                            <i class="feather-@(advancedLevelProgress >= 100 ? "check-circle text-success" : (advancedLevelProgress > 0 ? "activity text-warning" : "lock text-secondary")) me-2"></i>
                            <strong>@Html.T("Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2: Ø§Ù„Ù…ØªÙ‚Ø¯Ù…", "Level 2: Advanced")</strong>
                        </div>
                        <div class="progress mb-2" style="height: 6px;">
                            <div class="progress-bar bg-@(advancedLevelProgress >= 100 ? "success" : (advancedLevelProgress > 0 ? "warning" : "secondary"))" style="width: @advancedLevelProgress%"></div>
                        </div>
                        <small class="text-muted">@(advancedLevelProgress > 0 ? $"{advancedLevelProgress}% " + Html.T("Ù…ÙƒØªÙ…Ù„", "complete") : Html.T("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø£ÙˆÙ„Ø§Ù‹", "Complete basics first"))</small>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="p-3 bg-@(proLevelProgress >= 100 ? "success" : (proLevelProgress > 0 ? "info" : "secondary"))-subtle rounded">
                        <div class="d-flex align-items-center mb-2">
                            <i class="feather-@(proLevelProgress >= 100 ? "check-circle text-success" : (proLevelProgress > 0 ? "activity text-info" : "lock text-secondary")) me-2"></i>
                            <strong>@Html.T("Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3: Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ", "Level 3: Professional")</strong>
                        </div>
                        <div class="progress mb-2" style="height: 6px;">
                            <div class="progress-bar bg-@(proLevelProgress >= 100 ? "success" : (proLevelProgress > 0 ? "info" : "secondary"))" style="width: @proLevelProgress%"></div>
                        </div>
                        <small class="text-muted">@(proLevelProgress > 0 ? $"{proLevelProgress}% " + Html.T("Ù…ÙƒØªÙ…Ù„", "complete") : Html.T("Ø³ÙŠØªÙ… ÙØªØ­Ù‡ Ù‚Ø±ÙŠØ¨Ø§Ù‹", "Coming soon"))</small>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-4">
                <button class="btn btn-primary btn-lg">
                    <i class="feather-play me-2"></i>
                    @Html.T("Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ", "Continue learning path")
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Social Sharing -->
<div class="row g-4">
    <div class="col-12">
        <div class="next-step-card" style="border-color: #3b82f6;">
            <h4 class="mb-4">
                <i class="feather-share-2 text-primary me-2"></i>
                @Html.T("Ø´Ø§Ø±Ùƒ Ø¥Ù†Ø¬Ø§Ø²Ùƒ Ù…Ø¹ Ø§Ù„Ø¹Ø§Ù„Ù…", "Share your achievement with the world")
            </h4>
            <p class="text-muted mb-4">@Html.T("Ø§Ø¬Ø¹Ù„ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ† ÙŠØ¹Ø±ÙÙˆÙ† Ø¹Ù† Ù†Ø¬Ø§Ø­Ùƒ!", "Let others know about your success!")</p>
            
            <div class="row g-3">
                <div class="col-md-3">
                    <button class="social-share-btn w-100" style="border-color: #1877f2;">
                        <i class="feather-facebook text-primary mb-2" style="font-size: 24px;"></i>
                        <div class="fw-bold">@Html.T("ÙÙŠØ³Ø¨ÙˆÙƒ", "Facebook")</div>
                    </button>
                </div>
                <div class="col-md-3">
                    <button class="social-share-btn w-100" style="border-color: #1da1f2;">
                        <i class="feather-twitter text-info mb-2" style="font-size: 24px;"></i>
                        <div class="fw-bold">@Html.T("ØªÙˆÙŠØªØ±", "Twitter")</div>
                    </button>
                </div>
                <div class="col-md-3">
                    <button class="social-share-btn w-100" style="border-color: #0a66c2;">
                        <i class="feather-linkedin text-primary mb-2" style="font-size: 24px;"></i>
                        <div class="fw-bold">@Html.T("Ù„ÙŠÙ†ÙƒØ¯ Ø¥Ù†", "LinkedIn")</div>
                    </button>
                </div>
                <div class="col-md-3">
                    <button class="social-share-btn w-100" style="border-color: #25d366;">
                        <i class="feather-message-circle text-success mb-2" style="font-size: 24px;"></i>
                        <div class="fw-bold">@Html.T("ÙˆØ§ØªØ³Ø§Ø¨", "WhatsApp")</div>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
<script>
    // Dynamic chart data from server
    var chartLabels = @Html.Raw(Json.Serialize(ViewBag.ChartLabels ?? new List<string> { System.Threading.Thread.CurrentThread.CurrentUICulture.TwoLetterISOLanguageName == "ar" ? "Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²" : "Achievement" }));
    var chartData = @Html.Raw(Json.Serialize(ViewBag.ChartData ?? new List<int> { 100 }));
    
    // Progress Chart
    const ctx = document.getElementById('progressChart').getContext('2d');
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: chartLabels,
            datasets: [{
                label: '@Html.Raw(Html.T("Ø§Ù„ØªÙ‚Ø¯Ù…", "Progress").ToString().Replace("'", "\\'"))',
                data: chartData,
                borderColor: '#667eea',
                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                fill: true,
                tension: 0.4,
                pointRadius: 6,
                pointBackgroundColor: '#667eea'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
                y: { beginAtZero: true, max: 100 }
            }
        }
    });
    
    function downloadCertificate() {
        window.open('/Student/Certificates/Download/@completedCourseId', '_blank');
    }
    
    function shareAchievement() {
        const text = (window.__T && window.__T.ShareText) || 'You just completed a great course! ğŸ‰';
        if (navigator.share) {
            navigator.share({ title: (window.__T && window.__T.NewAchievement) || 'New achievement', text: text });
        } else {
            alert((window.__T && window.__T.LinkCopied) || 'Link copied!');
        }
    }
    
    function addToWishlist(courseId) {
        fetch(`/Student/Courses/AddToWishlist`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ courseId })
        }).then(r => r.json()).then(d => {
            if (d.success) alert((window.__T && window.__T.AddedToWishlist) || 'Added to wishlist!');
        });
    }
</script>
}
