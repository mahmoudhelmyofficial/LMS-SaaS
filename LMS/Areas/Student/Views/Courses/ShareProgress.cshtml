@model LMS.Areas.Student.ViewModels.ShareProgressViewModel
@{
    ViewData["Title"] = Html.T("Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªÙ‚Ø¯Ù…", "Share Progress");
    var courseName = Model?.CourseName ?? "";
    var progress = Model?.Progress ?? 0;
    var studentName = Model?.StudentName ?? "";
    var completed = Model?.Completed ?? false;
    var shareUrl = Model?.ShareUrl ?? "";
    var imageUrl = Model?.ImageUrl ?? "";
}

@section Styles {
<style>
    .share-card {
        max-width: 600px;
        margin: 0 auto;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 16px;
        padding: 40px;
        text-align: center;
    }
    .progress-circle {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        background: white;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 24px;
        font-size: 48px;
        font-weight: bold;
        color: #667eea;
    }
    .social-btn {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        color: white;
        transition: transform 0.3s ease;
    }
    .social-btn:hover {
        transform: scale(1.1);
    }
    .social-btn.facebook { background: #1877f2; }
    .social-btn.twitter { background: #1da1f2; }
    .social-btn.linkedin { background: #0077b5; }
    .social-btn.whatsapp { background: #25d366; }
</style>
}

<!-- Alert Messages -->
@await Html.PartialAsync("_AlertMessage")

<!-- Header -->
<div class="card stretch stretch-full mb-4">
    <div class="card-body">
        <div class="d-flex align-items-center justify-content-between">
            <div>
                <h3 class="fw-bold mb-2">
                    <i class="feather-share-2 text-primary me-2"></i>
                    @Html.T("Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªÙ‚Ø¯Ù…", "Share Progress")
                </h3>
                <p class="text-muted mb-0">@Html.T("Ø´Ø§Ø±Ùƒ Ø¥Ù†Ø¬Ø§Ø²Ùƒ Ù…Ø¹ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†", "Share your achievement with others")</p>
            </div>
        </div>
    </div>
</div>

<!-- Share Card -->
<div class="card stretch stretch-full mb-4">
    <div class="card-body">
        <div class="share-card">
            @if (completed)
            {
                <div class="mb-4">
                    <div style="font-size: 80px;">ğŸ‰</div>
                    <h3 class="text-white mb-3">@Html.T("ØªÙ‡Ø§Ù†ÙŠÙ†Ø§!", "Congratulations!")</h3>
                    <p class="fs-5 mb-4">@Html.T("Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø¯ÙˆØ±Ø©", "You have completed the course") <strong>@courseName</strong></p>
                </div>
            }
            else
            {
                <div class="progress-circle">
                    @(progress)%
                </div>
                <h4 class="text-white mb-3">@courseName</h4>
                <p class="mb-4">@Html.T("ØªÙ‚Ø¯Ù…Øª Ø¨Ù†Ø³Ø¨Ø©", "You've progressed") @(progress)% @Html.T("ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ±Ø©", "in this course")</p>
            }
            
            <div class="bg-white bg-opacity-10 rounded p-3 mb-4">
                <p class="mb-0 small">@studentName</p>
            </div>

            <h5 class="text-white mb-3">@Html.T("Ø´Ø§Ø±Ùƒ Ø¥Ù†Ø¬Ø§Ø²Ùƒ", "Share Your Achievement")</h5>
            <div class="d-flex justify-content-center gap-3">
                <a href="#" class="social-btn facebook" onclick="shareOnFacebook(); return false;" title="@Html.T("ÙÙŠØ³Ø¨ÙˆÙƒ", "Facebook")">
                    <i class="feather-facebook"></i>
                </a>
                <a href="#" class="social-btn twitter" onclick="shareOnTwitter(); return false;" title="@Html.T("ØªÙˆÙŠØªØ±", "Twitter")">
                    <i class="feather-twitter"></i>
                </a>
                <a href="#" class="social-btn linkedin" onclick="shareOnLinkedIn(); return false;" title="@Html.T("Ù„ÙŠÙ†ÙƒØ¯ Ø¥Ù†", "LinkedIn")">
                    <i class="feather-linkedin"></i>
                </a>
                <a href="#" class="social-btn whatsapp" onclick="shareOnWhatsApp(); return false;" title="@Html.T("ÙˆØ§ØªØ³Ø§Ø¨", "WhatsApp")">
                    <i class="feather-message-circle"></i>
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Copy Link -->
<div class="card stretch stretch-full">
    <div class="card-body">
        <h5 class="fw-bold mb-3">@Html.T("Ø£Ùˆ Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·", "Or Copy the Link")</h5>
        <div class="input-group">
            <input type="text" class="form-control" id="shareLink" value="@shareUrl" readonly>
            <button class="btn btn-primary" type="button" onclick="copyLink()">
                <i class="feather-copy me-2"></i>
                @Html.T("Ù†Ø³Ø®", "Copy")
            </button>
        </div>
    </div>
</div>

@section Scripts {
<script>
    const shareUrl = '@shareUrl';
    const courseName = '@courseName';
    const progress = @progress;
    const completed = @(completed ? "true" : "false");
    
    function shareOnFacebook() {
        const text = completed 
            ? `ğŸ‰ Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ù„Ù„ØªÙˆ Ø¯ÙˆØ±Ø© ${courseName}! ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø°ÙŠ Ø£Ø­Ø±Ø²ØªÙ‡.`
            : `Ø£Ù†Ø§ Ø£ØªØ¹Ù„Ù… ${courseName} ÙˆØ­Ù‚Ù‚Øª ${progress}% ØªÙ‚Ø¯Ù…! ğŸ“š`;
        const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}&quote=${encodeURIComponent(text)}`;
        window.open(url, '_blank', 'width=600,height=400');
    }
    
    function shareOnTwitter() {
        const text = completed 
            ? `ğŸ‰ Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ù„Ù„ØªÙˆ Ø¯ÙˆØ±Ø© ${courseName}! #Ø§Ù„ØªØ¹Ù„Ù… #Ø§Ù„Ù†Ø¬Ø§Ø­`
            : `Ø£Ù†Ø§ Ø£ØªØ¹Ù„Ù… ${courseName} ÙˆØ­Ù‚Ù‚Øª ${progress}% ØªÙ‚Ø¯Ù…! ğŸ“š #Ø§Ù„ØªØ¹Ù„Ù…`;
        const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(shareUrl)}`;
        window.open(url, '_blank', 'width=600,height=400');
    }
    
    function shareOnLinkedIn() {
        const url = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(shareUrl)}`;
        window.open(url, '_blank', 'width=600,height=400');
    }
    
    function shareOnWhatsApp() {
        const text = completed 
            ? `ğŸ‰ Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ù„Ù„ØªÙˆ Ø¯ÙˆØ±Ø© ${courseName}! ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙ‚Ø¯Ù…: ${shareUrl}`
            : `Ø£Ù†Ø§ Ø£ØªØ¹Ù„Ù… ${courseName} ÙˆØ­Ù‚Ù‚Øª ${progress}% ØªÙ‚Ø¯Ù…! ğŸ“š ${shareUrl}`;
        const url = `https://wa.me/?text=${encodeURIComponent(text)}`;
        window.open(url, '_blank');
    }
    
    function copyLink() {
        const input = document.getElementById('shareLink');
        input.select();
        document.execCommand('copy');
        
        // Show success message
        const button = event.target.closest('button');
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="feather-check me-2"></i>@Html.T("ØªÙ… Ø§Ù„Ù†Ø³Ø®", "Copied")';
        button.classList.add('btn-success');
        button.classList.remove('btn-primary');
        
        setTimeout(() => {
            button.innerHTML = originalText;
            button.classList.remove('btn-success');
            button.classList.add('btn-primary');
        }, 2000);
    }
</script>
}
