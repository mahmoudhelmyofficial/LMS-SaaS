@model LMS.Areas.Student.Controllers.SettingsViewModel
@{
    ViewData["Title"] = Html.T("الإعدادات", "Settings");
}

<!-- Alert Messages -->
@await Html.PartialAsync("_AlertMessage")

<!-- Header -->
<div class="card stretch stretch-full mb-4">
    <div class="card-body">
        <h3 class="fw-bold mb-2">
            <i class="feather-settings text-primary me-2"></i>
            @Html.T("الإعدادات", "Settings")
        </h3>
        <p class="text-muted mb-0">@Html.T("إدارة إعدادات حسابك وتفضيلاتك", "Manage your account settings and preferences")</p>
    </div>
</div>

<form asp-action="UpdateSettings" method="post">
    @Html.AntiForgeryToken()
    
    <div class="row g-4">
        <!-- Main Settings Column -->
        <div class="col-lg-8">
            <!-- Profile Settings -->
            <div class="card stretch stretch-full mb-4">
                <div class="card-header">
                    <h5 class="fw-bold mb-0">
                        <i class="feather-user me-2"></i>
                        @Html.T("المعلومات الشخصية", "Personal Information")
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label asp-for="FirstName" class="form-label">@Html.T("الاسم الأول *", "First Name *")</label>
                            <input asp-for="FirstName" class="form-control" required />
                            <span asp-validation-for="FirstName" class="text-danger"></span>
                        </div>
                        <div class="col-md-6">
                            <label asp-for="LastName" class="form-label">@Html.T("الاسم الأخير *", "Last Name *")</label>
                            <input asp-for="LastName" class="form-control" required />
                            <span asp-validation-for="LastName" class="text-danger"></span>
                        </div>
                        <div class="col-md-6">
                            <label asp-for="Email" class="form-label">@Html.T("البريد الإلكتروني", "Email")</label>
                            <input asp-for="Email" class="form-control" readonly disabled />
                            <small class="text-muted">@Html.T("لتغيير البريد الإلكتروني، تواصل مع الدعم", "To change your email, contact support")</small>
                        </div>
                        <div class="col-md-6">
                            <label asp-for="PhoneNumber" class="form-label">@Html.T("رقم الهاتف", "Phone Number")</label>
                            <input asp-for="PhoneNumber" class="form-control" type="tel" dir="ltr" />
                            <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                        </div>
                        <div class="col-md-6">
                            <label asp-for="TimeZone" class="form-label">@Html.T("المنطقة الزمنية", "Time Zone")</label>
                            <select asp-for="TimeZone" class="form-select">
                                <option value="Africa/Cairo">@Html.T("القاهرة (GMT+2)", "Cairo (GMT+2)")</option>
                                <option value="Asia/Riyadh">@Html.T("الرياض (GMT+3)", "Riyadh (GMT+3)")</option>
                                <option value="Asia/Dubai">@Html.T("دبي (GMT+4)", "Dubai (GMT+4)")</option>
                                <option value="Asia/Kuwait">@Html.T("الكويت (GMT+3)", "Kuwait (GMT+3)")</option>
                                <option value="UTC">@Html.T("UTC", "UTC")</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label asp-for="Language" class="form-label">@Html.T("اللغة", "Language")</label>
                            <select asp-for="Language" class="form-select">
                                <option value="ar">@Html.T("العربية", "Arabic")</option>
                                <option value="en">@Html.T("الإنجليزية", "English")</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Privacy Settings -->
            <div class="card stretch stretch-full mb-4">
                <div class="card-header">
                    <h5 class="fw-bold mb-0">
                        <i class="feather-shield me-2"></i>
                        @Html.T("الخصوصية", "Privacy")
                    </h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label asp-for="ProfileVisibility" class="form-label">@Html.T("ظهور الملف الشخصي", "Profile Visibility")</label>
                        <select asp-for="ProfileVisibility" class="form-select">
                            <option value="Public">@Html.T("عام - الجميع", "Public - Everyone")</option>
                            <option value="StudentsOnly">@Html.T("الطلاب المسجلين فقط", "Registered Students Only")</option>
                            <option value="Private">@Html.T("خاص - أنا فقط", "Private - Only Me")</option>
                        </select>
                        <small class="text-muted">@Html.T("تحكم في من يمكنه رؤية ملفك الشخصي", "Control who can see your profile")</small>
                    </div>
                    <div class="form-check mb-3">
                        <input asp-for="ShowProgressPublicly" class="form-check-input" type="checkbox" />
                        <label asp-for="ShowProgressPublicly" class="form-check-label">
                            @Html.T("إظهار تقدمي في الدورات للآخرين", "Show my course progress to others")
                        </label>
                    </div>
                    <div class="form-check">
                        <input asp-for="AllowMessages" class="form-check-input" type="checkbox" />
                        <label asp-for="AllowMessages" class="form-check-label">
                            @Html.T("السماح للآخرين بإرسال رسائل لي", "Allow others to send me messages")
                        </label>
                    </div>
                </div>
            </div>

            <!-- Notification Settings -->
            <div class="card stretch stretch-full mb-4">
                <div class="card-header">
                    <h5 class="fw-bold mb-0">
                        <i class="feather-bell me-2"></i>
                    @Html.T("الإشعارات", "Notifications")
                </h5>
                </div>
                <div class="card-body">
                    <div class="form-check mb-3">
                        <input asp-for="EmailNotifications" class="form-check-input" type="checkbox" />
                        <label asp-for="EmailNotifications" class="form-check-label">
                            @Html.T("إشعارات البريد الإلكتروني", "Email Notifications")
                            <small class="text-muted d-block">@Html.T("استلام الإشعارات عبر البريد الإلكتروني", "Receive notifications via email")</small>
                        </label>
                    </div>
                    <div class="form-check mb-3">
                        <input asp-for="PushNotifications" class="form-check-input" type="checkbox" />
                        <label asp-for="PushNotifications" class="form-check-label">
                            @Html.T("الإشعارات الفورية", "Push Notifications")
                            <small class="text-muted d-block">@Html.T("إشعارات المتصفح والهاتف", "Browser and phone notifications")</small>
                        </label>
                    </div>
                    <div class="form-check mb-3">
                        <input asp-for="CourseUpdates" class="form-check-input" type="checkbox" />
                        <label asp-for="CourseUpdates" class="form-check-label">
                            @Html.T("تحديثات الدورات", "Course Updates")
                            <small class="text-muted d-block">@Html.T("إشعارات عند إضافة محتوى جديد للدورات المسجل بها", "Notifications when new content is added to enrolled courses")</small>
                        </label>
                    </div>
                    <div class="form-check">
                        <input asp-for="WeeklyDigest" class="form-check-input" type="checkbox" />
                        <label asp-for="WeeklyDigest" class="form-check-label">
                            @Html.T("الملخص الأسبوعي", "Weekly Summary")
                            <small class="text-muted d-block">@Html.T("ملخص أسبوعي بتقدمك وأنشطتك", "Weekly summary of your progress and activities")</small>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Save Button -->
            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary flex-grow-1">
                    <i class="feather-save me-2"></i>
                    @Html.T("حفظ التغييرات", "Save Changes")
                </button>
                <a asp-action="Index" class="btn btn-outline-secondary">
                    <i class="feather-x me-2"></i>
                    @Html.T("إلغاء", "Cancel")
                </a>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
            <!-- Security Quick Status -->
            <div class="card stretch stretch-full mb-4">
                <div class="card-header">
                    <h6 class="fw-bold mb-0">
                        <i class="feather-lock me-2"></i>
                        @Html.T("حالة الأمان", "Security Status")
                    </h6>
                </div>
                <div class="card-body">
                    <div class="d-flex align-items-center justify-content-between mb-3">
                        <span>@Html.T("البريد الإلكتروني", "Email")</span>
                        @if (Model.EmailConfirmed)
                        {
                            <span class="badge bg-success">@Html.T("مؤكد", "Confirmed")</span>
                        }
                        else
                        {
                            <span class="badge bg-warning">@Html.T("غير مؤكد", "Not Confirmed")</span>
                        }
                    </div>
                    <div class="d-flex align-items-center justify-content-between mb-3">
                        <span>@Html.T("رقم الهاتف", "Phone Number")</span>
                        @if (Model.PhoneNumberConfirmed)
                        {
                            <span class="badge bg-success">@Html.T("مؤكد", "Confirmed")</span>
                        }
                        else
                        {
                            <span class="badge bg-secondary">@Html.T("غير مضاف", "Not Added")</span>
                        }
                    </div>
                    <div class="d-flex align-items-center justify-content-between mb-4">
                        <span>@Html.T("المصادقة الثنائية", "Two-Factor Authentication")</span>
                        @if (Model.TwoFactorEnabled)
                        {
                            <span class="badge bg-success">@Html.T("مفعّلة", "Enabled")</span>
                        }
                        else
                        {
                            <span class="badge bg-warning">@Html.T("معطّلة", "Disabled")</span>
                        }
                    </div>
                    <a asp-action="SecuritySettings" class="btn btn-outline-primary btn-sm w-100">
                        <i class="feather-settings me-2"></i>
                        @Html.T("إدارة الأمان", "Manage Security")
                    </a>
                </div>
            </div>

            <!-- Quick Links -->
            <div class="card stretch stretch-full">
                <div class="card-header">
                    <h6 class="fw-bold mb-0">
                        <i class="feather-link me-2"></i>
                        @Html.T("روابط سريعة", "Quick Links")
                    </h6>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a asp-action="SecuritySettings" class="btn btn-outline-secondary btn-sm text-start">
                            <i class="feather-shield me-2"></i>
                            @Html.T("تغيير كلمة المرور", "Change Password")
                        </a>
                        <a asp-action="NotificationPreferences" class="btn btn-outline-secondary btn-sm text-start">
                            <i class="feather-bell me-2"></i>
                            @Html.T("إعدادات الإشعارات المتقدمة", "Advanced Notification Settings")
                        </a>
                        <a asp-action="PrivacySettings" class="btn btn-outline-secondary btn-sm text-start">
                            <i class="feather-eye-off me-2"></i>
                            @Html.T("إعدادات الخصوصية المتقدمة", "Advanced Privacy Settings")
                        </a>
                        <a asp-action="DownloadData" method="post" class="btn btn-outline-secondary btn-sm text-start">
                            <i class="feather-download me-2"></i>
                            @Html.T("تحميل بياناتي", "Download My Data")
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
