@model LMS.Areas.Student.ViewModels.ProfileEditViewModel
@{
    ViewData["Title"] = Html.T("تعديل الملف الشخصي", "Edit Profile");
}

@section Styles {
<style>
    .profile-picture-upload {
        position: relative;
        width: 150px;
        height: 150px;
        margin: 0 auto;
        cursor: pointer;
    }
    .profile-picture-upload img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 50%;
    }
    .profile-picture-overlay {
        position: absolute;
        top: 0;
        right: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: opacity 0.3s;
    }
    .profile-picture-upload:hover .profile-picture-overlay {
        opacity: 1;
    }
</style>
}

<!-- Alert Messages -->
@await Html.PartialAsync("_AlertMessage")

<div class="row g-4">
    <div class="col-lg-8">
        <form asp-action="Edit" method="post" enctype="multipart/form-data">
            <!-- Profile Picture -->
            <div class="card stretch stretch-full mb-4">
                <div class="card-header">
                    <h5 class="fw-bold mb-0">
                        <i class="feather-image me-2"></i>
                        @Html.T("الصورة الشخصية", "Profile Picture")
                    </h5>
                </div>
                <div class="card-body text-center">
                    <p class="text-muted">@Html.T("يمكنك تحديث صورة الملف الشخصي من الإعدادات الرئيسية", "You can update your profile picture from the main settings")</p>
                </div>
            </div>

            <!-- Personal Information -->
            <div class="card stretch stretch-full mb-4">
                <div class="card-header">
                    <h5 class="fw-bold mb-0">
                        <i class="feather-user me-2"></i>
                        @Html.T("المعلومات الشخصية", "Personal Information")
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label asp-for="FirstName" class="form-label"></label>
                            <input asp-for="FirstName" class="form-control" />
                            <span asp-validation-for="FirstName" class="text-danger"></span>
                        </div>
                        <div class="col-md-6">
                            <label asp-for="LastName" class="form-label"></label>
                            <input asp-for="LastName" class="form-control" />
                            <span asp-validation-for="LastName" class="text-danger"></span>
                        </div>
                        <div class="col-md-6">
                            <label asp-for="DateOfBirth" class="form-label"></label>
                            <input asp-for="DateOfBirth" class="form-control" type="date" />
                            <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                        </div>
                        <div class="col-md-6">
                            <label asp-for="Language" class="form-label"></label>
                            <select asp-for="Language" class="form-select">
                                <option value="ar">@Html.T("العربية", "Arabic")</option>
                                <option value="en">@Html.T("الإنجليزية", "English")</option>
                            </select>
                            <span asp-validation-for="Language" class="text-danger"></span>
                        </div>
                        <div class="col-12">
                            <label asp-for="Bio" class="form-label"></label>
                            <textarea asp-for="Bio" class="form-control" rows="4" placeholder="@Html.T("اكتب نبذة مختصرة عنك...", "Write a short bio about yourself...")"></textarea>
                            <span asp-validation-for="Bio" class="text-danger"></span>
                            <small class="text-muted">@Html.T("يمكن أن تكون مرئية للطلاب الآخرين", "This may be visible to other students")</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Additional Information -->
            <div class="card stretch stretch-full mb-4">
                <div class="card-header">
                    <h5 class="fw-bold mb-0">
                        <i class="feather-info me-2"></i>
                        @Html.T("معلومات إضافية", "Additional Information")
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label asp-for="Country" class="form-label"></label>
                            <input asp-for="Country" class="form-control" />
                            <span asp-validation-for="Country" class="text-danger"></span>
                        </div>
                        <div class="col-md-6">
                            <label asp-for="City" class="form-label"></label>
                            <input asp-for="City" class="form-control" />
                            <span asp-validation-for="City" class="text-danger"></span>
                        </div>
                        <div class="col-md-12">
                            <label asp-for="TimeZone" class="form-label"></label>
                            <select asp-for="TimeZone" class="form-select">
                                <option value="Africa/Cairo">@Html.T("القاهرة (GMT+2)", "Cairo (GMT+2)")</option>
                                <option value="Asia/Riyadh">@Html.T("الرياض (GMT+3)", "Riyadh (GMT+3)")</option>
                                <option value="Asia/Dubai">@Html.T("دبي (GMT+4)", "Dubai (GMT+4)")</option>
                                <option value="Europe/London">@Html.T("لندن (GMT)", "London (GMT)")</option>
                                <option value="America/New_York">@Html.T("نيويورك (GMT-5)", "New York (GMT-5)")</option>
                            </select>
                            <span asp-validation-for="TimeZone" class="text-danger"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Save Button -->
            <div class="card stretch stretch-full">
                <div class="card-body">
                    <div class="d-flex gap-3">
                        <button type="submit" class="btn btn-primary flex-grow-1">
                            <i class="feather-save me-2"></i>
                            @Html.T("حفظ التغييرات", "Save Changes")
                        </button>
                        <a asp-action="Index" class="btn btn-outline-secondary">
                            <i class="feather-x me-2"></i>
                            @Html.T("إلغاء", "Cancel")
                        </a>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <!-- Sidebar -->
    <div class="col-lg-4">
        <!-- Profile Completion -->
        <div class="card stretch stretch-full mb-4">
            <div class="card-header">
                <h6 class="fw-bold mb-0">
                    <i class="feather-trending-up me-2"></i>
                    @Html.T("اكتمال الملف", "Profile Completion")
                </h6>
            </div>
            <div class="card-body">
                <div class="text-center mb-3">
                    <h2 class="fw-bold text-primary mb-0">@Model.ProfileCompletionPercentage%</h2>
                    <p class="text-muted mb-0">@Html.T("اكتمل ملفك بنسبة", "Your profile is complete")</p>
                </div>
                <div class="progress ht-10 mb-3">
                    <div class="progress-bar bg-primary" style="width: @Model.ProfileCompletionPercentage%"></div>
                </div>
                @if (Model.ProfileCompletionPercentage < 100)
                {
                    <div class="alert alert-info mb-0 py-2">
                        <small>
                            <i class="feather-lightbulb me-1"></i>
                            @Html.T("أكمل ملفك للحصول على توصيات أفضل", "Complete your profile for better recommendations")
                        </small>
                    </div>
                }
                else
                {
                    <div class="alert alert-success mb-0 py-2">
                        <small>
                            <i class="feather-check-circle me-1"></i>
                            @Html.T("ملفك مكتمل! رائع", "Your profile is complete! Great")
                        </small>
                    </div>
                }
            </div>
        </div>

        <!-- Quick Links -->
        <div class="card stretch stretch-full">
            <div class="card-header">
                <h6 class="fw-bold mb-0">@Html.T("روابط سريعة", "Quick Links")</h6>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a asp-action="Security" class="btn btn-outline-warning">
                        <i class="feather-shield me-2"></i>
                        @Html.T("الأمان وكلمة المرور", "Security & Password")
                    </a>
                    <a asp-action="Privacy" class="btn btn-outline-info">
                        <i class="feather-lock me-2"></i>
                        @Html.T("إعدادات الخصوصية", "Privacy Settings")
                    </a>
                    <a asp-area="Student" asp-controller="Settings" asp-action="Index" asp-route-tab="notifications" class="btn btn-outline-secondary">
                        <i class="feather-bell me-2"></i>
                        @Html.T("إعدادات الإشعارات", "Notification Settings")
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
