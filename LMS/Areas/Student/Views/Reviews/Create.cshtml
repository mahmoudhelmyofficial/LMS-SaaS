@model LMS.Areas.Student.ViewModels.CreateReviewViewModel
@using LMS.Services.Interfaces
@inject IPlatformSettingsService PlatformSettings
@{
    ViewData["Title"] = Html.T("Ø¥Ø¶Ø§ÙØ© ØªÙ‚ÙŠÙŠÙ…", "Add Review");
    var course = ViewBag.Course as LMS.Domain.Entities.Courses.Course;
    
    // Review settings
    var reviewTitleMaxLength = await PlatformSettings.GetIntSettingAsync("Reviews.TitleMaxLength", 100);
    var reviewContentMaxLength = await PlatformSettings.GetIntSettingAsync("Reviews.ContentMaxLength", 2000);
    var reviewMinCommentForExtremeRating = await PlatformSettings.GetIntSettingAsync("Reviews.MinCommentForExtremeRating", 50);
}

@section Styles {
<style>
    .rating-stars {
        font-size: 48px;
        direction: ltr;
        display: inline-flex;
        gap: 10px;
    }
    .rating-stars i {
        cursor: pointer;
        color: #e5e7eb;
        transition: all 0.2s ease;
    }
    .rating-stars i.active,
    .rating-stars i:hover {
        color: #fbbf24;
        transform: scale(1.2);
    }
    
    .review-card {
        background: white;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 2px 15px rgba(0,0,0,0.08);
    }
    
    .course-info-box {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 12px;
        padding: 30px;
        margin-bottom: 30px;
    }
    
    .guidelines-box {
        background: #f9fafb;
        border-radius: 8px;
        padding: 20px;
        border-right: 4px solid #667eea;
    }
    
    .char-counter {
        position: absolute;
        bottom: 10px;
        left: 15px;
        font-size: 12px;
        color: #6b7280;
    }
    .char-counter.warning { color: #f59e0b; }
    .char-counter.danger { color: #ef4444; }
</style>
}

<!-- Alert Messages -->
@await Html.PartialAsync("_AlertMessage")

<!-- Page Header -->
<div class="card stretch stretch-full mb-4">
    <div class="card-body">
        <div class="d-flex align-items-center">
            <a href="@Url.Action("Details", "Courses", new { area = "Student", id = Model.CourseId })" class="btn btn-sm btn-light me-3">
                <i class="feather-arrow-right me-1"></i>
                @Html.T("Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø¯ÙˆØ±Ø©", "Back to Course")
            </a>
            <div>
                <h3 class="fw-bold mb-1">
                    <i class="feather-star text-warning me-2"></i>
                    @Html.T("Ø¥Ø¶Ø§ÙØ© ØªÙ‚ÙŠÙŠÙ… Ù„Ù„Ø¯ÙˆØ±Ø©", "Add Course Review")
                </h3>
                <p class="text-muted mb-0">@Html.T("Ø´Ø§Ø±Ùƒ ØªØ¬Ø±Ø¨ØªÙƒ Ù…Ø¹ Ø§Ù„Ø¯ÙˆØ±Ø© Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†", "Share your experience with the course to help others")</p>
            </div>
        </div>
    </div>
</div>

<!-- Course Info Box -->
@if (course != null)
{
    <div class="course-info-box">
        <div class="row align-items-center">
            <div class="col-md-2 text-center mb-3 mb-md-0">
                <div class="avatar-text avatar-xl bg-white bg-opacity-25 text-white">
                    <i class="feather-book-open"></i>
                </div>
            </div>
            <div class="col-md-10">
                <h4 class="text-white fw-bold mb-2">@course.Title</h4>
                <p class="text-white opacity-75 mb-2">@(course.Instructor?.FullName ?? "â€”")</p>
                <div class="d-flex flex-wrap gap-2">
                    <span class="badge bg-white bg-opacity-25 text-white">
                        <i class="feather-users me-1"></i>
                        @course.TotalEnrollments @Html.T("Ø·Ø§Ù„Ø¨", "student")
                    </span>
                    @if (course.AverageRating > 0)
                    {
                        <span class="badge bg-white bg-opacity-25 text-white">
                            <i class="feather-star me-1"></i>
                            @course.AverageRating.ToString("F1")
                        </span>
                    }
                </div>
            </div>
        </div>
    </div>
}

<div class="row g-4">
    <!-- Review Form -->
    <div class="col-lg-8">
        <div class="review-card">
            <form asp-action="Create" method="post" id="reviewForm">
                @Html.AntiForgeryToken()
                @Html.HiddenFor(m => m.CourseId)
                
                <!-- Rating Section -->
                <div class="mb-4">
                    <label class="form-label fw-bold fs-5 mb-3">
                        @Html.T("ÙƒÙŠÙ ØªÙ‚ÙŠÙ‘Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ±Ø©ØŸ", "How do you rate this course?")
                        <span class="text-danger">*</span>
                    </label>
                    
                    <div class="text-center py-4">
                        <div class="rating-stars" id="ratingStars">
                            <i class="feather-star" data-rating="1"></i>
                            <i class="feather-star" data-rating="2"></i>
                            <i class="feather-star" data-rating="3"></i>
                            <i class="feather-star" data-rating="4"></i>
                            <i class="feather-star" data-rating="5"></i>
                        </div>
                        <input type="hidden" asp-for="Rating" id="ratingValue" value="0">
                        <div class="mt-3">
                            <h4 class="fw-bold mb-0" id="ratingText">@Html.T("Ø§Ø®ØªØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…", "Select Rating")</h4>
                            <small class="text-muted" id="ratingDesc">@Html.T("Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¬ÙˆÙ… Ù„Ù„ØªÙ‚ÙŠÙŠÙ…", "Click the stars to rate")</small>
                        </div>
                    </div>
                    <span asp-validation-for="Rating" class="text-danger"></span>
                </div>
                
                <hr class="my-4">
                
                <!-- Title -->
                <div class="mb-4">
                    <label asp-for="Title" class="form-label fw-bold">
                        @Html.T("Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙ‚ÙŠÙŠÙ…", "Review Title")
                    </label>
                    <input asp-for="Title" 
                           class="form-control form-control-lg" 
                           placeholder="@Html.T("Ù…Ø«Ø§Ù„: Ø¯ÙˆØ±Ø© Ù…Ù…ØªØ§Ø²Ø© ÙˆÙ…ÙÙŠØ¯Ø© Ø¬Ø¯Ø§Ù‹", "e.g. Excellent and very useful course")"
                           maxlength="@reviewTitleMaxLength">
                    <span asp-validation-for="Title" class="text-danger"></span>
                    <div class="form-text">
                        <i class="feather-info me-1"></i>
                        @Html.T("Ø§ÙƒØªØ¨ Ø¹Ù†ÙˆØ§Ù†Ø§Ù‹ Ù…Ø®ØªØµØ±Ø§Ù‹ ÙˆÙˆØ§Ø¶Ø­Ø§Ù‹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)", "Write a brief and clear title (optional)")
                    </div>
                </div>
                
                <!-- Comment -->
                <div class="mb-4">
                    <label asp-for="Comment" class="form-label fw-bold">
                        @Html.T("Ø±Ø£ÙŠÙƒ ÙÙŠ Ø§Ù„Ø¯ÙˆØ±Ø©", "Your Opinion on the Course")
                        <span class="text-danger">*</span>
                    </label>
                    <div style="position: relative;">
                        <textarea asp-for="Comment" 
                                  class="form-control" 
                                  rows="8" 
                                  id="commentText"
                                  placeholder="@Html.T($"Ø´Ø§Ø±Ùƒ ØªØ¬Ø±Ø¨ØªÙƒ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© Ù…Ø¹ Ø§Ù„Ø¯ÙˆØ±Ø©... Ù…Ø§Ø°Ø§ Ø£Ø¹Ø¬Ø¨ÙƒØŸ Ù…Ø§Ø°Ø§ ØªØ¹Ù„Ù…ØªØŸ Ù‡Ù„ ØªÙ†ØµØ­ Ø¨Ù‡Ø§ØŸ ({reviewMinCommentForExtremeRating} Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)", $"Share your detailed experience with the course... What did you like? What did you learn? Do you recommend it? ({reviewMinCommentForExtremeRating} characters minimum)")"
                                  maxlength="@reviewContentMaxLength"
                                  oninput="updateCharCount()"></textarea>
                        <span class="char-counter" id="charCounter">
                            <span id="charCount">0</span> / @reviewContentMaxLength
                        </span>
                    </div>
                    <span asp-validation-for="Comment" class="text-danger"></span>
                    <div class="form-text mt-2">
                        <i class="feather-alert-circle me-1"></i>
                        <strong>@Html.T($"Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…ØªØ·Ø±ÙØ© (1 Ø£Ùˆ 5 Ù†Ø¬ÙˆÙ…) ØªØªØ·Ù„Ø¨ ØªØ¹Ù„ÙŠÙ‚ ØªÙØµÙŠÙ„ÙŠ ({reviewMinCommentForExtremeRating} Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)", $"Extreme ratings (1 or 5 stars) require a detailed comment ({reviewMinCommentForExtremeRating} characters minimum)")</strong>
                    </div>
                </div>
                
                <!-- Quick Tips -->
                <div class="alert alert-info">
                    <h6 class="fw-bold mb-2">
                        <i class="feather-lightbulb me-2"></i>
                        @Html.T("Ù†ØµØ§Ø¦Ø­ Ù„ÙƒØªØ§Ø¨Ø© ØªÙ‚ÙŠÙŠÙ… Ù…ÙÙŠØ¯:", "Tips for writing a helpful review:")
                    </h6>
                    <ul class="mb-0 small">
                        <li>@Html.T("Ø§Ø´Ø±Ø­ Ù…Ø§ Ø§Ù„Ø°ÙŠ Ø£Ø¹Ø¬Ø¨Ùƒ Ø£Ùˆ Ù„Ù… ÙŠØ¹Ø¬Ø¨Ùƒ ÙÙŠ Ø§Ù„Ø¯ÙˆØ±Ø©", "Explain what you liked or didn't like about the course")</li>
                        <li>@Html.T("ØªØ­Ø¯Ø« Ø¹Ù† Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆØ·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø´Ø±Ø­", "Talk about the content quality and teaching style")</li>
                        <li>@Html.T("Ø§Ø°ÙƒØ± Ù…Ø§ ØªØ¹Ù„Ù…ØªÙ‡ ÙˆÙƒÙŠÙ Ø§Ø³ØªÙØ¯Øª", "Mention what you learned and how you benefited")</li>
                        <li>@Html.T("ÙƒÙ† ØµØ§Ø¯Ù‚Ø§Ù‹ ÙˆÙ…ÙˆØ¶ÙˆØ¹ÙŠØ§Ù‹ ÙÙŠ ØªÙ‚ÙŠÙŠÙ…Ùƒ", "Be honest and objective in your review")</li>
                        <li>@Html.T("ØªØ¬Ù†Ø¨ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø´Ø®ØµÙŠ Ø£Ùˆ Ø§Ù„Ù…Ø³ÙŠØ¡", "Avoid personal or offensive content")</li>
                    </ul>
                </div>
                
                <!-- Submit Buttons -->
                <div class="d-flex gap-3 mt-4">
                    <button type="submit" class="btn btn-primary btn-lg flex-grow-1">
                        <i class="feather-send me-2"></i>
                        @Html.T("Ù†Ø´Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…", "Submit Review")
                    </button>
                    <a href="@Url.Action("Details", "Courses", new { area = "Student", id = Model.CourseId })" 
                       class="btn btn-outline-danger btn-lg">
                        <i class="feather-x me-2"></i>
                        @Html.T("Ø¥Ù„ØºØ§Ø¡", "Cancel")
                    </a>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Guidelines Sidebar -->
    <div class="col-lg-4">
        <!-- Guidelines -->
        <div class="guidelines-box mb-4">
            <h5 class="fw-bold mb-3">
                <i class="feather-check-circle text-primary me-2"></i>
                @Html.T("Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ‚ÙŠÙŠÙ…", "Review Guidelines")
            </h5>
            
            <div class="mb-3">
                <div class="d-flex align-items-start mb-2">
                    <i class="feather-check text-success me-2 mt-1"></i>
                    <small>@Html.T("ÙƒÙ† ØµØ§Ø¯Ù‚Ø§Ù‹ ÙˆÙ…ÙˆØ¶ÙˆØ¹ÙŠØ§Ù‹", "Be honest and objective")</small>
                </div>
                <div class="d-flex align-items-start mb-2">
                    <i class="feather-check text-success me-2 mt-1"></i>
                    <small>@Html.T("Ø±ÙƒØ² Ø¹Ù„Ù‰ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¯ÙˆØ±Ø©", "Focus on course content")</small>
                </div>
                <div class="d-flex align-items-start mb-2">
                    <i class="feather-check text-success me-2 mt-1"></i>
                    <small>@Html.T("Ø§Ø³ØªØ®Ø¯Ù… Ù„ØºØ© Ù…Ø­ØªØ±Ù…Ø©", "Use respectful language")</small>
                </div>
                <div class="d-flex align-items-start mb-2">
                    <i class="feather-x text-danger me-2 mt-1"></i>
                    <small>@Html.T("Ù„Ø§ ØªÙ†Ø´Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø´Ø®ØµÙŠØ©", "Don't post personal information")</small>
                </div>
                <div class="d-flex align-items-start">
                    <i class="feather-x text-danger me-2 mt-1"></i>
                    <small>@Html.T("ØªØ¬Ù†Ø¨ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø³ÙŠØ¡", "Avoid offensive content")</small>
                </div>
            </div>
            
            <div class="alert alert-warning mb-0 py-2 px-3">
                <small>
                    <i class="feather-info me-2"></i>
                    @Html.T("Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙ‚ÙŠÙŠÙ…Ùƒ Ù‚Ø¨Ù„ Ù†Ø´Ø±Ù‡", "Your review will be reviewed before publishing")
                </small>
            </div>
        </div>
        
        <!-- Rating Guide -->
        <div class="card mb-4">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="feather-help-circle text-info me-2"></i>
                    @Html.T("Ø¯Ù„ÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…", "Rating Guide")
                </h6>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <div class="d-flex align-items-center mb-1">
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <strong>@Html.T("1 Ù†Ø¬Ù…Ø©", "1 Star")</strong>
                    </div>
                    <small class="text-muted">@Html.T("Ø³ÙŠØ¦Ø© Ø¬Ø¯Ø§Ù‹", "Very Poor")</small>
                </div>
                <div class="mb-3">
                    <div class="d-flex align-items-center mb-1">
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <strong>@Html.T("2 Ù†Ø¬Ù…Ø©", "2 Stars")</strong>
                    </div>
                    <small class="text-muted">@Html.T("ØºÙŠØ± Ù…Ø±Ø¶ÙŠØ©", "Unsatisfactory")</small>
                </div>
                <div class="mb-3">
                    <div class="d-flex align-items-center mb-1">
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <strong>@Html.T("3 Ù†Ø¬ÙˆÙ…", "3 Stars")</strong>
                    </div>
                    <small class="text-muted">@Html.T("Ø¬ÙŠØ¯Ø©", "Good")</small>
                </div>
                <div class="mb-3">
                    <div class="d-flex align-items-center mb-1">
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <strong>@Html.T("4 Ù†Ø¬ÙˆÙ…", "4 Stars")</strong>
                    </div>
                    <small class="text-muted">@Html.T("Ù…Ù…ØªØ§Ø²Ø©", "Excellent")</small>
                </div>
                <div>
                    <div class="d-flex align-items-center mb-1">
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <i class="feather-star text-warning fs-5 me-2"></i>
                        <strong>@Html.T("5 Ù†Ø¬ÙˆÙ…", "5 Stars")</strong>
                    </div>
                    <small class="text-muted">@Html.T("Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ©", "Exceptional")</small>
                </div>
            </div>
        </div>
        
        <!-- Preview Box -->
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="feather-eye text-primary me-2"></i>
                    @Html.T("Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…", "Review Preview")
                </h6>
            </div>
            <div class="card-body" id="previewBox">
                <p class="text-center text-muted small mb-0">
                    <i class="feather-star fs-3 mb-2 d-block"></i>
                    @Html.T("Ø§Ø®ØªØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙˆØ§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ", "Select rating and write your comment")
                </p>
            </div>
        </div>
    </div>
</div>

@section Scripts {
@{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
<script>
    (function() {
        window.__T = window.__T || {};
        Object.assign(window.__T, {
            Rating0: '',
            Rating1: '@Html.Raw(Html.T("Ø³ÙŠØ¦Ø© Ø¬Ø¯Ø§Ù‹ ğŸ˜", "Very poor ğŸ˜").Replace("'", "\\'"))',
            Rating2: '@Html.Raw(Html.T("ØºÙŠØ± Ù…Ø±Ø¶ÙŠØ© ğŸ˜•", "Unsatisfactory ğŸ˜•").Replace("'", "\\'"))',
            Rating3: '@Html.Raw(Html.T("Ø¬ÙŠØ¯Ø© ğŸ™‚", "Good ğŸ™‚").Replace("'", "\\'"))',
            Rating4: '@Html.Raw(Html.T("Ù…Ù…ØªØ§Ø²Ø© ğŸ˜Š", "Excellent ğŸ˜Š").Replace("'", "\\'"))',
            Rating5: '@Html.Raw(Html.T("Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ©! ğŸŒŸ", "Exceptional! ğŸŒŸ").Replace("'", "\\'"))',
            YourRatingFormat: '@Html.Raw(Html.T("ØªÙ‚ÙŠÙŠÙ…Ùƒ: {0} Ù†Ø¬ÙˆÙ…", "Your rating: {0} stars").Replace("'", "\\'"))',
            ClickStarsToRate: '@Html.Raw(Html.T("Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¬ÙˆÙ… Ù„Ù„ØªÙ‚ÙŠÙŠÙ…", "Click the stars to rate").Replace("'", "\\'"))'
        });
    })();
    let selectedRating = 0;
    const ratingTexts = ['', (window.__T && window.__T.Rating1) || 'Very poor ğŸ˜', (window.__T && window.__T.Rating2) || 'Unsatisfactory ğŸ˜•', (window.__T && window.__T.Rating3) || 'Good ğŸ™‚', (window.__T && window.__T.Rating4) || 'Excellent ğŸ˜Š', (window.__T && window.__T.Rating5) || 'Exceptional! ğŸŒŸ'];
    
    // Rating stars functionality
    document.querySelectorAll('#ratingStars i').forEach(star => {
        star.addEventListener('click', function() {
            selectedRating = parseInt(this.dataset.rating);
            document.getElementById('ratingValue').value = selectedRating;
            updateStars();
            updatePreview();
        });
        
        star.addEventListener('mouseenter', function() {
            const rating = parseInt(this.dataset.rating);
            highlightStars(rating);
        });
    });
    
    document.getElementById('ratingStars').addEventListener('mouseleave', function() {
        highlightStars(selectedRating);
    });
    
    function highlightStars(rating) {
        document.querySelectorAll('#ratingStars i').forEach((star, index) => {
            if (index < rating) {
                star.classList.add('active');
            } else {
                star.classList.remove('active');
            }
        });
    }
    
    function updateStars() {
        highlightStars(selectedRating);
        document.getElementById('ratingText').textContent = ratingTexts[selectedRating];
        var fmt = (window.__T && window.__T.YourRatingFormat) || 'Your rating: {0} stars';
        var clickText = (window.__T && window.__T.ClickStarsToRate) || 'Click the stars to rate';
        document.getElementById('ratingDesc').textContent = 
            selectedRating > 0 ? fmt.replace('{0}', selectedRating) : clickText;
    }
    
    // Character counter
    function updateCharCount() {
        const textarea = document.getElementById('commentText');
        const counter = document.getElementById('charCount');
        const counterContainer = document.getElementById('charCounter');
        const length = textarea.value.length;
        
        counter.textContent = length;
        
        const maxLength = @reviewContentMaxLength;
        counterContainer.classList.remove('warning', 'danger');
        if (length > maxLength * 0.9) {
            counterContainer.classList.add('danger');
        } else if (length > maxLength * 0.75) {
            counterContainer.classList.add('warning');
        }
        
        updatePreview();
    }
    
    // Preview
    function updatePreview() {
        const title = document.getElementById('Title')?.value || '';
        const comment = document.getElementById('commentText').value;
        const preview = document.getElementById('previewBox');
        
        if (selectedRating > 0 || title || comment) {
            let html = '';
            
            if (selectedRating > 0) {
                html += '<div class="mb-3">';
                for (let i = 0; i < 5; i++) {
                    html += i < selectedRating ? 
                        '<i class="feather-star text-warning"></i> ' : 
                        '<i class="feather-star text-muted"></i> ';
                }
                html += '</div>';
            }
            
            if (title) {
                html += `<h6 class="fw-bold mb-2">${title}</h6>`;
            }
            
            if (comment) {
                html += `<p class="small text-muted mb-0">${comment}</p>`;
            }
            
            preview.innerHTML = html;
        } else {
            preview.innerHTML = '<p class="text-center text-muted small mb-0"><i class="feather-star fs-3 mb-2 d-block"></i>@Html.T("Ø§Ø®ØªØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙˆØ§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ", "Select rating and write your comment")</p>';
        }
    }
    
    // Form validation
    document.getElementById('reviewForm').addEventListener('submit', function(e) {
        const rating = parseInt(document.getElementById('ratingValue').value);
        const comment = document.getElementById('commentText').value.trim();
        
        if (rating === 0) {
            e.preventDefault();
            alert('@Html.Raw(Html.T("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØªÙ‚ÙŠÙŠÙ… Ù…Ù† Ø§Ù„Ù†Ø¬ÙˆÙ…", "Please select a star rating").Replace("'", "\\'"))');
            return false;
        }
        
        if (comment.length < 10) {
            e.preventDefault();
            alert('@Html.Raw(Html.T("ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ 10 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„", "Comment must be at least 10 characters").Replace("'", "\\'"))');
            return false;
        }
        
        const minExtremeRatingComment = @reviewMinCommentForExtremeRating;
        if ((rating === 1 || rating === 5) && comment.length < minExtremeRatingComment) {
            e.preventDefault();
            alert('@Html.Raw(Html.T("Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ØªØ·Ø±Ù (1 Ø£Ùˆ 5 Ù†Ø¬ÙˆÙ…) ÙŠØªØ·Ù„Ø¨ ØªØ¹Ù„ÙŠÙ‚ ØªÙØµÙŠÙ„ÙŠ", "Extreme rating (1 or 5 stars) requires a detailed comment").Replace("'", "\\'"))' + ' (' + minExtremeRatingComment + ' ' + '@Html.Raw(Html.T("Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„", "characters minimum").Replace("'", "\\'"))' + ')');
            return false;
        }
        
        return true;
    });
    
    // Listen to title changes
    document.getElementById('Title')?.addEventListener('input', updatePreview);
</script>
}
