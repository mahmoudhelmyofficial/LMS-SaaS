@model AchievementsViewModel
@{
    ViewData["Title"] = Html.T("Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª", "Achievements");
}

@section Styles {
<style>
    .achievement-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 16px;
        padding: 40px;
        text-align: center;
        margin-bottom: 24px;
    }
    .badge-item {
        background: white;
        border-radius: 12px;
        padding: 20px;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        transition: transform 0.3s ease;
    }
    .badge-item:hover {
        transform: translateY(-5px);
    }
    .badge-icon {
        font-size: 64px;
        margin-bottom: 12px;
    }
    .milestone-card {
        background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 16px;
    }
</style>
}

<!-- Alert Messages -->
@await Html.PartialAsync("_AlertMessage")

<!-- Achievement Header -->
<div class="achievement-header">
    <div class="mb-4" style="font-size: 80px;">ğŸ†</div>
    <h2 class="text-white mb-2">@Model.User.FullName</h2>
    <p class="mb-3 opacity-75">@Html.T("Ø§Ù„Ù…Ø³ØªÙˆÙ‰", "Level") @Model.Stats.Level â€¢ @Model.Stats.TotalPoints @Html.T("Ù†Ù‚Ø·Ø©", "points")</p>
    <div class="d-flex justify-content-center gap-4 mt-4">
        <div>
            <h3 class="text-white mb-1">@Model.Badges.Count</h3>
            <p class="mb-0 opacity-75">@Html.T("Ø´Ø§Ø±Ø©", "Badge")</p>
        </div>
        <div>
            <h3 class="text-white mb-1">@Model.Certificates.Count</h3>
            <p class="mb-0 opacity-75">@Html.T("Ø´Ù‡Ø§Ø¯Ø©", "Certificate")</p>
        </div>
        <div>
            <h3 class="text-white mb-1">@Model.Stats.CompletedCourses</h3>
            <p class="mb-0 opacity-75">@Html.T("Ø¯ÙˆØ±Ø© Ù…ÙƒØªÙ…Ù„Ø©", "Completed course")</p>
        </div>
    </div>
</div>

<!-- Stats Overview -->
<div class="row g-4 mb-4">
    <div class="col-12 col-sm-6 col-lg-3">
        <div class="card stretch stretch-full">
            <div class="card-body text-center">
                <div style="font-size: 48px; margin-bottom: 12px;">ğŸ“š</div>
                <h3 class="fw-bold mb-1">@Model.Stats.TotalEnrolledCourses</h3>
                <p class="text-muted mb-0">@Html.T("Ø¯ÙˆØ±Ø© Ù…Ø³Ø¬Ù„Ø©", "Enrolled course")</p>
            </div>
        </div>
    </div>
    <div class="col-12 col-sm-6 col-lg-3">
        <div class="card stretch stretch-full">
            <div class="card-body text-center">
                <div style="font-size: 48px; margin-bottom: 12px;">â±ï¸</div>
                <h3 class="fw-bold mb-1">@((Model.Stats.TotalStudyMinutes / 60).ToString("F0"))</h3>
                <p class="text-muted mb-0">@Html.T("Ø³Ø§Ø¹Ø© ØªØ¹Ù„Ù…", "Study hours")</p>
            </div>
        </div>
    </div>
    <div class="col-12 col-sm-6 col-lg-3">
        <div class="card stretch stretch-full">
            <div class="card-body text-center">
                <div style="font-size: 48px; margin-bottom: 12px;">ğŸ”¥</div>
                <h3 class="fw-bold mb-1">@Model.Stats.CurrentStreak</h3>
                <p class="text-muted mb-0">@Html.T("Ø£ÙŠØ§Ù… Ù…ØªÙˆØ§ØµÙ„Ø©", "Consecutive days")</p>
            </div>
        </div>
    </div>
    <div class="col-12 col-sm-6 col-lg-3">
        <div class="card stretch stretch-full">
            <div class="card-body text-center">
                <div style="font-size: 48px; margin-bottom: 12px;">â­</div>
                <h3 class="fw-bold mb-1">@Model.Stats.LongestStreak</h3>
                <p class="text-muted mb-0">@Html.T("Ø£Ø·ÙˆÙ„ Ø³Ù„Ø³Ù„Ø©", "Longest streak")</p>
            </div>
        </div>
    </div>
</div>

<!-- Badges -->
<div class="card stretch stretch-full mb-4">
    <div class="card-body">
        <h5 class="fw-bold mb-4">
            <i class="feather-award text-warning me-2"></i>
            @Html.T("Ø§Ù„Ø´Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø­ØµÙ„Ø©", "Badges Earned") (@Model.Badges.Count)
        </h5>
        
        @if (Model.Badges.Any())
        {
            <div class="row g-3">
                @foreach (var userBadge in Model.Badges)
                {
                    <div class="col-6 col-sm-4 col-md-3 col-lg-2">
                        <div class="badge-item">
                            <div class="badge-icon">@userBadge.Badge.Icon</div>
                            <h6 class="fw-bold mb-1">@userBadge.Badge.Name</h6>
                            <p class="text-muted small mb-2">@userBadge.Badge.Description</p>
                            <small class="text-muted">@userBadge.AwardedAt.ToString("yyyy/MM/dd")</small>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            ViewData["Icon"] = "award";
            ViewData["Title"] = Html.T("Ù„Ù… ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø´Ø§Ø±Ø§Øª Ø¨Ø¹Ø¯", "No badges yet");
            ViewData["Message"] = Html.T("Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„ØªØ¹Ù„Ù… Ù„ÙƒØ³Ø¨ Ø§Ù„Ø´Ø§Ø±Ø§Øª", "Keep learning to earn badges");
            @await Html.PartialAsync("_EmptyState")
        }
    </div>
</div>

<!-- Certificates -->
<div class="card stretch stretch-full mb-4">
    <div class="card-body">
        <h5 class="fw-bold mb-4">
            <i class="feather-file-text text-success me-2"></i>
            @Html.T("Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª", "Certificates") (@Model.Certificates.Count)
        </h5>
        
        @if (Model.Certificates.Any())
        {
            <div class="row g-3">
                @foreach (var certificate in Model.Certificates.Take(6))
                {
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex align-items-start">
                                    <div class="avatar-text avatar-lg bg-soft-success text-success me-3">
                                        <i class="feather-award"></i>
                                    </div>
                                    <div class="flex-grow-1">
                                        <h6 class="fw-bold mb-1">@certificate.Course.Title</h6>
                                        <p class="text-muted small mb-2">@Html.T("Ø±Ù‚Ù… Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©:", "Certificate No.:") @certificate.CertificateNumber</p>
                                        <small class="text-muted">@Html.T("ØµØ¯Ø±Øª ÙÙŠ:", "Issued:") @(certificate.IssuedDate?.ToString("yyyy/MM/dd") ?? "-")</small>
                                    </div>
                                    <a asp-controller="Certificates" asp-action="Details" asp-route-id="@certificate.Id" 
                                       class="btn btn-sm btn-success" title="@Html.T("Ø¹Ø±Ø¶", "View")">
                                        <i class="feather-eye"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
            
            @if (Model.Certificates.Count > 6)
            {
                <div class="text-center mt-3">
                    <a asp-controller="Certificates" asp-action="Index" class="btn btn-outline-primary">
                        @Html.T("Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª", "View all certificates") (@Model.Certificates.Count)
                    </a>
                </div>
            }
        }
        else
        {
            ViewData["Icon"] = "file-text";
            ViewData["Title"] = Html.T("Ù„Ù… ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø´Ù‡Ø§Ø¯Ø§Øª Ø¨Ø¹Ø¯", "No certificates yet");
            ViewData["Message"] = Html.T("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª", "Complete courses to earn certificates");
            @await Html.PartialAsync("_EmptyState")
        }
    </div>
</div>

<!-- Milestones -->
<div class="card stretch stretch-full">
    <div class="card-body">
        <h5 class="fw-bold mb-4">
            <i class="feather-target text-info me-2"></i>
            @Html.T("Ø§Ù„Ù…Ø±Ø§Ø­Ù„ Ø§Ù„Ù…Ø­Ù‚Ù‚Ø©", "Achieved Milestones")
        </h5>
        
        @if (Model.Milestones.Any())
        {
            <div class="row g-3">
                @foreach (var milestone in Model.Milestones)
                {
                    <div class="col-12 col-md-6">
                        <div class="milestone-card">
                            <div class="d-flex align-items-center flex-wrap">
                                <div style="font-size: 48px; margin-left: 16px;">@milestone.Icon</div>
                                <div>
                                    <h6 class="fw-bold mb-1">@milestone.Title</h6>
                                    <span class="badge @(milestone.Achieved ? "bg-success" : "bg-secondary")">
                                        @(milestone.Achieved ? Html.T("Ù…Ø­Ù‚Ù‚ âœ“", "Achieved âœ“") : Html.T("Ù…ØºÙ„Ù‚ ğŸ”’", "Locked ğŸ”’"))
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
    </div>
</div>
