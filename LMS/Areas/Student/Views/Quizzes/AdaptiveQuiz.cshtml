@model AdaptiveQuizViewModel
@{
    ViewData["Title"] = Html.T("Ø§Ø®ØªØ¨Ø§Ø± ØªÙƒÙŠÙÙŠ", "Adaptive Quiz");
}

@section Styles {
<style>
    .adaptive-header {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
        border-radius: 16px;
        padding: 32px;
        text-align: center;
        margin-bottom: 24px;
    }
    .difficulty-badge {
        display: inline-block;
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: bold;
        margin-bottom: 24px;
    }
    .difficulty-easy { background: #d1fae5; color: #065f46; }
    .difficulty-medium { background: #fef3c7; color: #92400e; }
    .difficulty-hard { background: #fee2e2; color: #991b1b; }
</style>
}

<!-- Alert Messages -->
@await Html.PartialAsync("_AlertMessage")

<!-- Adaptive Header -->
<div class="adaptive-header">
    <div style="font-size: 48px; margin-bottom: 12px;">ğŸ¯</div>
    <h2 class="text-white mb-2">@Html.T("Ø§Ø®ØªØ¨Ø§Ø± ØªÙƒÙŠÙÙŠ Ø°ÙƒÙŠ", "Smart adaptive quiz")</h2>
    <p class="mb-0 opacity-75">@Html.T("ÙŠØªÙƒÙŠÙ Ù…Ø¹ Ù…Ø³ØªÙˆÙ‰ Ø£Ø¯Ø§Ø¦Ùƒ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹", "Adapts to your performance level automatically")</p>
</div>

<!-- Current Stats -->
<div class="row g-4 mb-4">
    <div class="col-md-3">
        <div class="card">
            <div class="card-body text-center">
                <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“Š</div>
                <h4 class="fw-bold mb-1">@Model.QuestionsAnswered / @Model.TotalQuestions</h4>
                <small class="text-muted">@Html.T("Ø§Ù„Ø£Ø³Ø¦Ù„Ø©", "Questions")</small>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card">
            <div class="card-body text-center">
                <div style="font-size: 32px; margin-bottom: 8px;">â­</div>
                <h4 class="fw-bold mb-1">@Model.CurrentScore%</h4>
                <small class="text-muted">@Html.T("Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©", "Current score")</small>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card">
            <div class="card-body text-center">
                <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“ˆ</div>
                <h4 class="fw-bold mb-1">
                    @switch (Model.CurrentDifficulty)
                    {
                        case "Easy": @Html.T("Ø³Ù‡Ù„", "Easy"); break;
                        case "Medium": @Html.T("Ù…ØªÙˆØ³Ø·", "Medium"); break;
                        case "Hard": @Html.T("ØµØ¹Ø¨", "Hard"); break;
                    }
                </h4>
                <small class="text-muted">@Html.T("Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ", "Current level")</small>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card">
            <div class="card-body text-center">
                <div style="font-size: 32px; margin-bottom: 8px;">ğŸ”¥</div>
                <h4 class="fw-bold mb-1">@Model.CorrectStreak</h4>
                <small class="text-muted">@Html.T("Ø³Ù„Ø³Ù„Ø© ØµØ­ÙŠØ­Ø©", "Correct streak")</small>
            </div>
        </div>
    </div>
</div>

<!-- Question Card -->
<div class="card stretch stretch-full mb-4">
    <div class="card-body">
        <!-- Difficulty Indicator -->
        <div class="text-center mb-4">
            <span class="difficulty-badge difficulty-@Model.CurrentDifficulty.ToLower()">
                @switch (Model.CurrentDifficulty)
                {
                    case "Easy": @Html.T("Ù…Ø³ØªÙˆÙ‰ Ø³Ù‡Ù„", "Easy level"); break;
                    case "Medium": @Html.T("Ù…Ø³ØªÙˆÙ‰ Ù…ØªÙˆØ³Ø·", "Medium level"); break;
                    case "Hard": @Html.T("Ù…Ø³ØªÙˆÙ‰ ØµØ¹Ø¨", "Hard level"); break;
                }
            </span>
        </div>

        <h5 class="fw-bold mb-4">@Model.CurrentQuestion.QuestionText</h5>

        @if (!string.IsNullOrEmpty(Model.CurrentQuestion.ImageUrl))
        {
            <div class="mb-4">
                <img src="@Model.CurrentQuestion.ImageUrl" alt="@Html.T("ØµÙˆØ±Ø© Ø§Ù„Ø³Ø¤Ø§Ù„", "Question image")" 
                     class="img-fluid rounded" style="max-height: 300px;" />
            </div>
        }

        <form asp-action="AdaptiveQuiz" method="post">
            <input type="hidden" name="quizId" value="@Model.QuizId" />
            <input type="hidden" name="questionId" value="@Model.CurrentQuestion.Id" />
            <input type="hidden" name="questionsAnswered" value="@Model.QuestionsAnswered" />

            @foreach (var answer in Model.CurrentQuestion.Answers)
            {
                <div class="form-check mb-3 p-3 rounded" style="background: #f9fafb; border: 2px solid #e5e7eb;">
                    <input class="form-check-input" type="radio" name="selectedAnswerId" 
                           value="@answer.Id" id="answer_@answer.Id">
                    <label class="form-check-label flex-grow-1" for="answer_@answer.Id" style="cursor: pointer;">
                        @answer.AnswerText
                    </label>
                </div>
            }

            <div class="d-flex justify-content-between mt-4">
                <a asp-action="Index" class="btn btn-outline-secondary">
                    <i class="feather-x me-2"></i>
                    @Html.T("Ø¥Ù†Ù‡Ø§Ø¡", "End")
                </a>
                <button type="submit" class="btn btn-primary">
                    @Html.T("Ø§Ù„ØªØ§Ù„ÙŠ", "Next")
                    <i class="feather-arrow-left ms-2"></i>
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Adaptive Info -->
<div class="card stretch stretch-full">
    <div class="card-body">
        <h6 class="fw-bold mb-3">
            <i class="feather-info text-info me-2"></i>
            @Html.T("ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙƒÙŠÙÙŠØŸ", "How does the adaptive quiz work?")
        </h6>
        <ul class="mb-0">
            <li>@Html.T("ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø£Ø³Ø¦Ù„Ø© Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ø³ØªÙˆÙ‰", "The quiz starts with medium-level questions")</li>
            <li>@Html.T("Ø¥Ø°Ø§ Ø£Ø¬Ø¨Øª Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ØŒ ØªØµØ¨Ø­ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø£ØµØ¹Ø¨", "If you answer correctly, questions get harder")</li>
            <li>@Html.T("Ø¥Ø°Ø§ Ø£Ø¬Ø¨Øª Ø¨Ø´ÙƒÙ„ Ø®Ø§Ø·Ø¦ØŒ ØªØµØ¨Ø­ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø£Ø³Ù‡Ù„", "If you answer incorrectly, questions get easier")</li>
            <li>@Html.T("ÙŠÙˆÙØ± Ù„Ùƒ ØªÙ‚ÙŠÙŠÙ…Ø§Ù‹ Ø¯Ù‚ÙŠÙ‚Ø§Ù‹ Ù„Ù…Ø³ØªÙˆØ§Ùƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ", "Gives you an accurate assessment of your real level")</li>
        </ul>
    </div>
</div>
