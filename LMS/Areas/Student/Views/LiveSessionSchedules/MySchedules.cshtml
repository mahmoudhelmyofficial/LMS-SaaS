@model List<LMS.Areas.Student.ViewModels.AvailableScheduleViewModel>
@{
    ViewData["Title"] = Html.T("جداولي", "My Schedules");
}

<!-- Alert Messages -->
@await Html.PartialAsync("_AlertMessage")

<!-- Header -->
<div class="card stretch stretch-full mb-4">
    <div class="card-body">
        <div class="d-flex align-items-center justify-content-between flex-wrap gap-3">
            <div>
                <h3 class="fw-bold mb-2">
                    <i class="feather-bookmark text-primary me-2"></i>
                    @Html.T("جداولي", "My Schedules")
                </h3>
                <p class="text-muted mb-0">@Html.T("جداول الحصص المشترك بها", "Session schedules you are subscribed to")</p>
            </div>
            <a asp-action="Index" class="btn btn-outline-primary">
                <i class="feather-search me-2"></i>
                @Html.T("تصفح الجداول", "Browse Schedules")
            </a>
        </div>
    </div>
</div>

<!-- Schedules -->
<div class="row g-4">
    @if (Model != null && Model.Any())
    {
        @foreach (var schedule in Model)
        {
            <div class="col-lg-4 col-md-6">
                <div class="card stretch stretch-full">
                    <div class="card-body">
                        <div class="d-flex align-items-center gap-3 mb-3">
                            <div class="avatar-text avatar-lg bg-soft-primary text-primary">
                                <i class="feather-calendar"></i>
                            </div>
                            <div>
                                <h5 class="fw-bold mb-1">@schedule.Title</h5>
                                <small class="text-muted">@schedule.InstructorName</small>
                            </div>
                        </div>

                        @if (!string.IsNullOrEmpty(schedule.Description))
                        {
                            <p class="text-muted small mb-3" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                @schedule.Description
                            </p>
                        }

                        <div class="d-flex align-items-center gap-3 mb-3 fs-12 text-muted">
                            <span>
                                <i class="feather-layers me-1"></i>
                                @schedule.TotalSessions @Html.T("جلسة", "session(s)")
                            </span>
                            <span>
                                <i class="feather-calendar me-1"></i>
                                @schedule.StartDate.ToString("dd/MM") - @schedule.EndDate.ToString("dd/MM")
                            </span>
                        </div>

                        @{
                            var statusBadge = schedule.Status switch
                            {
                                LMS.Domain.Enums.LiveScheduleStatus.Active => ("bg-success", Html.T("نشط", "Active")),
                                LMS.Domain.Enums.LiveScheduleStatus.Completed => ("bg-secondary", Html.T("مكتمل", "Completed")),
                                _ => ("bg-primary", Html.T("منشور", "Published"))
                            };
                        }
                        <span class="badge @statusBadge.Item1 mb-3">@statusBadge.Item2</span>

                        <a asp-action="Details" asp-route-id="@schedule.Id" class="btn btn-primary w-100">
                            <i class="feather-eye me-2"></i>
                            @Html.T("عرض الجلسات", "View Sessions")
                        </a>
                    </div>
                </div>
            </div>
        }
    }
    else
    {
        <div class="col-12">
            <div class="card stretch stretch-full">
                <div class="card-body text-center py-5">
                    <i class="feather-bookmark" style="font-size: 64px; color: #ddd;"></i>
                    <h5 class="mt-3 text-muted">@Html.T("لم تشترك في أي جدول حصص بعد", "You haven't subscribed to any schedule yet")</h5>
                    <p class="text-muted">@Html.T("تصفح الجداول المتاحة واشترك في جدول يناسبك", "Browse available schedules and subscribe to one that suits you")</p>
                    <a asp-action="Index" class="btn btn-primary mt-2">
                        <i class="feather-search me-2"></i>
                        @Html.T("تصفح الجداول", "Browse Schedules")
                    </a>
                </div>
            </div>
        </div>
    }
</div>
