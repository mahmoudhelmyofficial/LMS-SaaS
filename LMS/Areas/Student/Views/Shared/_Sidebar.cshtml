@using LMS.Services.Interfaces
@inject IPlatformSettingsService PlatformSettings

@{
    var platformName = "WEBUILDER";
    var platformLogo = "/logo.png";
    var enableInstructorApplication = false;
    
    try
    {
        platformName = await PlatformSettings.GetPlatformNameAsync() ?? "WEBUILDER";
        platformLogo = await PlatformSettings.GetPlatformLogoAsync() ?? "/logo.png";
        enableInstructorApplication = await PlatformSettings.GetBoolSettingAsync("EnableInstructorApplication", true);
    }
    catch
    {
        // Use default values on error
    }
    
    // Get current controller and action for active state
    var currentController = ViewContext.RouteData.Values["controller"]?.ToString() ?? "";
    var currentAction = ViewContext.RouteData.Values["action"]?.ToString() ?? "";
    var tabVal = ViewContext.HttpContext.Request.Query["tab"].ToString();
    var allowedSettingsTabs = new[] { "account", "notifications", "privacy", "security" };
    var settingsTab = allowedSettingsTabs.Contains(tabVal) ? tabVal : "account";
}

<nav class="nxl-navigation" id="main-sidebar">
    <div class="navbar-wrapper">
        <div class="m-header">
            <a asp-area="Student" asp-controller="Dashboard" asp-action="Index" class="b-brand">
                <img src="@Url.Content(string.IsNullOrEmpty(platformLogo) ? "~/logo.png" : "~" + platformLogo)" alt="@platformName" class="logo logo-lg" style="max-height: 80px;" onerror="this.src='@Url.Content("~/logo.png")'" />
                <img src="@Url.Content(string.IsNullOrEmpty(platformLogo) ? "~/logo.png" : "~" + platformLogo)" alt="@platformName" class="logo logo-sm" style="max-height: 60px;" onerror="this.src='@Url.Content("~/logo.png")'" />
            </a>
            <button type="button" class="sidebar-close-btn d-xl-none" id="sidebar-close-btn" aria-label="@Html.T("إغلاق القائمة", "Close Menu")">
                <i class="feather-x"></i>
            </button>
        </div>
        <div class="navbar-content">
            <ul class="nxl-navbar">
                <!-- Main Section: لوحة التحكم, الدورات, البث المباشر, الكتب, الواجبات, الاختبارات, مسارات التعلم, ادوات الدراسة -->
                <li class="nxl-item nxl-caption">
                    <label>@Html.T("الرئيسية", "Main")</label>
                </li>
                
                <li class="nxl-item @(currentController == "Dashboard" ? "active" : "")">
                    <a asp-area="Student" asp-controller="Dashboard" asp-action="Index" class="nxl-link" data-tooltip="@Html.T("لوحة التحكم", "Dashboard")">
                        <span class="nxl-micon"><i class="feather-home"></i></span>
                        <span class="nxl-mtext">@Html.T("لوحة التحكم", "Dashboard")</span>
                    </a>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "Courses" || currentController == "Learning" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("الدورات", "Courses")">
                        <span class="nxl-micon"><i class="feather-book-open"></i></span>
                        <span class="nxl-mtext">@Html.T("الدورات", "Courses")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Courses" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Courses" asp-action="Index" class="nxl-link">
                                <i class="feather-list me-2"></i>
                                @Html.T("الدورات المسجلة", "Enrolled Courses")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Courses" && currentAction == "InProgress" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Courses" asp-action="InProgress" class="nxl-link">
                                <i class="feather-play-circle me-2"></i>
                                @Html.T("قيد الدراسة", "In Progress")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Courses" && currentAction == "Completed" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Courses" asp-action="Completed" class="nxl-link">
                                <i class="feather-check-circle me-2"></i>
                                @Html.T("الدورات المكتملة", "Completed Courses")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Courses" && currentAction == "Recommendations" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Courses" asp-action="Recommendations" class="nxl-link">
                                <i class="feather-star me-2"></i>
                                @Html.T("توصيات لك", "Recommended for You")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Courses" && currentAction == "Browse" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Courses" asp-action="Browse" class="nxl-link">
                                <i class="feather-search me-2"></i>
                                @Html.T("تصفح الدورات", "Browse Courses")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "LiveClasses" || currentController == "LiveClassAttendance" || currentController == "LiveSessionSchedules" || currentController == "SessionCheckout" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("البث المباشر", "Live Sessions")">
                        <span class="nxl-micon"><i class="feather-video"></i></span>
                        <span class="nxl-mtext">@Html.T("البث المباشر", "Live Sessions")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "LiveClasses" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Student" asp-controller="LiveClasses" asp-action="Index" class="nxl-link">
                                <i class="feather-video me-2"></i>
                                @Html.T("جميع الجلسات", "All Sessions")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "LiveSessionSchedules" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Student" asp-controller="LiveSessionSchedules" asp-action="Index" class="nxl-link">
                                <i class="feather-calendar me-2"></i>
                                @Html.T("جداول الحصص", "Session Schedules")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "LiveSessionSchedules" && currentAction == "MySchedules" ? "active" : "")">
                            <a asp-area="Student" asp-controller="LiveSessionSchedules" asp-action="MySchedules" class="nxl-link">
                                <i class="feather-bookmark me-2"></i>
                                @Html.T("جداولي", "My Schedules")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "LiveClasses" && currentAction == "Recordings" ? "active" : "")">
                            <a asp-area="Student" asp-controller="LiveClasses" asp-action="Recordings" class="nxl-link">
                                <i class="feather-play-circle me-2"></i>
                                @Html.T("التسجيلات", "Recordings")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "LiveClassAttendance" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Student" asp-controller="LiveClassAttendance" asp-action="Index" class="nxl-link">
                                <i class="feather-check-square me-2"></i>
                                @Html.T("سجل الحضور", "Attendance History")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "Books" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("الكتب", "Books")">
                        <span class="nxl-micon"><i class="feather-book"></i></span>
                        <span class="nxl-mtext">@Html.T("الكتب", "Books")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Books" && currentAction == "MyLibrary" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Books" asp-action="MyLibrary" class="nxl-link">
                                <i class="feather-archive me-2"></i>
                                @Html.T("مكتبتي", "My Library")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Books" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Books" asp-action="Index" class="nxl-link">
                                <i class="feather-search me-2"></i>
                                @Html.T("تصفح الكتب", "Browse Books")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "Assignments" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("الواجبات", "Assignments")">
                        <span class="nxl-micon"><i class="feather-edit"></i></span>
                        <span class="nxl-mtext">@Html.T("الواجبات", "Assignments")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Assignments" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Assignments" asp-action="Index" class="nxl-link">
                                <i class="feather-file-text me-2"></i>
                                @Html.T("جميع الواجبات", "All Assignments")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Assignments" && currentAction == "Pending" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Assignments" asp-action="Pending" class="nxl-link">
                                <i class="feather-clock me-2"></i>
                                @Html.T("واجبات معلقة", "Pending Assignments")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "Quizzes" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("الاختبارات", "Quizzes")">
                        <span class="nxl-micon"><i class="feather-help-circle"></i></span>
                        <span class="nxl-mtext">@Html.T("الاختبارات", "Quizzes")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Quizzes" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Quizzes" asp-action="Index" class="nxl-link">
                                <i class="feather-list me-2"></i>
                                @Html.T("جميع الاختبارات", "All Quizzes")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Quizzes" && currentAction == "Results" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Quizzes" asp-action="Results" class="nxl-link">
                                <i class="feather-bar-chart-2 me-2"></i>
                                @Html.T("نتائجي", "My Results")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Quizzes" && currentAction == "Leaderboard" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Quizzes" asp-action="Leaderboard" class="nxl-link">
                                <i class="feather-award me-2"></i>
                                @Html.T("لوحة المتصدرين", "Leaderboard")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <li class="nxl-item @(currentController == "LearningPaths" ? "active" : "")">
                    <a asp-area="Student" asp-controller="LearningPaths" asp-action="Index" class="nxl-link" data-tooltip="@Html.T("مسارات التعلم", "Learning Paths")">
                        <span class="nxl-micon"><i class="feather-git-branch"></i></span>
                        <span class="nxl-mtext">@Html.T("مسارات التعلم", "Learning Paths")</span>
                    </a>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "StudyPlanner" || currentController == "LearningGoals" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("ادوات الدراسة", "Study Tools")">
                        <span class="nxl-micon"><i class="feather-target"></i></span>
                        <span class="nxl-mtext">@Html.T("ادوات الدراسة", "Study Tools")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "StudyPlanner" ? "active" : "")">
                            <a asp-area="Student" asp-controller="StudyPlanner" asp-action="Index" class="nxl-link">
                                <i class="feather-calendar me-2"></i>
                                @Html.T("المخطط الدراسي", "Study Planner")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "LearningGoals" ? "active" : "")">
                            <a asp-area="Student" asp-controller="LearningGoals" asp-action="Index" class="nxl-link">
                                <i class="feather-target me-2"></i>
                                @Html.T("أهداف التعلم", "Learning Goals")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Reminders" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Reminders" asp-action="Index" class="nxl-link">
                                <i class="feather-bell me-2"></i>
                                @Html.T("التذكيرات", "Reminders")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <!-- Section: التسوق, الملاحظات, التقويم, الشهادات, الرسائل, المجتمع, الانجازات -->
                <li class="nxl-item nxl-caption">
                    <label>@Html.T("التسوق والتواصل", "Shopping & Communication")</label>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "Checkout" || currentController == "Wishlist" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("التسوق", "Shopping")">
                        <span class="nxl-micon"><i class="feather-shopping-cart"></i></span>
                        <span class="nxl-mtext">@Html.T("التسوق", "Shopping")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Checkout" && currentAction == "Cart" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Checkout" asp-action="Cart" class="nxl-link">
                                <i class="feather-shopping-cart me-2"></i>
                                @Html.T("سلة التسوق", "Shopping Cart")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Wishlist" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Wishlist" asp-action="Index" class="nxl-link">
                                <i class="feather-heart me-2"></i>
                                @Html.T("قائمة الرغبات", "Wishlist")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "Notes" || currentController == "Bookmarks" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("الملاحظات والمحفوظات", "Notes & Bookmarks")">
                        <span class="nxl-micon"><i class="feather-edit-3"></i></span>
                        <span class="nxl-mtext">@Html.T("الملاحظات والمحفوظات", "Notes & Bookmarks")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Notes" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Notes" asp-action="Index" class="nxl-link">
                                <i class="feather-edit-3 me-2"></i>
                                @Html.T("ملاحظاتي", "My Notes")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Bookmarks" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Bookmarks" asp-action="Index" class="nxl-link">
                                <i class="feather-bookmark me-2"></i>
                                @Html.T("المحفوظات", "Bookmarks")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <li class="nxl-item @(currentController == "Calendar" ? "active" : "")">
                    <a asp-area="Student" asp-controller="Calendar" asp-action="Index" class="nxl-link" data-tooltip="@Html.T("التقويم", "Calendar")">
                        <span class="nxl-micon"><i class="feather-calendar"></i></span>
                        <span class="nxl-mtext">@Html.T("التقويم", "Calendar")</span>
                    </a>
                </li>
                
                <li class="nxl-item @(currentController == "Announcements" ? "active" : "")">
                    <a href="/Student/Announcements" class="nxl-link" data-tooltip="@Html.T("الإعلانات", "Announcements")">
                        <span class="nxl-micon"><i class="feather-bell"></i></span>
                        <span class="nxl-mtext">@Html.T("الإعلانات", "Announcements")</span>
                    </a>
                </li>
                
                <li class="nxl-item @(currentController == "Certificates" ? "active" : "")">
                    <a asp-area="Student" asp-controller="Certificates" asp-action="Index" class="nxl-link" data-tooltip="@Html.T("الشهادات", "Certificates")">
                        <span class="nxl-micon"><i class="feather-file-text"></i></span>
                        <span class="nxl-mtext">@Html.T("الشهادات", "Certificates")</span>
                    </a>
                </li>
                
                <li class="nxl-item @(currentController == "Messages" ? "active" : "")">
                    <a asp-area="Student" asp-controller="Messages" asp-action="Index" class="nxl-link" data-tooltip="@Html.T("الرسائل", "Messages")">
                        <span class="nxl-micon"><i class="feather-mail"></i></span>
                        <span class="nxl-mtext">@Html.T("الرسائل", "Messages")</span>
                        <span class="nxl-badge" id="unread-messages-badge"></span>
                    </a>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "StudyGroups" || currentController == "Forums" || currentController == "Discussions" || currentController == "Reviews" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("المجتمع", "Community")">
                        <span class="nxl-micon"><i class="feather-users"></i></span>
                        <span class="nxl-mtext">@Html.T("المجتمع", "Community")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "StudyGroups" ? "active" : "")">
                            <a asp-area="Student" asp-controller="StudyGroups" asp-action="Index" class="nxl-link">
                                <i class="feather-users me-2"></i>
                                @Html.T("مجموعات الدراسة", "Study Groups")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Forums" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Forums" asp-action="Index" class="nxl-link">
                                <i class="feather-message-square me-2"></i>
                                @Html.T("المنتديات", "Forums")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Discussions" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Discussions" asp-action="Index" class="nxl-link">
                                <i class="feather-message-circle me-2"></i>
                                @Html.T("المناقشات", "Discussions")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Reviews" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Reviews" asp-action="Index" class="nxl-link">
                                <i class="feather-star me-2"></i>
                                @Html.T("تقييماتي", "My Reviews")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "Achievements" || currentController == "Gamification" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("الانجازات", "Achievements")">
                        <span class="nxl-micon"><i class="feather-award"></i></span>
                        <span class="nxl-mtext">@Html.T("الانجازات", "Achievements")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Achievements" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Achievements" asp-action="Index" class="nxl-link">
                                <i class="feather-star me-2"></i>
                                @Html.T("الشارات والجوائز", "Badges & Awards")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Achievements" && currentAction == "Points" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Achievements" asp-action="Points" class="nxl-link">
                                <i class="feather-zap me-2"></i>
                                @Html.T("النقاط", "Points")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <!-- Section: التقدم والتحليل, الفواتير والاشتراكات, الملف الشخصي, الاعدادات, الاشعارات, الدعم الفني, مركز المساعدة -->
                <li class="nxl-item nxl-caption">
                    <label>@Html.T("التقدم والتحليل والدعم", "Progress, Analytics & Support")</label>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "Progress" || currentController == "LearningEnhancements" || currentController == "Activity" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("التقدم والتحليل", "Progress & Analytics")">
                        <span class="nxl-micon"><i class="feather-trending-up"></i></span>
                        <span class="nxl-mtext">@Html.T("التقدم والتحليل", "Progress & Analytics")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Progress" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Progress" asp-action="Index" class="nxl-link">
                                <i class="feather-activity me-2"></i>
                                @Html.T("نظرة عامة", "Overview")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "AdaptiveLearning" && currentAction == "MyAnalytics" ? "active" : "")">
                            <a asp-area="Student" asp-controller="AdaptiveLearning" asp-action="MyAnalytics" class="nxl-link">
                                <i class="feather-pie-chart me-2"></i>
                                @Html.T("تحليلات التعلم", "Learning Analytics")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Activity" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Activity" asp-action="Index" class="nxl-link">
                                <i class="feather-clock me-2"></i>
                                @Html.T("سجل النشاط", "Activity Log")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "Purchases" || currentController == "Invoices" || currentController == "Subscriptions" || currentController == "Refunds" || currentController == "PaymentMethods" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("الفواتير والاشتراكات", "Billing & Subscriptions")">
                        <span class="nxl-micon"><i class="feather-credit-card"></i></span>
                        <span class="nxl-mtext">@Html.T("الفواتير والاشتراكات", "Billing & Subscriptions")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Purchases" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Purchases" asp-action="History" class="nxl-link">
                                <i class="feather-file-text me-2"></i>
                                @Html.T("سجل المشتريات", "Purchase History")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Invoices" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Invoices" asp-action="Index" class="nxl-link">
                                <i class="feather-file me-2"></i>
                                @Html.T("الفواتير", "Invoices")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Subscriptions" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Subscriptions" asp-action="Index" class="nxl-link">
                                <i class="feather-repeat me-2"></i>
                                @Html.T("الاشتراكات", "Subscriptions")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Refunds" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Refunds" asp-action="Index" class="nxl-link">
                                <i class="feather-rotate-ccw me-2"></i>
                                @Html.T("طلبات الاسترداد", "Refund Requests")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "PaymentMethods" ? "active" : "")">
                            <a asp-area="Student" asp-controller="PaymentMethods" asp-action="Index" class="nxl-link">
                                <i class="feather-credit-card me-2"></i>
                                @Html.T("طرق الدفع", "Payment Methods")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "Profile" || currentController == "InstructorApplication" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("الملف الشخصي", "Profile")">
                        <span class="nxl-micon"><i class="feather-user"></i></span>
                        <span class="nxl-mtext">@Html.T("الملف الشخصي", "Profile")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Profile" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Profile" asp-action="Index" class="nxl-link">
                                <i class="feather-user me-2"></i>
                                @Html.T("عرض الملف", "View Profile")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Profile" && currentAction == "Edit" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Profile" asp-action="Edit" class="nxl-link">
                                <i class="feather-edit me-2"></i>
                                @Html.T("تعديل الملف", "Edit Profile")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Profile" && currentAction == "Portfolio" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Profile" asp-action="Portfolio" class="nxl-link">
                                <i class="feather-briefcase me-2"></i>
                                @Html.T("معرض الأعمال", "Portfolio")
                            </a>
                        </li>
                        @if (enableInstructorApplication)
                        {
                            <li class="nxl-item @(currentController == "InstructorApplication" ? "active" : "")">
                                <a asp-area="Student" asp-controller="InstructorApplication" asp-action="Index" class="nxl-link">
                                    <i class="feather-briefcase me-2"></i>
                                    @Html.T("التقديم كمدرس", "Apply as Instructor")
                                </a>
                            </li>
                        }
                    </ul>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "Settings" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("الاعدادات", "Settings")">
                        <span class="nxl-micon"><i class="feather-settings"></i></span>
                        <span class="nxl-mtext">@Html.T("الاعدادات", "Settings")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Settings" && currentAction == "Index" && settingsTab == "account" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Settings" asp-action="Index" asp-route-tab="account" class="nxl-link">
                                <i class="feather-settings me-2"></i>
                                @Html.T("إعدادات الحساب", "Account Settings")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Settings" && currentAction == "Index" && settingsTab == "notifications" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Settings" asp-action="Index" asp-route-tab="notifications" class="nxl-link">
                                <i class="feather-bell me-2"></i>
                                @Html.T("الإشعارات", "Notifications")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Settings" && currentAction == "Index" && settingsTab == "privacy" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Settings" asp-action="Index" asp-route-tab="privacy" class="nxl-link">
                                <i class="feather-lock me-2"></i>
                                @Html.T("الخصوصية", "Privacy")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Settings" && currentAction == "Index" && settingsTab == "security" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Settings" asp-action="Index" asp-route-tab="security" class="nxl-link">
                                <i class="feather-shield me-2"></i>
                                @Html.T("الأمان", "Security")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <li class="nxl-item @(currentController == "Notifications" ? "active" : "")">
                    <a asp-area="Student" asp-controller="Notifications" asp-action="Index" class="nxl-link" data-tooltip="@Html.T("الاشعارات", "Notifications")">
                        <span class="nxl-micon"><i class="feather-bell"></i></span>
                        <span class="nxl-mtext">@Html.T("الاشعارات", "Notifications")</span>
                        <span class="nxl-badge" id="unread-notifications-badge"></span>
                    </a>
                </li>
                
                <li class="nxl-item nxl-hasmenu @(currentController == "Support" ? "active open" : "")">
                    <a href="javascript:void(0);" class="nxl-link" data-tooltip="@Html.T("الدعم الفني", "Technical Support")">
                        <span class="nxl-micon"><i class="feather-headphones"></i></span>
                        <span class="nxl-mtext">@Html.T("الدعم الفني", "Technical Support")</span>
                        <span class="nxl-arrow"><i class="feather-chevron-left"></i></span>
                    </a>
                    <ul class="nxl-submenu">
                        <li class="nxl-item @(currentController == "Support" && currentAction == "Index" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Support" asp-action="Index" class="nxl-link">
                                <i class="feather-message-circle me-2"></i>
                                @Html.T("تذاكري", "My Tickets")
                            </a>
                        </li>
                        <li class="nxl-item @(currentController == "Support" && currentAction == "Create" ? "active" : "")">
                            <a asp-area="Student" asp-controller="Support" asp-action="Create" class="nxl-link">
                                <i class="feather-plus-circle me-2"></i>
                                @Html.T("تذكرة جديدة", "New Ticket")
                            </a>
                        </li>
                    </ul>
                </li>
                
                <li class="nxl-item @(currentController == "Help" ? "active" : "")">
                    <a asp-area="Student" asp-controller="Help" asp-action="Index" class="nxl-link" data-tooltip="@Html.T("مركز المساعدة", "Help Center")">
                        <span class="nxl-micon"><i class="feather-help-circle"></i></span>
                        <span class="nxl-mtext">@Html.T("مركز المساعدة", "Help Center")</span>
                        <span class="badge bg-soft-primary text-primary ms-2 fs-10">@Html.T("جديد", "New")</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<partial name="~/Areas/Student/Views/Shared/_SidebarScripts.cshtml" />
