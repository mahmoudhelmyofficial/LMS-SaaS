@model LMS.Models.LandingPageViewModel
@{
    ViewData["Title"] = Html.T("الصفحة الرئيسية", "Home");
    Layout = "~/Views/Shared/_LandingLayout.cshtml";
}

<section class="py-5 bg-light">
    <div class="container py-4">
        <div class="text-center">
            <h1 class="display-5 fw-bold mb-3">@Html.T("مرحباً بكم في منصتنا التعليمية", "Welcome to our learning platform")</h1>
            <p class="lead text-muted">@Html.T("دورات وكتب وجلسات مباشرة لتحقيق أهدافك", "Courses, books, and live sessions to achieve your goals")</p>
            <div class="mt-4">
                <a asp-controller="Account" asp-action="Register" class="btn btn-primary btn-lg me-2">@Html.T("التسجيل", "Register")</a>
                <a asp-controller="Account" asp-action="Login" class="btn btn-outline-primary btn-lg">@Html.T("تسجيل الدخول", "Login")</a>
            </div>
        </div>
    </div>
</section>

<section class="py-4">
    <div class="container">
        <h2 class="text-center mb-4">@Html.T("لماذا نحن؟", "Why us?")</h2>
        <div class="row g-4 text-center">
            <div class="col-md-3 col-6">
                <div class="p-3 rounded border h-100">
                    <i class="feather-book text-primary" style="font-size: 2rem;"></i>
                    <h6 class="mt-2">@Html.T("الدورات", "Courses")</h6>
                    <small class="text-muted">@Html.T("تعلم من خبراء", "Learn from experts")</small>
                </div>
            </div>
            <div class="col-md-3 col-6">
                <div class="p-3 rounded border h-100">
                    <i class="feather-book-open text-primary" style="font-size: 2rem;"></i>
                    <h6 class="mt-2">@Html.T("الكتب", "Books")</h6>
                    <small class="text-muted">@Html.T("مكتبة رقمية غنية", "Rich digital library")</small>
                </div>
            </div>
            <div class="col-md-3 col-6">
                <div class="p-3 rounded border h-100">
                    <i class="feather-video text-primary" style="font-size: 2rem;"></i>
                    <h6 class="mt-2">@Html.T("جلسات مباشرة", "Live sessions")</h6>
                    <small class="text-muted">@Html.T("تفاعل حي مع المدرسين", "Live interaction")</small>
                </div>
            </div>
            <div class="col-md-3 col-6">
                <div class="p-3 rounded border h-100">
                    <i class="feather-award text-primary" style="font-size: 2rem;"></i>
                    <h6 class="mt-2">@Html.T("شهادات", "Certificates")</h6>
                    <small class="text-muted">@Html.T("اعتماد إنجازك", "Certify your achievement")</small>
                </div>
            </div>
        </div>
    </div>
</section>

@if (Model.FeaturedCourses.Any())
{
<section class="py-4 bg-light" id="courses">
    <div class="container">
        <h2 class="mb-4">@Html.T("الدورات المميزة", "Featured courses")</h2>
        <div class="row g-4">
            @foreach (var c in Model.FeaturedCourses)
            {
                <div class="col-md-6 col-lg-4 col-xl-3">
                    <div class="card h-100 shadow-sm">
                        @if (!string.IsNullOrEmpty(c.ThumbnailUrl))
                        {
                            var courseImg = (c.ThumbnailUrl.StartsWith("http://", StringComparison.OrdinalIgnoreCase) || c.ThumbnailUrl.StartsWith("https://", StringComparison.OrdinalIgnoreCase)) ? c.ThumbnailUrl : Url.Content("~" + c.ThumbnailUrl);
                            <img src="@courseImg" class="card-img-top" alt="@c.Title" style="height: 140px; object-fit: cover;" onerror="this.style.display='none'">
                        }
                        <div class="card-body d-flex flex-column">
                            <h6 class="card-title">@c.Title</h6>
                            @if (!string.IsNullOrEmpty(c.ShortDescription))
                            {
                                <p class="card-text small text-muted flex-grow-1">@(c.ShortDescription.Length > 80 ? c.ShortDescription[..80] + "..." : c.ShortDescription)</p>
                            }
                            <div class="mt-auto">
                                <span class="text-primary fw-bold">@(c.DiscountPrice ?? c.Price) @Html.T("ر.س", "SAR")</span>
                                @if (c.DiscountPrice.HasValue && c.DiscountPrice < c.Price)
                                {
                                    <span class="text-muted text-decoration-line-through small ms-1">@c.Price</span>
                                }
                                <a asp-area="Student" asp-controller="Courses" asp-action="Details" asp-route-id="@c.Id" class="btn btn-sm btn-outline-primary float-end">@Html.T("عرض", "View")</a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>
}

@if (Model.FeaturedBooks.Any())
{
<section class="py-4" id="books">
    <div class="container">
        <h2 class="mb-4">@Html.T("الكتب", "Books")</h2>
        <div class="row g-4">
            @foreach (var b in Model.FeaturedBooks)
            {
                <div class="col-md-6 col-lg-4 col-xl-3">
                    <div class="card h-100 shadow-sm">
                        @if (!string.IsNullOrEmpty(b.CoverImageUrl))
                        {
                            var bookImg = (b.CoverImageUrl.StartsWith("http://", StringComparison.OrdinalIgnoreCase) || b.CoverImageUrl.StartsWith("https://", StringComparison.OrdinalIgnoreCase)) ? b.CoverImageUrl : Url.Content("~" + b.CoverImageUrl);
                            <img src="@bookImg" class="card-img-top" alt="@b.Title" style="height: 160px; object-fit: cover;" onerror="this.style.display='none'">
                        }
                        <div class="card-body d-flex flex-column">
                            <h6 class="card-title">@b.Title</h6>
                            @if (!string.IsNullOrEmpty(b.ShortDescription))
                            {
                                <p class="card-text small text-muted flex-grow-1">@(b.ShortDescription.Length > 80 ? b.ShortDescription[..80] + "..." : b.ShortDescription)</p>
                            }
                            <div class="mt-auto">
                                <span class="text-primary fw-bold">@(b.DiscountPrice ?? b.Price) @Html.T("ر.س", "SAR")</span>
                                <a asp-area="Student" asp-controller="Books" asp-action="Details" asp-route-slug="@b.Slug" class="btn btn-sm btn-outline-primary float-end">@Html.T("عرض", "View")</a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>
}

@if (Model.UpcomingSessions.Any())
{
<section class="py-4 bg-light">
    <div class="container">
        <h2 class="mb-4">@Html.T("الجلسات المباشرة القادمة", "Upcoming live sessions")</h2>
        <div class="list-group">
            @foreach (var s in Model.UpcomingSessions)
            {
                <div class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="mb-0">@s.Title</h6>
                        @if (!string.IsNullOrEmpty(s.CourseName))
                        {
                            <small class="text-muted">@s.CourseName</small>
                        }
                    </div>
                    <span class="badge bg-primary rounded-pill">@s.StartDate.ToString("g", System.Globalization.CultureInfo.CurrentUICulture)</span>
                </div>
            }
        </div>
    </div>
</section>
}

@if (Model.Announcements.Any())
{
<section class="py-4">
    <div class="container">
        <h2 class="mb-4">@Html.T("أحدث الإعلانات", "Latest announcements")</h2>
        <div class="list-group">
            @foreach (var a in Model.Announcements)
            {
                <div class="list-group-item list-group-item-action">
                    <div class="d-flex w-100 justify-content-between align-items-start">
                        <div class="flex-grow-1">
                            <h6 class="mb-1">
                                <a asp-controller="Announcements" asp-action="ViewLanding" asp-route-id="@a.Id" class="text-decoration-none text-dark">@a.Title</a>
                            </h6>
                            @if (!string.IsNullOrEmpty(a.ContentExcerpt))
                            {
                                <p class="mb-0 small text-muted">@a.ContentExcerpt</p>
                            }
                        </div>
                        <a asp-controller="Announcements" asp-action="ViewLanding" asp-route-id="@a.Id" class="btn btn-sm btn-outline-primary ms-2">@Html.T("اقرأ المزيد", "Read more")</a>
                    </div>
                </div>
            }
        </div>
    </div>
</section>
}

<section class="py-5 bg-light" id="about">
    <div class="container">
        <h2 class="mb-4">@Model.AboutTitle</h2>
        <div class="row">
            <div class="col-lg-8">
                <p class="lead">@Model.AboutText</p>
            </div>
        </div>
        <div class="mt-4">
            <a asp-controller="Account" asp-action="Register" class="btn btn-primary">@Html.T("سجّل الآن", "Register now")</a>
        </div>
    </div>
</section>
